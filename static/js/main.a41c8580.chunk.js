/*! For license information please see main.a41c8580.chunk.js.LICENSE.txt */
(this.webpackJsonpnotehub=this.webpackJsonpnotehub||[]).push([[0],{5263:function(e,t,a){e.exports=a(5474)},5281:function(e,t,a){},5282:function(e,t,a){},5474:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),o=a(2),i=a(0),c=a.n(i),l=a(12),s=a.n(l),u=(a(5268),a(5269),a(5270),a(154)),d=a(37),m=a.n(d),p=a(160),b=a(20);a(5539),a(272),a(5541),a(5540);p.a.use(b.a).init({interpolation:{escapeValue:!1},keySeparator:!1,lng:localStorage.getItem("language")||"en-US",fallbackLng:"en-US",resources:{"en-US":{translation:{"title/Crossnote":"Crossnote","search/placeholder":"Search Notes","account/Anonymous":"Anonymous","account/anonymous":"anonymous","general/go-back":"Go back","general/sending":"Sending","general/send":"Send","general/cancel":"Cancel","general/backed-up-at":"Backed up at","general/created-at":"Created at","general/modified-at":"Modified at","general/interacted-at":"Interacted at","general/date-created":"Date created","general/date-modified":"Date modified","general/date-interacted":"Date interacted","general/saved-at":"Saved at","general/loading":"Loading ...","general/loading-notifications":"Loading notifications ...","general/failed-to-set":"Failed to set","general/update":"Update","general/updated":"Updated","general/updating":"Updating","general/close":"Close","general/Note":"Note","general/notes":"notes","general/Settings":"Settings","general/Collaborators":"Collaborators","general/collaborators":"collaborators","general/Backups":"Backups","general/backups":"backups","general/Discussion":"Discussion","general/discussion":"discussion","general/Notifications":"Notifications","general/Username":"Username","general/Email":"Email","general/Password":"Password","general/confirm-password":"Confirm password","general/Continue":"Continue","general/enter-username":"Enter username","general/vickymd":"VickyMD","general/tags":"Tags","general/add-a-tag":"Add a tag","general/private":"Private","general/public":"Public","general/friends-only":"Friends only","general/anonymous":"Anonymous","general/onymous":"Onymous","general/Tag":"Tag","general/no-tags":"No tags","general/Untitled":"Untitled","general/untitled":"untitled","general/Unknown":"Unknown","general/unknown":"unknown","general/Agree":"Agree","general/Disagree":"Disagree","general/Print":"Print",Editor:"Editor",EDITOR:"EDITOR",Viewer:"Viewer",VIEWER:"VIEWER",Admin:"Admin",ADMIN:"ADMIN",ARCHIVED:"ARCHIVED","ATTACHED NOTES":"ATTACHED NOTES",DELETED:"DELETED",PINNED:"PINNED",OTHERS:"OTHERS","PUBLIC NOTES":"PUBLIC NOTES","FOLLOWINGS' NOTES":"FOLLOWINGS' NOTES","SHARED WITH ME":"SHARED WITH ME",BOOKMARKS:"BOOKMARKS","MY TAGS":"MY TAGS","general/enter-fullscreen-mode":"Enter fullscreen mode","general/enter-presentation-mode":"Enter presentation mode","general/math-preview":"Math Preview","general/this-note-is-empty":"This note is empty","general/no-notes-found":"No notes found","general/no-notifications-found":"No notifications found","general/clear-all":"Clear all","general/Save":"Save","general/Delete":"Delete","general/Follow":"Follow","general/Following":"Following","general/Unfollow":"Unfollow","general/my-notes":"My notes","general/public-notes":"Public notes","general/followings-notes":"Followings' notes","general/shared-with-me":"Shared with me","general/Bookmarks":"Bookmarks","general/Archive":"Archive","general/Trash":"Trash","general/new-note":"New note","general/profile-updated":"Profile updated","general/ID":"ID","general/Audio":"Audio","general/Video":"Video","general/source-url":"Source URL","general/sign-in":"Sign in","general/sign-up":"Sign up","general/Link":"Link","general/Upload":"Upload","general/clicks":"clicks","general/Processing":"Processing...","general/please-wait":"please wait...","general/Languages":"Languages","general/track":"Track","general/Publish":"Publish","note/unarchive-note":"Unarchive note","note/archive-note":"Archive note","note/delete-forever":"Delete forever","note/delete-note":"Delete note","note/restore-note":"Restore note","note/report-note":"Report note","note/open-in-crossnote-website":"Open in Crossnote website","note-tags/send-suggestion-failure":"Failed to send suggestion","note-tags/suggestion-sent":"Suggestion sent","note-tags/suggest-a-tag-to-this-note":"Suggest a tag to this note","user-tags/follow-a-tag":"Follow a tag","chat-message/reply-to-this-user":"Reply to this user","chat-message/add-reaction-to-this-message":"Add reaction to this message","chat-message/edit-this-message":"Edit this message","chat-message/modified-message":"modified message","chat-panel/post-message-failure":"Failed to post message","chat-panel/unsubscribe-info":"Unsubscribing from this chat group will stop you from receiving notifications unless someone mentions you","chat-panel/subscribe-info":"Subscribing to this chat group will let you receive notifications whenever someone posts a message","notifications/refresh":"Refresh to see new notifications","settings/about-this-project":"About this project \ud83e\udd14","settings/uploading-cover-image":"Uploading cover image","settings/upload-image-failure":"Failed to upload image","settings/Cover":"Cover","settings/enter-cover-image-url":"Enter cover image URL","settings/upload-image":"Upload image","settings/Avatar":"Avatar","settings/enter-avatar-image-url":"Enter avatar image URL","settings/Name":"Name","settings/enter-name":"Enter your Name (this is not your username)","settings/editor-cursor-color":"Editor cursor color","settings/hello":"Hello, ","settings/world":"world!","settings/linked-with-github-account":"Linked with GitHub account","settings/link-with-github-account":"Link with GitHub account","settings/log-out":"Log out","preview/attach-a-note":"Attach a note","preview/crossnote-untitled":"Crossnote - Untitled","preview/edit-this-note":"Edit this note","profile-card/followings":"followings","profile-card/followers":"followers","profile-card/Followings":"Followings","profile-card/Followers":"Followers","profile-card/notes":"notes","profile-card/follow-user-failure":"Failed to follow user","profile-card/followed-user":"Followed user","profile-card/unfollow-user-failure":"Failed to unfollow user","profile-card/unfollowed-user":"Unfollowed user","tag-card/pin-to-my-notes-page":"Pin to my notes page","interaction-panel/show-attached-notes":"Show attached notes","interaction-panel/add-comment":"Add comment","interaction-panel/add-reaction":"Add reaction","editor/loading-your-note":"Loading your note...","editor/sync-failure":"Failed to sync... Please refresh your page","editor/saving":"Saving...","editor/save-failure":"Failed to save","editor/saved":"Saved","editor/update-note-failure":"Failed to update note","editor/note-control/allow-readers-to-suggest-note-tags":"Allow readers to suggest note tags","editor/note-control/allow-readers-to-attach-notes-under-this-note":"Allow readers to attach notes under this note","editor/note-control/inherit-parent-note-collaborators-list":"Inherit parent note collaborators list","editor/note-control/note-visibility-hint":"All collaborators will be able to see this note","editor/note-control/allow-readers-to-attach-notes-unchecked":"Applies to you and collaborators that can edit and admin","editor/note-control/allow-readers-to-attach-notes-checked":"Applies to anyone that can view this note","editor/note-control/enter-parent-note-id":"Enter parent note ID","editor/note-control/attach-note-failure":"Failed to attach note","editor/note-control/unattach-note-failure":"Failed to unattach note","editor/collaborator-hint":" - note will be visible to them","editor/shareable-link-hint":"people with the link can view/edit this note with no need of login","editor/backups-control/create-backup":"Create backup","editor/backups-control/delete-this-backup":"Delete this backup","editor/backups-control/create-backup-failure":"Failed to create backup","editor/backups-control/backup-created":"Backup created","editor/backups-control/delete-backup-failure":"Failed to delete backup","editor/backups-control/backup-deleted":"Backup deleted","editor/backups-control/cloud-version":"Cloud version","editor/backups-control/backup-name":"Backup name","editor/collaborators-control/set-collaborator-role-failure":"Failed to set collaborator role","editor/collaborators-control/add-collaborator-failure":"Failed to add collaborator","editor/collaborators-control/collaborator-removed":"Collaborator removed","editor/collaborators-control/collaborator-added":"Collaborator added","editor/collaborators-control/can-view":"Can view","editor/collaborators-control/can-edit":"Can edit","editor/collaborators-control/can-administrate":"Can administrate","editor/toolbar/insert-image":"Insert image","editor/toolbar/upload-local-images":"Upload local images","editor/toolbar/capture-webpage":"Capture the whole webpage","editor/toolbar/insert-clock":"Insert clock","editor/toolbar/insert-emoji":"Insert emoji","editor/toolbar/insert-media":"Insert media","editor/toolbar/audio-url":"Audio URL","editor/toolbar/netease-music":"Netease Music","editor/toolbar/video-url":"Video URL","editor/toolbar/youtube":"Youtube","editor/toolbar/bilibili":"Bilibili","editor/toolbar/insert-slide":"Insert slide","editor/toolbar/insert-ocr":"Insert OCR","editor/toolbar/insert-kanban":"Insert Kanban","editor/toolbar/insert-abc-notation":"Insert ABC notation","editor/toolbar/insert-header-1":"Insert header 1","editor/toolbar/insert-header-2":"Insert header 2","editor/toolbar/insert-header-3":"Insert header 3","editor/toolbar/bold":"Bold","editor/toolbar/italic":"Italic","editor/toolbar/strikethrough":"Strikethrough","editor/toolbar/insert-inline-code":"Insert inline code","editor/toolbar/insert-blockquote":"Insert blockquote","editor/toolbar/insert-unordered-list":"Insert unordered list","editor/toolbar/insert-ordered-list":"Insert ordered list","editor/toolbar/insert-link":"Insert link","editor/toolbar/insert-table":"Insert table","editor/note-control/tag-added":"Tag added","editor/note-control/tag-deleted":"Tag deleted","editor/note-control/set-note-visibility-failure":"Failed to set note visibility","editor/note-control/note-visibility-updated":"Note visibility updated","editor/note-control/set-author-visibility-failure":"Failed to set author visibility","editor/note-control/author-visibility-updated":"Author visibility updated","editor/note-control/editor-mode":"Editor mode","editor/note-control/source-code":"Source code","editor/note-control/preview":"Preview","editor/note-control/pin-preview":"Pin preview on the side","editor/note-control/display-modification-records":"Display modification records","editor/note-control/note-visibility":"Note visibility","editor/note-control/author-visibility":"Author visibility","editor/note-control/shareable-link":"Shareable link","editor/note-control/copy-to-clipboard":"Copy to clipboard","editor/note-control/link-to-preview":"Link to preview","editor/note-control/link-to-editor":"Link to editor","editor/note-control/attach-to-note":"Attach to note","editor/note-control/source-added":"URL added","editor/note-control/source-deleted":"URL deleted","editor/note-control/invalid-note-source":"Invalid URL","editor/note-control/add-note-source":"Add related URLs","editor/note-control/note-source-hint":"Notes on the same URL will be grouped together","editor/note-control/enter-note-source":"Enter URL","avatar-panel/this-note-is-private":"This note is private","avatar-panel/this-note-is-public":"This note is visible to public","avatar-panel/this-note-is-friends-only":"This note is only visible to friends","avatar-panel/you-are-anonymous":"You are anonymous","file-exporter/name":"File exporter","file-exporter/orientation":"Orientation","file-exporter/portrait":"portrait","file-exporter/landscape":"landscape","file-exporter/paper-size":"Paper size","file-exporter/unit":"Unit","file-exporter/margin-top":"Margin top","file-exporter/margin-bottom":"Margin bottom","file-exporter/margin-left":"Margin left","file-exporter/margin-right":"Margin right","utils/uploading-image":"Uploading image...","utils/upload-image-failure":"Failed to upload image","notification/replies-to-you-in":"Replies to you in","notification/'s-note":"'s note ","notification/added":"Added","notification/to-your-note":"to your note","notification/add-you-as":"Added you as","notification/of-note":"of note","notification/add-tag-failure":"Failed to add tag","notification/suggested-to-add-tag":"Suggested to add tag","notification/started-following-you":"Started following you","notification/bookmarked-your-note":"Bookmarked your note","github-oauth/wait":"Please wait ...","github-oauth/link-with-github-account-failure":"Failed to link with GitHub account","github-oauth/sign-in-with-github-account-failure":"Failed to sign in with GitHub account","github-oauth/first-time-sign-in":"It seems to be the first time you sign in with GitHub account","github-oauth/first-time-sign-in-small":"Please finish the registeration below","widget/autoplay":"autoplay","widget/controls":"controls","widget/loop":"loop","widget/muted":"muted","widget/crossnote.image/thanks_sm_ms":"Thanks sm.ms for offering free image hosting service.","widget/crossnote.audio/audio_element_fail":"Your browser does not support the audio element.","widget/crossnote.audio/source-url-placeholder":"Enter audio source URL here, then press 'Enter' to insert.","widget/crossnote.video/video_element_fail":"Your browser does not support the video element","widget/crossnote.bilibili/error_message":"Error: Only supported https://www.bilibili.com/video/av79126732 like URL","widget/crossnote.youtube/error_message":"Error: Only supported https://www.youtube.com/watch?v=MmB9b5njVbA like URL","widget/crossnote.auth/welcome":"Welcome to crossnote","widget/crossnote.auth/doesnt-have-account":"Doesn't have an account? Let's create one \ud83d\ude09!","widget/crossnote.auth/forgot_password":"Forgot your password \ud83d\ude23?","widget/crossnote.auth/failed_to_send_code":"Failed to send verification code","widget/crossnote.auth/verification_code_sent":"Verification code has been sent to ","widget/crossnote.auth/failed_to_reset_password":"Failed to reset password","widget/crossnote.auth/password_reset":"Your password has been reset","widget/crossnote.auth/password-mismatch":"Passwords mismatch","widget/crossnote.auth/hello":"Hello, ","widget/crossnote.auth/enter-the-verification-code":"Enter the verification code","widget/crossnote.auth/get-code":"Get code","widget/crossnote.auth/sign-in-with-github-account":"Sign in with GitHub account","widget/crossnote.auth/already-have-an-account":"Already have an account?","widget/crossnote.auth/reset-password":"Reset password","widget/crossnote.auth/Or":"Or","widget/crossnote.bilibili/Bilibili":"Bilibili","widget/crossnote.bilibili/bilibili-video-url":"Bilibili video URL","widget/crossnote.bilibili/url-placeholder":"Enter the Bilibili video URL here, then press 'Enter' to insert.","widget/crossnote.image/image-helper":"Image helper","widget/crossnote.image/set-as-cover-image-in-note-card":"Set as cover image in note card","widget/crossnote.image/image-url-placeholder":"Enter image URL here, then press 'Enter' to insert.","widget/crossnote.image/click-here-to-browse-image-file":"Click here to browse image file","widget/crossnote.neteasemusic/song-id-placeholder":"Enter Netease Music song number ID.","widget/crossnote.video/video-url-placeholder":"Enter video source URL here, then press 'Enter' to insert.","widget/crossnote.video/poster-url":"Poster URL (optional)","widget/crossnote.video/poster-url-placeholder":"Enter poster URL here.","widget/crossnote.youtube/youtube-video-url":"Youtube video URL","widget/crossnote.youtube/youtube-video-url-placeholder":"Enter the Youtube video URL here, then press 'Enter' to insert.","widget/crossnote.ocr/ocr":"OCR - Optical character recognition","widget/crossnote.ocr/local-image":"Local image","widget/crossnote.ocr/recognize-text-in-languages":"Recognize text in languages","widget/crossnote.ocr/start-ocr":"Start OCR","widget/crossnote.ocr/extra-settings":"Extra settings","widget/crossnote.ocr/grayscale":"Grayscale","tesseract/loading tesseract core":"loading tesseract core","tesseract/initializing tesseract":"initializing tesseract","tesseract/initialized tesseract":"initialized tesseract","tesseract/loading language traineddata":"loading language traineddata","tesseract/loaded language traineddata":"loaded language traineddata","tesseract/initializing api":"initializing api","tesseract/initialized api":"initialized api","tesseract/recognizing text":"recognizing text"}}}});p.a;a(5281),a(5282);var f=a(4),g=a(30),h=a(5517),v=a(5528),w=a(5536),O=a(66),E=a(278),k=a(276),j=a(5529),y=a(5542),x=a(5544),C=a(5507),N=a(5547),S=a(22),P=a(6),D=a(13),I=a(18),A=a(258),B=a(34),R=a(10),L=a(16);"Bearer ".concat(localStorage.getItem("token"));function F(){var e=(new Date).getTime(),t=performance&&performance.now&&1e3*performance.now()||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(a){var n=16*Math.random();return e>0?(n=(e+n)%16|0,e=Math.floor(e/16)):(n=(t+n)%16|0,t=Math.floor(t/16)),("x"===a?n:3&n|8).toString(16)}))}new(function(){function e(){Object(R.a)(this,e),this.cache={}}return Object(L.a)(e,[{key:"hashCode",value:function(e){var t=e.split("").reduce((function(e,t){return(e=(e<<5)-e+t.charCodeAt(0))&e}),0),a="0."+(t=Math.abs(t)).toString();return parseFloat(a)}},{key:"generateColor",value:function(e){if(e in this.cache)return this.cache[e];var t="#"+((1<<24)*this.hashCode(e)|0).toString(16);return this.cache[e]=t,t}}]),e}());function U(){return Math.random().toString(36).substr(2,9)}var W=Object(A.a)((function(e){Object(b.b)().t;var t=e.crossnote,a=Object(i.useState)([]),n=Object(f.a)(a,2),c=n[0],l=n[1],s=Object(i.useState)(null),u=Object(f.a)(s,2),d=u[0],m=u[1],p=Object(i.useState)([]),g=Object(f.a)(p,2),h=g[0],v=g[1],w=Object(i.useState)({name:".",path:".",children:[]}),O=Object(f.a)(w,2),E=O[0],k=O[1],j=Object(i.useState)([]),y=Object(f.a)(j,2),x=y[0],C=y[1],N=Object(i.useState)(null),S=Object(f.a)(N,2),P=S[0],D=S[1],A=Object(i.useState)(!0),R=Object(f.a)(A,2),L=R[0],F=R[1],W=Object(i.useState)("$notes"),T=Object(f.a)(W,2),M=T[0],_=T[1],$=Object(i.useState)(!1),G=Object(f.a)($,2),V=G[0],z=G[1],H=Object(i.useState)(!1),K=Object(f.a)(H,2),J=K[0],Y=K[1],q=Object(i.useState)(!1),X=Object(f.a)(q,2),Q=X[0],Z=X[1],ee=Object(i.useState)(!0),te=Object(f.a)(ee,2),ae=te[0],ne=te[1],re=Object(i.useCallback)((function(e,a,n){C((function(r){return r.map((function(r){return r.filePath===e.filePath?(r.markdown=a,t.writeNote(e.notebook,e.filePath,a,e.config).then((function(){n&&t.getStatus(e).then((function(e){n(e)}))})),r):r}))}))}),[t]),oe=Object(i.useCallback)((function(e){t.deleteNote(d,e.filePath),v((function(a){var n=a.filter((function(t){return t.filePath!==e.filePath}));return n.length!==a.length&&D(n[0]),t.getNotebookDirectoriesFromNotes(n).then((function(e){k(e)})),n})),ne(!1)}),[t,d]),ie=Object(i.useCallback)((function(e,a){Object(o.a)(r.a.mark((function n(){var o;return r.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.changeNoteFilePath(d,e,a);case 2:return o=h.map((function(t){return t.filePath===e.filePath?(t.filePath=a,t.config.modifiedAt=new Date,t):t})),v(o),n.t0=k,n.next=7,t.getNotebookDirectoriesFromNotes(o);case 7:n.t1=n.sent,(0,n.t0)(n.t1);case 9:case"end":return n.stop()}}),n)})))()}),[d,t,h]),ce=Object(i.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";Object(o.a)(r.a.mark((function a(){var n,o,i,c;return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return e||(e=U()),e.endsWith(".md")||(e+=".md"),n=M,o="$notes"===M||"$today"===M||"$todo"===M?e:B.relative(d.dir,B.resolve(d.dir,n,e)),i={id:"",tags:[],modifiedAt:new Date,createdAt:new Date},a.next=7,t.writeNote(d,o,"",i);case 7:c={notebook:d,filePath:o,title:"",markdown:"",config:i},v((function(e){return[c].concat(Object(I.a)(e))})),D(c),ne(!0);case 11:case"end":return a.stop()}}),a)})))()}),[d,t,M]),le=Object(i.useCallback)(function(){var e=Object(o.a)(r.a.mark((function e(a,n,o,i,c,s,u){var d;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return z(!0),e.prev=1,e.next=4,t.addNotebook({name:a,gitURL:n,branch:o,username:i,password:c,corsProxy:u,rememberCredentials:s});case 4:d=e.sent,l((function(e){return[d].concat(Object(I.a)(e))})),z(!1),e.next=13;break;case 9:throw e.prev=9,e.t0=e.catch(1),z(!1),e.t0;case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t,a,n,r,o,i,c){return e.apply(this,arguments)}}(),[t]),se=Object(i.useCallback)(function(){var e=Object(o.a)(r.a.mark((function e(a){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,t.updateNotebook(a);case 5:l((function(e){return Object(I.a)(e)})),e.next=10;break;case 8:e.prev=8,e.t0=e.catch(2);case 10:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t){return e.apply(this,arguments)}}(),[t]),ue=Object(i.useCallback)(function(){var e=Object(o.a)(r.a.mark((function e(a){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,t.deleteNotebook(a._id);case 5:e.next=9;break;case 7:e.prev=7,e.t0=e.catch(2);case 9:n=null,l((function(e){return e.filter((function(e){return n||e._id===a._id||(n=e),e._id!==a._id}))})),m(n);case 12:case"end":return e.stop()}}),e,null,[[2,7]])})));return function(t){return e.apply(this,arguments)}}(),[t]),de=Object(i.useCallback)(function(){var e=Object(o.a)(r.a.mark((function e(a){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return Y(!0),e.prev=3,e.next=6,t.pushNotebook(a);case 6:Y(!1),e.next=13;break;case 9:throw e.prev=9,e.t0=e.catch(3),Y(!1),e.t0;case 13:case"end":return e.stop()}}),e,null,[[3,9]])})));return function(t){return e.apply(this,arguments)}}(),[t]),me=Object(i.useCallback)(function(){var e=Object(o.a)(r.a.mark((function e(a){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return Z(!0),e.prev=3,e.next=6,t.pullNotebook(a);case 6:return Z(!1),e.next=9,t.listNotes({notebook:a.notebook,dir:"./",includeSubdirectories:!0});case 9:return e.t0=function(e,t){return t.config.modifiedAt.getTime()-e.config.modifiedAt.getTime()},n=e.sent.sort(e.t0),v(n),e.t1=k,e.next=15,t.getNotebookDirectoriesFromNotes(n);case 15:e.t2=e.sent,(0,e.t1)(e.t2),n.find((function(e){return e.filePath===P.filePath}))||D(n[0]),e.next=24;break;case 20:throw e.prev=20,e.t3=e.catch(3),Z(!1),e.t3;case 24:case"end":return e.stop()}}),e,null,[[3,20]])})));return function(t){return e.apply(this,arguments)}}(),[t,P]),pe=Object(i.useCallback)(function(){var e=Object(o.a)(r.a.mark((function e(a){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,t.checkoutNote(a);case 4:(n=e.sent)?(v((function(e){return e.map((function(e){return e.filePath===n.filePath?n:e}))})),C((function(e){return e.map((function(e){return e.filePath===n.filePath?n:e}))})),D(n)):(v((function(e){var n=e.filter((function(e){return e.filePath!==a.filePath}));return t.getNotebookDirectoriesFromNotes(n).then((function(e){k(e)})),n})),C((function(e){var t=e.filter((function(e){return e.filePath!==a.filePath}));return D(t[0]),t})));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[t]);return Object(i.useEffect)((function(){t&&Object(o.a)(r.a.mark((function e(){var a,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.listNotebooks();case 2:if(a=e.sent,n=null,!a.length){e.next=10;break}l(a),m(a[0]),n=a[0],e.next=15;break;case 10:return e.next=12,t.addNotebook({name:"Unamed",corsProxy:"https://cors.isomorphic-git.org",gitURL:""});case 12:n=e.sent,l([n]),m(n);case 15:case"end":return e.stop()}}),e)})))()}),[t]),Object(i.useEffect)((function(){t&&Object(o.a)(r.a.mark((function e(){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.listNotes({notebook:d,dir:"./",includeSubdirectories:!0});case 2:return e.t0=function(e,t){return t.config.modifiedAt.getTime()-e.config.modifiedAt.getTime()},a=e.sent.sort(e.t0),v(a),e.t1=k,e.next=8,t.getNotebookDirectoriesFromNotes(a);case 8:e.t2=e.sent,(0,e.t1)(e.t2),D(a[0]);case 11:case"end":return e.stop()}}),e)})))()}),[t,d]),Object(i.useEffect)((function(){t&&d&&_("$notes")}),[t,d]),Object(i.useEffect)((function(){if(t&&d&&h){if(h.length&&h[0].notebook._id!==d._id)return;var e=[];e="$notes"===M?Object(I.a)(h):"$todo"===M?h.filter((function(e){return e.markdown.match(/(\*|-|\d+\.)\s\[(\s+|x|X)\]\s/gm)})):"$today"===M?h.filter((function(e){return Date.now()-e.config.modifiedAt.getTime()<=864e5})):L?h.filter((function(e){return 0===e.filePath.indexOf(M+"/")})):h.filter((function(e){return B.dirname(e.filePath)===M})),C(e),P||D(e[0])}}),[M,t,d,L,P,h]),{crossnote:t,notebooks:c,selectedNotebook:d,setSelectedNotebook:m,notes:x,selectedNote:P,setSelectedNote:D,updateNoteMarkdown:re,createNewNote:ce,selectedDir:M,setSelectedDir:_,includeSubdirectories:L,setIncludeSubdirectories:F,deleteNote:oe,changeNoteFilePath:ie,notebookDirectories:E,addNotebook:le,isAddingNotebook:V,isPushingNotebook:J,isPullingNotebook:Q,updateNotebook:se,deleteNotebook:ue,pushNotebook:de,pullNotebook:me,checkoutNote:pe,displayMobileEditor:ae,setDisplayMobileEditor:ne}})),T=a(5523),M=a(5480),_=a(129);function $(e){var t=e.match(/^#\s.+$/gim);return t&&t.length?t[0].replace(/^#/,"").trim():""}function G(){return(G=Object(o.a)(r.a.mark((function e(t){var a,n,o,i,c,l,s,u,d;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="","",o="",i=[],!0,t=t.replace(/^---.+?\n---/,""),c=t,(l=t.match(/^#\s.+$/gim))&&l.length&&(a=l[0].replace(/^#/,"").trim(),s=t.slice(0,t.indexOf(l[0])).trim(),c=t.slice(t.indexOf(l[0])+l[0].length,t.length),(u=s.match(/^!\[.*?\]\(.+?\)/gim))&&u.length&&(i.push(u[0].match(/\(([^)"]+?)\)/)[1].trim()),o=i[0])),(d=t.match(/^!\[\s*cover\s*\]\(.+?\)/gim))&&d.length&&(d.forEach((function(e){i.push(e.match(/\(([^)"]+?)\)/)[1].trim())})),i=i.filter((function(e,t,a){return t===a.findIndex((function(t){return t===e}))}))),n=c.split("\n").filter((function(e){return e.trim().length>0&&!e.match(/!\[.*?\]\(.+?\)/)&&!e.match(/`@.+?`/)})).map((function(e){return e.replace(/#+\s(.+)\s*$/,"**$1**").trim()})).slice(0,10).join("  \n"),e.abrupt("return",{title:a,summary:n,coverImage:o,images:i,tags:[],html:"",hasMoreContent:!0,video:""});case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var V=a(5538),z=Object(C.a)((function(e){return Object(N.a)({noteCard:{width:"100%",display:"flex",flexDirection:"row",alignItems:"flex-start",padding:e.spacing(2,.5,0),textAlign:"left",cursor:"default"},selected:{borderLeft:"4px solid ".concat(e.palette.primary.main)},unselected:{borderLeft:"4px solid rgba(0, 0, 0, 0)"},leftPanel:{width:"48px",paddingLeft:e.spacing(.5)},duration:{color:e.palette.text.secondary},rightPanel:{flex:"1",borderBottom:"1px solid #ededed"},header:{marginBottom:e.spacing(2)},summary:{color:e.palette.text.secondary,marginBottom:e.spacing(2),paddingRight:e.spacing(2),display:"-webkit-box",lineHeight:"1.3rem !important",textOverflow:"ellipsis !important",overflow:"hidden !important",maxWidth:"100%",maxHeight:"2.6rem","-webkit-line-clamp":2,"-webkit-box-orient":"vertical",wordBreak:"break-all"},filePath:{}})}));function H(e){var t=z(e),a=e.note,n=W.useContainer(),r=Object(i.useState)(""),o=Object(f.a)(r,2),l=o[0],s=o[1],u=Object(i.useState)(null),d=Object(f.a)(u,2),m=d[0],p=d[1],g=Object(b.b)().t,h=Object(V.a)(a.config.modifiedAt,Date.now()).replace(/\sseconds?/,"s").replace(/\sminutes?/,"m").replace(/\shours?/,"h").replace(/\sdays?/,"d").replace(/\sweeks?/,"w").replace(/\smonths?/,"mo").replace(/\syears?/,"y");return Object(i.useEffect)((function(){s($(a.markdown)),function(e){return G.apply(this,arguments)}(a.markdown||g("general/this-note-is-empty")).then((function(e){p(e)})).catch((function(e){}))}),[a.markdown,g]),c.a.createElement(_.a,{className:Object(P.a)(t.noteCard,n.selectedNote&&n.selectedNote.filePath===a.filePath?t.selected:t.unselected),onClick:function(){n.setSelectedNote(a),n.setDisplayMobileEditor(!0)}},c.a.createElement(w.a,{className:Object(P.a)(t.leftPanel)},c.a.createElement(O.a,{className:Object(P.a)(t.duration)},h)),c.a.createElement(w.a,{className:Object(P.a)(t.rightPanel)},l&&c.a.createElement(O.a,{style:{fontWeight:"bold"},variant:"body1",className:Object(P.a)(t.header)},l),m&&c.a.createElement(O.a,{className:Object(P.a)(t.summary)},m&&m.summary),c.a.createElement(O.a,{variant:"caption",className:Object(P.a)(t.filePath)},a.filePath)))}var K=a(5511),J=a(5513),Y=a(5514),q=a(5537),X=a(5546),Q=a(5518),Z=a(5519),ee=a(5520),te=a(5543),ae=a(5521),ne=a(5522),re=a(5477);function oe(e){var t=W.useContainer(),a=Object(i.useState)(""),n=Object(f.a)(a,2),l=n[0],s=n[1],u=Object(i.useState)(!1),d=Object(f.a)(u,2),m=d[0],p=d[1],b=Object(i.useState)(""),g=Object(f.a)(b,2),h=g[0],v=g[1],E=Object(i.useState)(""),k=Object(f.a)(E,2),j=k[0],y=k[1],x=Object(i.useState)(""),C=Object(f.a)(x,2),N=C[0],S=C[1],P=Object(i.useState)(""),I=Object(f.a)(P,2),A=I[0],B=I[1],R=Object(i.useState)("https://cors.isomorphic-git.org"),L=Object(f.a)(R,2),F=L[0],U=L[1],T=Object(i.useState)(3),M=Object(f.a)(T,2),_=M[0],$=M[1],G=Object(i.useState)(!1),V=Object(f.a)(G,2),z=V[0],H=V[1];Object(i.useEffect)((function(){var t=e.notebook;t&&(s(t.name),v(t.gitURL),y(t.gitBranch||"master"),S(t.gitUsername),B(t.gitPassword),U(t.gitCorsProxy))}),[e.notebook]);var oe=Object(i.useCallback)(Object(o.a)(r.a.mark((function a(){var n;return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n=e.notebook){a.next=4;break}return e.onClose(),a.abrupt("return");case 4:return n.name=l.trim(),n.gitURL=h.trim(),n.gitBranch=j.trim(),n.gitUsername=N.trim(),n.gitPassword=A,n.gitCorsProxy=F.trim(),a.prev=10,a.next=13,t.updateNotebook(n);case 13:a.next=17;break;case 15:a.prev=15,a.t0=a.catch(10);case 17:e.onClose();case 18:case"end":return a.stop()}}),a,null,[[10,15]])}))),[e,e.notebook,l,h,j,N,A,F]),ie=Object(i.useCallback)(Object(o.a)(r.a.mark((function a(){var n;return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=e.notebook,a.prev=1,a.next=4,t.deleteNotebook(n);case 4:a.next=8;break;case 6:a.prev=6,a.t0=a.catch(1);case 8:e.onClose();case 9:case"end":return a.stop()}}),a,null,[[1,6]])}))),[e.notebook]);return Object(i.useEffect)((function(){$(3)}),[e.notebook]),c.a.createElement(K.a,{open:e.open,onClose:e.onClose},c.a.createElement(J.a,null,"Configure a notebook"),c.a.createElement(Y.a,null,c.a.createElement(q.a,{label:"Notebook name",value:l,fullWidth:!0,onChange:function(e){s(e.target.value)},style:{marginBottom:"16px"}}),c.a.createElement(X.a,{elevation:2,expanded:m,onChange:function(){return p(!m)}},c.a.createElement(Q.a,{expandIcon:c.a.createElement(D.c,null)},c.a.createElement(O.a,null,"Git repository (optional)")),c.a.createElement(Z.a,null,c.a.createElement(w.a,null,c.a.createElement(q.a,{label:"url",placeholder:"https://abc/def.git",disabled:!0,fullWidth:!0,value:h,onChange:function(e){return v(e.target.value)}}),c.a.createElement(q.a,{label:"branch",placeholder:"master",disabled:!0,fullWidth:!0,value:j,onChange:function(e){return y(e.target.value)}}),c.a.createElement(q.a,{label:"username (optional)",placeholder:"username (optional)",fullWidth:!0,value:N,onChange:function(e){return S(e.target.value)}}),c.a.createElement(q.a,{label:"password (optional)",placeholder:"password (optional)",type:"password",fullWidth:!0,value:A,onChange:function(e){return B(e.target.value)}}),c.a.createElement(ee.a,{control:c.a.createElement(te.a,{checked:z,onChange:function(){return H(!z)},value:z}),label:c.a.createElement(O.a,null,"Remember credentials "+(z?"(stored locally)":""))}),c.a.createElement(q.a,{label:"cors proxy",placeholder:"https://cors.isomorphic-git.org",fullWidth:!0,value:F,onChange:function(e){return U(e.target.value)}}),c.a.createElement(ae.a,{href:"https://github.com/isomorphic-git/isomorphic-git#cors-support",target:"_blank"},"Why we need cors proxy?"))))),c.a.createElement(ne.a,null,c.a.createElement(re.a,{variant:"contained",color:"secondary",disabled:!_,onClick:function(){1===_?(ie(),$(_-1)):$(_-1)}},"Delete"+(_<3?" ".concat(_):"")),c.a.createElement(re.a,{variant:"contained",color:"primary",onClick:oe},"Save"),c.a.createElement(re.a,{onClick:e.onClose},"Cancel")))}var ie=Object(C.a)((function(e){return Object(N.a)({notes:{display:"flex",flexDirection:"column",height:"100%"},topPanel:{padding:e.spacing(1)},row:{display:"flex",alignItems:"center"},sectionName:{marginLeft:e.spacing(1)},search:Object(g.a)({position:"relative",borderRadius:e.shape.borderRadius,backgroundColor:Object(S.b)(e.palette.common.white,.15),"&:hover":{backgroundColor:Object(S.b)(e.palette.common.white,.25)},marginRight:0,marginLeft:0,width:"100%"},e.breakpoints.up("sm"),{}),searchIcon:{width:e.spacing(7),color:"rgba(0, 0, 0, 0.54)",height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"},inputRoot:{color:"inherit",border:"1px solid #bbb",borderRadius:"4px"},inputInput:Object(g.a)({padding:e.spacing(1,1,1,7),transition:e.transitions.create("width"),width:"100%"},e.breakpoints.up("md"),{}),notesList:{flex:"1",overflowY:"auto",paddingBottom:e.spacing(12)}})}));function ce(e){var t=ie(e),a=Object(b.b)().t,n=W.useContainer(),r=Object(i.useState)(""),o=Object(f.a)(r,2),l=o[0],s=o[1],u=Object(i.useState)(!1),d=Object(f.a)(u,2),m=d[0],p=d[1];return c.a.createElement(w.a,{className:Object(P.a)(t.notes)},c.a.createElement(T.a,{className:Object(P.a)(t.topPanel)},c.a.createElement(w.a,{className:Object(P.a)(t.row)},c.a.createElement(y.a,{smUp:!0,implementation:"css"},c.a.createElement(E.a,{onClick:e.toggleDrawer},c.a.createElement(D.q,null))),c.a.createElement("div",{className:t.search},c.a.createElement("div",{className:t.searchIcon},c.a.createElement(D.p,null)),c.a.createElement(M.a,{placeholder:a("search/placeholder"),classes:{root:t.inputRoot,input:t.inputInput},value:l,inputProps:{"aria-label":"search"},onChange:function(e){return s(e.target.value)}})),c.a.createElement(E.a,{onClick:function(){n.createNewNote()}},c.a.createElement(D.l,null))),c.a.createElement(w.a,{className:Object(P.a)(t.row),style:{justifyContent:"space-between"}},"$notes"===n.selectedDir?c.a.createElement(w.a,{className:Object(P.a)(t.row)},c.a.createElement("span",{role:"img","aria-label":"notes"},"\ud83d\udcd2"),c.a.createElement(O.a,{className:Object(P.a)(t.sectionName)},n.selectedNotebook&&n.selectedNotebook.name)):"$today"===n.selectedDir?c.a.createElement(w.a,{className:Object(P.a)(t.row)},c.a.createElement("span",{role:"img","aria-label":"today-notes"},"\ud83d\uddd3"),c.a.createElement(O.a,{className:Object(P.a)(t.sectionName)}," today")):"$todo"===n.selectedDir?c.a.createElement(w.a,{className:Object(P.a)(t.row)},c.a.createElement("span",{role:"img","aria-label":"todo-notes"},"\u2611\ufe0f"),c.a.createElement(O.a,{className:Object(P.a)(t.sectionName)}," todo")):n.selectedDir&&c.a.createElement(w.a,{className:Object(P.a)(t.row)},c.a.createElement("span",{role:"img","aria-label":"folder"},"\ud83d\udcc1"),c.a.createElement(O.a,{className:Object(P.a)(t.sectionName)},n.selectedDir)),"$notes"===n.selectedDir&&c.a.createElement(E.a,{onClick:function(){return p(!0)}},c.a.createElement(D.v,null)))),c.a.createElement(oe,{open:m,onClose:function(){return p(!1)},notebook:n.selectedNotebook}),c.a.createElement(w.a,{className:Object(P.a)(t.notesList)},n.notes.map((function(e){if(!l.trim().length)return c.a.createElement(H,{key:"note-card-"+e.filePath,note:e});var t=new RegExp("("+l.trim().split(/\s+/g).map((function(e){return"\\"+e.split("").join("\\")})).join("|")+")","i");return e.markdown.match(t)||e.filePath.match(t)?c.a.createElement(H,{key:"note-card-"+e.filePath,note:e}):void 0}))))}var le=a(5524),se=a(5545),ue=a(5525),de=a(101);function me(e){var t=W.useContainer(),a=e.notebook,n=Object(i.useState)(localStorage.getItem("authorName")||"anonymous"),r=Object(f.a)(n,2),o=r[0],l=r[1],s=Object(i.useState)(localStorage.getItem("authorEmail")||"anonymous@crossnote.app"),u=Object(f.a)(s,2),d=u[0],p=u[1],b=Object(i.useState)(a.gitUsername),g=Object(f.a)(b,2),h=g[0],v=g[1],E=Object(i.useState)(a.gitPassword),k=Object(f.a)(E,2),j=k[0],y=k[1],x=Object(i.useState)("doc: Updated docs"),C=Object(f.a)(x,2),N=C[0],S=C[1],P=Object(i.useCallback)((function(){t.pushNotebook({notebook:a,authorName:o,authorEmail:d,username:h,password:j,message:N,onAuthFailure:function(){new m.a({type:"error",text:"Authentication failed",layout:"topRight",theme:"relax",timeout:5e3}).show()}}).then((function(){e.onClose(),new m.a({type:"success",text:"Notebook pushed",layout:"topRight",theme:"relax",timeout:2e3}).show()})).catch((function(t){console.log(t),e.onClose(),new m.a({type:"error",text:"Failed to push notebook",layout:"topRight",theme:"relax",timeout:2e3}).show()}))}),[d,o,h,j,a,N,e]);return Object(i.useEffect)((function(){localStorage.setItem("authorName",o)}),[o]),Object(i.useEffect)((function(){localStorage.setItem("authorEmail",d)}),[d]),Object(i.useEffect)((function(){v(a.gitUsername)}),[a.gitUsername,e.open]),Object(i.useEffect)((function(){y(a.gitPassword)}),[a.gitPassword,e.open]),c.a.createElement(K.a,{open:e.open,onClose:function(){t.isPushingNotebook||e.onClose()}},c.a.createElement(J.a,null,"Push notebook ".concat(a.name," to git repository"),c.a.createElement(w.a,null,c.a.createElement(O.a,{variant:"caption"},a.gitURL+":"+a.gitBranch))),c.a.createElement(Y.a,null,c.a.createElement(q.a,{label:"Author name",fullWidth:!0,value:o,onChange:function(e){return l(e.target.value)}}),c.a.createElement(q.a,{label:"Author email",fullWidth:!0,value:d,onChange:function(e){return p(e.target.value)}}),c.a.createElement(q.a,{label:"Commit message",fullWidth:!0,value:N,onChange:function(e){return S(e.target.value)}}),c.a.createElement(q.a,{label:"username",placeholder:"username",fullWidth:!0,value:h,onChange:function(e){return v(e.target.value)}}),c.a.createElement(q.a,{label:"password",placeholder:"password",type:"password",fullWidth:!0,value:j,onChange:function(e){return y(e.target.value)}})),c.a.createElement(ne.a,null,c.a.createElement(re.a,{variant:"contained",color:"primary",disabled:t.isPushingNotebook,onClick:P},t.isPushingNotebook?"Pushing...":"Push"),c.a.createElement(re.a,{onClick:e.onClose},"Cancel")))}var pe,be=a(140),fe=Object(C.a)((function(e){return Object(N.a)({editorPanel:{width:"100%",height:"100%",display:"flex",flexDirection:"column"},topPanel:{position:"relative",padding:e.spacing(.5,1),display:"flex",alignItems:"center",justifyContent:"space-between",borderBottom:"1px solid #eee",overflow:"auto"},bottomPanel:{position:"relative",padding:e.spacing(.5,1),display:"flex",alignItems:"center",justifyContent:"space-between",borderTop:"1px solid #eee"},controlBtn:{padding:e.spacing(.5,0),color:e.palette.text.secondary},controlBtnSelected:{color:e.palette.primary.main},row:{display:"flex",flexDirection:"row",alignItems:"center"},cursorPositionInfo:{zIndex:150},editorWrapper:{flex:1,overflow:"auto","& .CodeMirror-gutters":{display:"none"},"& .CodeMirror-code":{width:"100%"},"& .CodeMirror":Object(g.a)({height:"100%",padding:e.spacing(0,2)},e.breakpoints.down("sm"),{padding:e.spacing(0)}),"& .CodeMirror-vscrollbar":{display:"none !important"}},fullScreen:{position:"fixed",width:"100%",height:"100%",left:"0",top:"0",zIndex:2e3,overflow:"auto"},editor:{width:"100%",height:"100%"},preview:{position:"relative",left:"0",top:"0",width:"100%",height:"100%",border:"none",overflow:"auto !important",padding:e.spacing(2),zIndex:99},backBtn:Object(g.a)({marginRight:"8px"},e.breakpoints.up("sm"),{display:"none"})})}));function ge(e){var t=e.note,a=fe(e),n=Object(i.useState)(null),l=Object(f.a)(n,2),s=l[0],u=l[1],d=Object(i.useState)(null),p=Object(f.a)(d,2),g=p[0],h=p[1],v=Object(i.useState)({line:0,ch:0}),k=Object(f.a)(v,2),j=k[0],y=k[1],x=Object(i.useState)(!1),C=Object(f.a)(x,2),N=C[0],S=C[1],I=Object(i.useState)(!1),A=Object(f.a)(I,2),B=A[0],R=A[1],L=Object(i.useState)(!1),F=Object(f.a)(L,2),U=F[0],T=F[1],M=Object(i.useState)(t.filePath),_=Object(f.a)(M,2),$=_[0],G=_[1],V=Object(i.useState)(pe.VickyMD),z=Object(f.a)(V,2),H=z[0],X=z[1],Q=Object(i.useState)(null),Z=Object(f.a)(Q,2),ee=Z[0],te=Z[1],ae=Object(i.useState)(""),oe=Object(f.a)(ae,2),ie=oe[0],ce=oe[1],ge=Object(i.useState)(!1),he=Object(f.a)(ge,2),ve=he[0],we=he[1],Oe=W.useContainer(),Ee=Object(b.b)().t,ke=Object(i.useCallback)((function(){R(!1),G(t.filePath)}),[t]),je=Object(i.useCallback)((function(e){Object(o.a)(r.a.mark((function a(){return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if((e=e.replace(/^\/+/,"")).endsWith(".md")||(e+=".md"),t.filePath===e){a.next=5;break}return a.next=5,Oe.changeNoteFilePath(t,e);case 5:G(e),R(!1);case 7:case"end":return a.stop()}}),a)})))()}),[t,ke]),ye=Object(i.useCallback)((function(){new m.a({type:"info",text:"Pulling notebook...",layout:"topRight",theme:"relax",timeout:2e3}).show(),Oe.pullNotebook({notebook:t.notebook,onAuthFailure:function(){new m.a({type:"error",text:"Authentication failed",layout:"topRight",theme:"relax",timeout:5e3}).show()}}).then((function(){new m.a({type:"success",text:"Notebook pulled",layout:"topRight",theme:"relax",timeout:2e3}).show()})).catch((function(e){console.log(e),new m.a({type:"error",text:"Failed to pull notebook",layout:"topRight",theme:"relax",timeout:2e3}).show()}))}),[t]),xe=Object(i.useCallback)((function(){Oe.checkoutNote(t)}),[t]);return Object(i.useEffect)((function(){G(t.filePath)}),[t.filePath]),Object(i.useEffect)((function(){Oe.crossnote.getStatus(t).then((function(e){ce(e)}))}),[t]),Object(i.useEffect)((function(){Oe.displayMobileEditor||h(null)}),[Oe.displayMobileEditor]),Object(i.useEffect)((function(){if(s&&!g){var e=be.fromTextArea(s,{mode:{name:"hypermd",hashtag:!0},inputStyle:"textarea"});e.setOption("lineNumbers",!1),e.setOption("foldGutter",!1),e.setValue(t.markdown||""),e.on("cursorActivity",(function(e){var t=e.getCursor();t&&y({line:t.line,ch:t.ch})})),h(e)}}),[s,t,g]),Object(i.useEffect)((function(){if(g&&t){g.setValue(t.markdown);var e=function(){var e=g.getValue();Oe.updateNoteMarkdown(t,e,(function(e){ce(e)}))};return g.on("changes",e),function(){g.off("changes",e)}}}),[g,t]),Object(i.useEffect)((function(){g&&(H===pe.VickyMD?(be.switchToHyperMD(g),g.getWrapperElement().style.display="block"):H===pe.SourceCode?(be.switchToNormal(g),g.getWrapperElement().style.display="block"):g.getWrapperElement().style.display="none")}),[H,g,t]),Object(i.useEffect)((function(){H===pe.Preview&&g&&ee&&(Object(de.renderPreview)(ee,g.getValue()),ee.childElementCount&&"IFRAME"===ee.children[0].tagName.toUpperCase()?(ee.style.maxWidth="100%",ee.style.height="100%",ee.style.overflow="hidden !important"):(ee.style.height="auto",ee.style.overflow="hidden !important"))}),[H,g,ee,t]),c.a.createElement(w.a,{className:Object(P.a)(a.editorPanel)},c.a.createElement(w.a,{className:Object(P.a)(a.topPanel)},c.a.createElement(w.a,{className:Object(P.a)(a.row)},c.a.createElement(le.a,{className:Object(P.a)(a.backBtn)},c.a.createElement(re.a,{className:Object(P.a)(a.controlBtn),onClick:function(){Oe.setDisplayMobileEditor(!1)}},c.a.createElement(D.d,null))),c.a.createElement(le.a,{variant:"outlined",color:"default","aria-label":"editor mode"},c.a.createElement(se.a,{title:Ee("general/vickymd")},c.a.createElement(re.a,{className:Object(P.a)(a.controlBtn,H===pe.VickyMD&&a.controlBtnSelected),color:H===pe.VickyMD?"primary":"default",onClick:function(){return X(pe.VickyMD)}},c.a.createElement(D.r,null))),c.a.createElement(se.a,{title:Ee("editor/note-control/source-code")},c.a.createElement(re.a,{className:Object(P.a)(a.controlBtn,H===pe.SourceCode&&a.controlBtnSelected),color:H===pe.SourceCode?"primary":"default",onClick:function(){return X(pe.SourceCode)}},c.a.createElement(D.i,null))),c.a.createElement(se.a,{title:Ee("editor/note-control/preview")},c.a.createElement(re.a,{className:Object(P.a)(a.controlBtn,H===pe.Preview&&a.controlBtnSelected),color:H===pe.Preview?"primary":"default",onClick:function(){return X(pe.Preview)}},c.a.createElement(D.m,null)))),c.a.createElement(le.a,{style:{marginLeft:"8px"}},c.a.createElement(se.a,{title:"Fullscreen"},c.a.createElement(re.a,{className:Object(P.a)(a.controlBtn),onClick:function(){return we(!0)}},c.a.createElement(D.n,null)))),c.a.createElement(le.a,{style:{marginLeft:"8px"}},c.a.createElement(se.a,{title:"Change file path"},c.a.createElement(re.a,{className:Object(P.a)(a.controlBtn),onClick:function(){return R(!0)}},c.a.createElement(D.t,null))),c.a.createElement(se.a,{title:"Restore (checkout)"},c.a.createElement(re.a,{className:Object(P.a)(a.controlBtn),onClick:xe},c.a.createElement(D.u,null))),c.a.createElement(se.a,{title:"Delete file"},c.a.createElement(re.a,{className:Object(P.a)(a.controlBtn),onClick:function(){return S(!0)}},c.a.createElement(D.k,null)))),t.notebook.gitURL&&c.a.createElement(le.a,{style:{marginLeft:"8px"}},c.a.createElement(se.a,{title:"Push"},c.a.createElement(re.a,{className:Object(P.a)(a.controlBtn),onClick:function(){return T(!0)}},c.a.createElement(D.h,null))),c.a.createElement(se.a,{title:"Pull"},c.a.createElement(re.a,{className:Object(P.a)(a.controlBtn),onClick:ye,disabled:Oe.isPullingNotebook},c.a.createElement(D.g,null)))))),c.a.createElement(w.a,{className:Object(P.a)(a.editorWrapper,ve?a.fullScreen:null)},c.a.createElement("textarea",{className:Object(P.a)(a.editor,"editor-textarea"),placeholder:"#  Hi \ud83d\ude00",ref:function(e){u(e)}}),H===pe.Preview&&g?c.a.createElement("div",{className:Object(P.a)(a.preview,"preview"),id:"preview",ref:function(e){te(e)}}):null,ve&&c.a.createElement(E.a,{style:{position:"fixed",right:"0",top:"0",zIndex:2001},onClick:function(){return we(!1)}},c.a.createElement(D.o,null))),c.a.createElement(w.a,{className:Object(P.a)(a.bottomPanel)},c.a.createElement(w.a,{className:Object(P.a)(a.row)},c.a.createElement(O.a,{variant:"caption",style:{cursor:"pointer"},onClick:function(){R(!0)}},t.filePath),c.a.createElement(O.a,{variant:"caption",style:{marginLeft:"4px"}},"- "+ie)),c.a.createElement(w.a,{className:Object(P.a)(a.cursorPositionInfo)},c.a.createElement(O.a,{variant:"caption"},"Ln ".concat(j.line+1,", Col ").concat(j.ch)))),c.a.createElement(K.a,{open:N,onClose:function(){return S(!1)}},c.a.createElement(J.a,null,"Are you sure to delete this file?"),c.a.createElement(Y.a,null,c.a.createElement(ue.a,null,"Can't be undone")),c.a.createElement(ne.a,null,c.a.createElement(re.a,{style:{color:"red"},onClick:function(){Oe.deleteNote(t),S(!1)}},"Delete"),c.a.createElement(re.a,{onClick:function(){return S(!1)}},"Cancel"))),c.a.createElement(K.a,{open:B,onClose:ke},c.a.createElement(J.a,null,"Change file path"),c.a.createElement(Y.a,null,c.a.createElement(q.a,{value:$,autoFocus:!0,onChange:function(e){return G(e.target.value)},onKeyUp:function(e){13===e.which&&je($)}})),c.a.createElement(ne.a,null,c.a.createElement(re.a,{onClick:function(){return je($)}},"Save"),c.a.createElement(re.a,{onClick:ke},"Cancel"))),c.a.createElement(me,{open:U,onClose:function(){return T(!1)},notebook:t.notebook}))}function he(e){var t=W.useContainer(),a=Object(i.useState)(""),n=Object(f.a)(a,2),l=n[0],s=n[1],u=Object(i.useState)(!1),d=Object(f.a)(u,2),p=d[0],b=d[1],g=Object(i.useState)(""),h=Object(f.a)(g,2),v=h[0],E=h[1],k=Object(i.useState)(""),j=Object(f.a)(k,2),y=j[0],x=j[1],C=Object(i.useState)(""),N=Object(f.a)(C,2),S=N[0],P=N[1],I=Object(i.useState)(""),A=Object(f.a)(I,2),B=A[0],R=A[1],L=Object(i.useState)("https://cors.isomorphic-git.org"),F=Object(f.a)(L,2),U=F[0],T=F[1],M=Object(i.useState)(!1),_=Object(f.a)(M,2),$=_[0],G=_[1],V=Object(i.useCallback)(Object(o.a)(r.a.mark((function a(){return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,new m.a({type:"info",text:"Getting notebook...",layout:"topRight",theme:"relax",timeout:2e3}).show(),a.next=4,t.addNotebook(l,v,y,S,B,$,U);case 4:e.onClose(),a.next=11;break;case 7:a.prev=7,a.t0=a.catch(0),new m.a({type:"error",text:"Failed to get notebook...",layout:"topRight",theme:"relax",timeout:2e3}).show(),e.onClose();case 11:case"end":return a.stop()}}),a,null,[[0,7]])}))),[e,l,v,y,S,B,$,U]);return c.a.createElement(K.a,{open:e.open,onClose:function(){t.isAddingNotebook||e.onClose()}},c.a.createElement(J.a,null,"Add a notebook"),c.a.createElement(Y.a,null,c.a.createElement(q.a,{label:"Notebook name",value:l,fullWidth:!0,onChange:function(e){s(e.target.value)},style:{marginBottom:"16px"}}),c.a.createElement(X.a,{elevation:2,expanded:p,onChange:function(){return b(!p)}},c.a.createElement(Q.a,{expandIcon:c.a.createElement(D.c,null)},c.a.createElement(O.a,null,"Git repository (optional)")),c.a.createElement(Z.a,null,c.a.createElement(w.a,null,c.a.createElement(q.a,{label:"url",placeholder:"https://abc/def.git",fullWidth:!0,value:v,onChange:function(e){return E(e.target.value)}}),c.a.createElement(q.a,{label:"branch",placeholder:"master",fullWidth:!0,value:y,onChange:function(e){return x(e.target.value)}}),c.a.createElement(q.a,{label:"username (optional)",placeholder:"username (optional)",fullWidth:!0,value:S,onChange:function(e){return P(e.target.value)}}),c.a.createElement(q.a,{label:"password (optional)",placeholder:"password (optional)",type:"password",fullWidth:!0,value:B,onChange:function(e){return R(e.target.value)}}),c.a.createElement(ee.a,{control:c.a.createElement(te.a,{checked:$,onChange:function(){return G(!$)},value:$}),label:c.a.createElement(O.a,null,"Remember credentials "+($?"(stored locally)":""))}),c.a.createElement(q.a,{label:"cors proxy",placeholder:"https://cors.isomorphic-git.org",fullWidth:!0,value:U,onChange:function(e){return T(e.target.value)}}),c.a.createElement(ae.a,{href:"https://github.com/isomorphic-git/isomorphic-git#cors-support",target:"_blank"},"Why we need cors proxy?"))))),c.a.createElement(ne.a,null,c.a.createElement(re.a,{variant:"contained",color:"primary",onClick:V,disabled:t.isAddingNotebook},t.isAddingNotebook?"Adding...":"Add"),e.canCancel&&c.a.createElement(re.a,{onClick:e.onClose},"Cancel")))}!function(e){e.VickyMD="VickyMD",e.SourceCode="SourceCode",e.Preview="Preview"}(pe||(pe={}));var ve=a(5526),we=a(5527),Oe=Object(C.a)((function(e){return Object(N.a)({treeItemRoot:{paddingLeft:"4px","&:focus > $treeItemContent":{color:"#1a73e8",backgroundColor:"#e8f0fe"},"&:focus > $treeItemLabelIcon":{color:"#1a73e8"}},treeItemContent:{cursor:"default",color:e.palette.text.primary,paddingLeft:e.spacing(1),paddingRight:e.spacing(1),userSelect:"none",fontWeight:e.typography.fontWeightMedium,"$treeItemExpanded > &":{fontWeight:e.typography.fontWeightRegular}},treeItemGroup:{marginLeft:0,"& $treeItemContent":{paddingLeft:e.spacing(2)}},treeItemExpanded:{},treeItemLabel:{fontWeight:"inherit",color:"inherit"},treeItemLabelRoot:{display:"flex",alignItems:"center",padding:e.spacing(1,0)},treeItemLabelIcon:{color:"rgba(0, 0, 0, 0.54)"},treeItemLabelText:{paddingLeft:"12px",flexGrow:1}})}));function Ee(e){var t=Oe(),a=W.useContainer(),n=Object(i.useState)([]),r=Object(f.a)(n,2),o=r[0],l=r[1],s=Object(i.useCallback)((function(t,n){t.stopPropagation();var r=t.target;r&&r.tagName&&r.tagName.toUpperCase().match(/^(SVG|PATH|BUTTON)$/)&&(a.setSelectedNotebook(e.notebook),l(n))}),[e.notebook]);return Object(i.useEffect)((function(){a.selectedNotebook!==e.notebook&&l([])}),[a.selectedNotebook,e.notebook]),c.a.createElement(we.a,{defaultExpandIcon:c.a.createElement(E.a,{disableFocusRipple:!0,disableRipple:!0,size:"medium"},c.a.createElement(D.e,null)),defaultCollapseIcon:c.a.createElement(E.a,{disableFocusRipple:!0,disableRipple:!0,size:"medium"},c.a.createElement(D.c,null)),defaultEndIcon:c.a.createElement("div",{style:{width:24}}),expanded:o,onNodeToggle:s,style:{width:"100%"}},c.a.createElement(ve.a,{nodeId:"notes",classes:{root:t.treeItemRoot,content:t.treeItemContent,expanded:t.treeItemExpanded,group:t.treeItemGroup,label:t.treeItemLabel},label:c.a.createElement(w.a,{onClick:function(){a.setSelectedNotebook(e.notebook),a.setSelectedDir("$notes")},className:Object(P.a)(t.treeItemLabelRoot)},c.a.createElement(O.a,{color:"inherit",variant:"body1",className:Object(P.a)(t.treeItemLabelText)},e.notebook.name))},function e(n){return"."===n.name?c.a.createElement(c.a.Fragment,null,n.children.map((function(t){return e(t)}))):c.a.createElement(ve.a,{nodeId:n.name,classes:{root:t.treeItemRoot,content:t.treeItemContent,expanded:t.treeItemExpanded,group:t.treeItemGroup,label:t.treeItemLabel},endIcon:c.a.createElement("div",{style:{width:24}}),key:n.name,label:c.a.createElement(w.a,{onClick:function(){a.setSelectedDir(n.path)},className:Object(P.a)(t.treeItemLabelRoot)},c.a.createElement("span",{role:"img","aria-label":"folder"},"\ud83d\udcc1"),c.a.createElement(O.a,{color:"inherit",variant:"body1",className:Object(P.a)(t.treeItemLabelText)},n.name))},n.children.map((function(t){return e(t)})))}(a.notebookDirectories)))}var ke=Object(C.a)((function(e){return Object(N.a)({page:{display:"flex",width:"100%",height:"100%",backgroundColor:"#2196F1"},appBar:{zIndex:e.zIndex.drawer+1,boxShadow:"none"},toolBar:{display:"flex",flexDirection:"row",justifyContent:"space-between"},search:Object(g.a)({position:"relative",borderRadius:e.shape.borderRadius,backgroundColor:Object(S.b)(e.palette.common.white,.15),"&:hover":{backgroundColor:Object(S.b)(e.palette.common.white,.25)},marginRight:e.spacing(2),marginLeft:0,width:"100%"},e.breakpoints.up("sm"),{marginLeft:e.spacing(3),width:"auto"}),searchIcon:{width:e.spacing(7),height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"},inputRoot:{color:"inherit"},inputInput:Object(g.a)({padding:e.spacing(1,1,1,7),transition:e.transitions.create("width"),width:"100%"},e.breakpoints.up("md"),{width:200}),displayNone:{display:"none"},drawer:Object(g.a)({},e.breakpoints.up("sm"),{width:200,flexShrink:0}),drawerPaper:{width:200},selectedSection:{backgroundColor:"#ccc"},left:{display:"flex",flexDirection:"row",alignItems:"center"},menuButton:{marginRight:e.spacing(2)},mainPanel:{position:"relative",display:"flex",flexDirection:"row",flexGrow:1,overflow:"auto",backgroundColor:"#eee"},notesPanel:Object(g.a)({width:"350px",maxWidth:"100%",height:"100%"},e.breakpoints.down("xs"),{width:"100%"}),editorPanel:Object(g.a)({flex:"1"},e.breakpoints.down("xs"),{display:"none",position:"absolute",top:"0",left:"0",width:"100%",height:"100%"}),toolBarSpace:e.mixins.toolbar})}));function je(e){var t=ke(e),a=W.useContainer(),n=Object(i.useState)(!1),r=Object(f.a)(n,2),o=r[0],l=r[1],s=Object(i.useState)(!1),u=Object(f.a)(s,2),d=u[0],m=u[1],p=Object(i.useCallback)((function(){m(!d)}),[d]),b=c.a.createElement("div",null,c.a.createElement(h.a,{disablePadding:!0},c.a.createElement(v.a,{disableGutters:!0},c.a.createElement(w.a,{style:{width:"100%",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",padding:"0 8px"}},c.a.createElement(O.a,{variant:"body1",style:{fontWeight:"bold"}},"Notebooks"),c.a.createElement(E.a,{onClick:function(){return l(!0)}},c.a.createElement(D.s,null)))),a.notebooks.map((function(e){return c.a.createElement(v.a,{disableGutters:!0,style:{padding:"0"},key:e._id},c.a.createElement(Ee,{notebook:e}))})))),g=c.a.createElement(k.a,{className:Object(P.a)(t.notesPanel)},c.a.createElement(ce,{toggleDrawer:p}));return c.a.createElement(w.a,{className:Object(P.a)(t.page)},c.a.createElement(j.a,null),c.a.createElement("nav",{className:t.drawer},c.a.createElement(y.a,{smUp:!0,implementation:"css"},c.a.createElement(x.a,{variant:"temporary",open:d,onClose:p,classes:{paper:t.drawerPaper},ModalProps:{keepMounted:!0}},b)),c.a.createElement(y.a,{xsDown:!0,implementation:"css"},c.a.createElement(x.a,{classes:{paper:t.drawerPaper},variant:"permanent",open:!0},b))),c.a.createElement(w.a,{className:Object(P.a)(t.mainPanel),id:"main-panel"},g,c.a.createElement(k.a,{className:Object(P.a)(t.editorPanel),style:{display:a.displayMobileEditor&&"block"}},a.selectedNote&&c.a.createElement(ge,{note:a.selectedNote}))),c.a.createElement(he,{open:o,onClose:function(){return l(!1)},canCancel:!0}))}var ye=a(270),xe=a(125),Ce=a(124),Ne=a(5535),Se=(a(14),a(212),a(5377),a(221),a(5379),a(5380),a(228),a(5381),a(5382),a(140),a(5383),a(138),a(134),a(136),a(139),a(5385),a(52)),Pe=a(5530),De=a(5515);function Ie(){return(Ie=Object(o.a)(r.a.mark((function e(){var t,a,n,o,i=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=i.length>0&&void 0!==i[0]?i[0]:[],a=[],n=function(e){var n=t[e];if(!n.type.match("image.*"))return"continue";a.push(new Promise((function(e,t){var a=new FormData;a.append("smfile",n),a.append("format","json"),fetch("https://sm.ms/api/v2/upload",{method:"POST",mode:"cors",headers:{},referrer:"",body:a}).then((function(e){return e.json()})).then((function(a){return a.success?e(a.data.url):"image_repeated"===a.code||"exception"===a.code&&a.message.match(/this image exists at:/)?e(a.message.match(/https:\/\/.+$/)[0]):t(a.message)})).catch((function(e){return t("Failed to connect to sm.ms host")}))})))},o=0;case 4:if(!(o<t.length)){e.next=11;break}if("continue"!==n(o)){e.next=8;break}return e.abrupt("continue",8);case 8:o++,e.next=4;break;case 11:return e.next=13,Promise.all(a);case 13:return e.abrupt("return",e.sent);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ae=Object(C.a)((function(e){return Object(N.a)({card:{padding:e.spacing(2),position:"relative"},actionButtons:{position:"absolute",top:"0",right:"0"},section:{marginTop:e.spacing(2)},dropArea:{textAlign:"center",padding:"24px",border:"4px dotted #c7c7c7",backgroundColor:"#f1f1f1",cursor:"pointer","&:hover":{backgroundColor:"#eee"}},disabled:{cursor:"not-allowed"}})}));function Be(e){var t=Ae(e),a=Object(b.b)().t,n=Object(i.useState)(""),r=Object(f.a)(n,2),o=r[0],l=r[1],s=Object(i.useState)(!1),u=Object(f.a)(s,2),d=u[0],p=u[1],g=Object(i.useState)(null),h=Object(f.a)(g,2),v=h[0],k=h[1],j=Object(i.useState)(!1),y=Object(f.a)(j,2),x=y[0],C=y[1];return e.isPreview?c.a.createElement("span",null):c.a.createElement(T.a,{elevation:2,className:Object(P.a)(t.card)},c.a.createElement(O.a,{variant:"h5"},a("widget/crossnote.image/image-helper")),c.a.createElement(w.a,{className:Object(P.a)(t.actionButtons)},c.a.createElement(se.a,{title:a("general/Delete")},c.a.createElement(E.a,{onClick:function(){return e.removeSelf()}},c.a.createElement(D.w,null)))),!x&&c.a.createElement(w.a,{className:Object(P.a)(t.section)},c.a.createElement(ee.a,{label:a("widget/crossnote.image/set-as-cover-image-in-note-card"),control:c.a.createElement(Pe.a,{checked:d,onChange:function(){return p(!d)},color:"primary"})})),!x&&c.a.createElement(w.a,{className:Object(P.a)(t.section)},c.a.createElement(O.a,{variant:"subtitle1",style:{marginBottom:"8px"}},a("general/Link")),c.a.createElement(De.a,{margin:"dense",placeholder:a("widget/crossnote.image/image-url-placeholder"),value:o,onChange:function(e){l(e.target.value)},onKeyDown:function(t){13===t.which&&e.replaceSelf("![".concat(d?"cover":"","](").concat(o,")\n"))},fullWidth:!0})),c.a.createElement(w.a,{className:Object(P.a)(t.section)},c.a.createElement(O.a,{variant:"subtitle1",style:{marginBottom:"8px"}},a("general/Upload")),c.a.createElement(w.a,{className:Object(P.a)(t.dropArea,x?t.disabled:null),onClick:function(t){t.preventDefault(),t.stopPropagation(),v&&!x&&(v.onchange=function(t){var n=t.target.files||[];new m.a({type:"info",text:a("utils/uploading-image"),layout:"topRight",theme:"relax",timeout:2e3}).show(),C(!0),function(){return Ie.apply(this,arguments)}(n).then((function(t){var a="";t.forEach((function(e){a+="![".concat(d?"cover":"","](").concat(e,")  \n")})),e.replaceSelf(a)})).catch((function(e){C(!1),new m.a({type:"error",text:a("utils/upload-image-failure"),layout:"topRight",theme:"relax",timeout:2e3}).show()}))},v.click())}},c.a.createElement(O.a,null,a(x?"utils/uploading-image":"widget/crossnote.image/click-here-to-browse-image-file")))),c.a.createElement(w.a,{className:Object(P.a)(t.section)},c.a.createElement(O.a,{variant:"caption"},a("widget/crossnote.image/thanks_sm_ms"))),c.a.createElement("input",{type:"file",multiple:!0,style:{display:"none"},ref:function(e){k(e)}}))}var Re=Object(C.a)((function(e){return Object(N.a)({card:{padding:e.spacing(2),position:"relative"},actionButtons:{position:"absolute",top:"0",right:"0"},section:{marginTop:e.spacing(2)},dropArea:{textAlign:"center",padding:"24px",border:"4px dotted #c7c7c7",backgroundColor:"#f1f1f1",cursor:"pointer","&:hover":{backgroundColor:"#eee"}},disabled:{cursor:"not-allowed"}})}));function Le(e){var t=e.attributes,a=Re(e),n=Object(b.b)().t,r=Object(i.useState)(t.source||""),o=Object(f.a)(r,2),l=o[0],s=o[1],u=Object(i.useState)(t.autoplay||!1),d=Object(f.a)(u,2),m=d[0],p=d[1],g=Object(i.useState)(t.controls||!0),h=Object(f.a)(g,2),v=h[0],k=h[1],j=Object(i.useState)(t.loop||!1),y=Object(f.a)(j,2),x=y[0],C=y[1],N=Object(i.useState)(t.muted||!1),S=Object(f.a)(N,2),I=S[0],A=S[1];return t.src?c.a.createElement("span",{style:{cursor:"default"}},c.a.createElement("audio",{autoPlay:t.autoplay||t.autoPlay,controls:t.controls,loop:t.loop,muted:t.muted,style:t.style},n("widget/crossnote.audio/audio_element_fail"),c.a.createElement("source",{src:t.src,type:t.type})),!e.isPreview&&!t.controls&&"\ud83c\udfb5"):e.isPreview?c.a.createElement("span",null):c.a.createElement(T.a,{elevation:2,className:Object(P.a)(a.card)},c.a.createElement(O.a,{variant:"h5"},n("general/Audio")),c.a.createElement(w.a,{className:Object(P.a)(a.actionButtons)},c.a.createElement(se.a,{title:n("general/Delete")},c.a.createElement(E.a,{onClick:function(){return e.removeSelf()}},c.a.createElement(D.w,null)))),c.a.createElement(w.a,{className:Object(P.a)(a.section)},c.a.createElement(O.a,{variant:"subtitle1",style:{marginBottom:"8px"}},n("general/source-url")),c.a.createElement(De.a,{margin:"dense",placeholder:n("widget/crossnote.audio/source-url-placeholder"),value:l,onChange:function(e){s(e.target.value)},onKeyDown:function(t){if(13===t.which&&l){var a={autoplay:m,controls:v,loop:x,muted:I,src:l};e.replaceSelf("`@crossnote.audio ".concat(JSON.stringify(a).replace(/^{/,"").replace(/}$/,""),"`"))}},fullWidth:!0})),c.a.createElement(w.a,{className:Object(P.a)(a.section)},c.a.createElement(ee.a,{label:n("widget/autoplay"),control:c.a.createElement(Pe.a,{checked:m,onChange:function(){return p(!m)},color:"primary"})}),c.a.createElement(ee.a,{label:n("widget/controls"),control:c.a.createElement(Pe.a,{checked:v,onChange:function(){return k(!v)},color:"primary"})}),c.a.createElement(ee.a,{label:n("widget/loop"),control:c.a.createElement(Pe.a,{checked:x,onChange:function(){return C(!x)},color:"primary"})}),c.a.createElement(ee.a,{label:n("widget/muted"),control:c.a.createElement(Pe.a,{checked:I,onChange:function(){return A(!I)},color:"primary"})})))}var Fe=Object(C.a)((function(e){return Object(N.a)({card:{padding:e.spacing(2),position:"relative"},actionButtons:{position:"absolute",top:"0",right:"0"},section:{marginTop:e.spacing(2)},dropArea:{textAlign:"center",padding:"24px",border:"4px dotted #c7c7c7",backgroundColor:"#f1f1f1",cursor:"pointer","&:hover":{backgroundColor:"#eee"}},disabled:{cursor:"not-allowed"}})}));function Ue(e){var t=e.attributes,a=Fe(e),n=Object(b.b)().t,r=Object(i.useState)(t.id||""),o=Object(f.a)(r,2),l=o[0],s=o[1],u=Object(i.useState)(t.autoplay||!1),d=Object(f.a)(u,2),m=d[0],p=d[1];return t.id?c.a.createElement("iframe",{title:"netease_music_"+t.id,style:{maxWidth:"100%",width:"333px",height:"86px",border:"none"},src:"https://music.163.com/outchain/player?type=2&id=".concat(t.id,"&auto=").concat(t.autoplay?"1":"0","&height=66")}):e.isPreview?c.a.createElement("span",null):c.a.createElement(T.a,{elevation:2,className:Object(P.a)(a.card)},c.a.createElement(O.a,{variant:"h5"},n("general/Audio")),c.a.createElement(w.a,{className:Object(P.a)(a.actionButtons)},c.a.createElement(se.a,{title:n("general/Delete")},c.a.createElement(E.a,{onClick:function(){return e.removeSelf()}},c.a.createElement(D.w,null)))),c.a.createElement(w.a,{className:Object(P.a)(a.section)},c.a.createElement(O.a,{variant:"subtitle1",style:{marginBottom:"8px"}},n("general/ID")),c.a.createElement(De.a,{margin:"dense",placeholder:n("widget/crossnote.neteasemusic/song-id-placeholder"),value:l,onChange:function(e){s(e.target.value)},onKeyDown:function(t){if(13===t.which&&l){var a={autoplay:m,id:l};e.replaceSelf("`@crossnote.netease_music ".concat(JSON.stringify(a).replace(/^{/,"").replace(/}$/,""),"`"))}},fullWidth:!0})),c.a.createElement(w.a,{className:Object(P.a)(a.section)},c.a.createElement(ee.a,{label:n("widget/autoplay"),control:c.a.createElement(Pe.a,{checked:m,onChange:function(){return p(!m)},color:"primary"})})))}var We=Object(C.a)((function(e){return Object(N.a)({card:{padding:e.spacing(2),position:"relative"},actionButtons:{position:"absolute",top:"0",right:"0"},section:{marginTop:e.spacing(2)},videoWrapper:{cursor:"default",position:"relative",width:"100%",height:"0",paddingTop:"56.25%"},video:{position:"absolute",left:"0",top:"0",width:"100%",height:"100%"}})}));function Te(e){var t=e.attributes,a=We(e),n=Object(b.b)().t,r=Object(i.useState)(t.source||""),o=Object(f.a)(r,2),l=o[0],s=o[1],u=Object(i.useState)(t.autoplay||!1),d=Object(f.a)(u,2),m=d[0],p=d[1],g=Object(i.useState)(t.controls||!0),h=Object(f.a)(g,2),v=h[0],k=h[1],j=Object(i.useState)(t.loop||!1),y=Object(f.a)(j,2),x=y[0],C=y[1],N=Object(i.useState)(t.muted||!1),S=Object(f.a)(N,2),I=S[0],A=S[1],B=Object(i.useState)(t.poster||""),R=Object(f.a)(B,2),L=R[0],F=R[1];return t.src?c.a.createElement("span",{style:{cursor:"default"}},c.a.createElement(w.a,{className:Object(P.a)(a.videoWrapper)},c.a.createElement("video",{className:Object(P.a)(a.video),autoPlay:t.autoplay||t.autoPlay,controls:t.controls,loop:t.loop,muted:t.muted,style:t.style,poster:t.poster},n("widget/crossnote.video/video_element_fail"),c.a.createElement("source",{src:t.src,type:t.type})))):e.isPreview?c.a.createElement("span",null):c.a.createElement(T.a,{elevation:2,className:Object(P.a)(a.card)},c.a.createElement(O.a,{variant:"h5"},n("general/Video")),c.a.createElement(w.a,{className:Object(P.a)(a.actionButtons)},c.a.createElement(se.a,{title:n("general/Delete")},c.a.createElement(E.a,{onClick:function(){return e.removeSelf()}},c.a.createElement(D.w,null)))),c.a.createElement(w.a,{className:Object(P.a)(a.section)},c.a.createElement(O.a,{variant:"subtitle1",style:{marginBottom:"8px"}},n("general/source-url")),c.a.createElement(De.a,{margin:"dense",placeholder:n("widget/crossnote.video/video-url-placeholder"),value:l,onChange:function(e){s(e.target.value)},onKeyDown:function(t){if(13===t.which&&l){var a={autoplay:m,controls:v,loop:x,muted:I,src:l,poster:L};e.replaceSelf("`@crossnote.video ".concat(JSON.stringify(a).replace(/^{/,"").replace(/}$/,""),"`"))}},fullWidth:!0})),c.a.createElement(w.a,{className:Object(P.a)(a.section)},c.a.createElement(O.a,{variant:"subtitle1",style:{marginBottom:"8px"}},n("widget/crossnote.video/poster-url")),c.a.createElement(De.a,{margin:"dense",placeholder:n("widget/crossnote.video/poster-url-placeholder"),value:L,onChange:function(e){F(e.target.value)},fullWidth:!0})),c.a.createElement(w.a,{className:Object(P.a)(a.section)},c.a.createElement(ee.a,{label:n("widget/autoplay"),control:c.a.createElement(Pe.a,{checked:m,onChange:function(){return p(!m)},color:"primary"})}),c.a.createElement(ee.a,{label:n("widget/controls"),control:c.a.createElement(Pe.a,{checked:v,onChange:function(){return k(!v)},color:"primary"})}),c.a.createElement(ee.a,{label:n("widget/loop"),control:c.a.createElement(Pe.a,{checked:x,onChange:function(){return C(!x)},color:"primary"})}),c.a.createElement(ee.a,{label:n("widget/muted"),control:c.a.createElement(Pe.a,{checked:I,onChange:function(){return A(!I)},color:"primary"})})))}var Me=Object(C.a)((function(e){return Object(N.a)({card:{padding:e.spacing(2),position:"relative"},actionButtons:{position:"absolute",top:"0",right:"0"},section:{marginTop:e.spacing(2)},videoWrapper:{cursor:"default",position:"relative",width:"100%",height:"0",paddingTop:"56.25%"},video:{backgroundColor:"#ddd",border:"none",position:"absolute",left:"0",top:"0",width:"100%",height:"100%"},errorMessage:{color:"#f44336",marginTop:e.spacing(2)}})}));function _e(e){var t=e.attributes,a=Me(e),n=Object(b.b)().t,r=Object(i.useState)(""),o=Object(f.a)(r,2),l=o[0],s=o[1],u=Object(i.useState)(""),d=Object(f.a)(u,2),m=d[0],p=d[1];return t.aid?c.a.createElement("span",{style:{cursor:"default"}},c.a.createElement(w.a,{className:Object(P.a)(a.videoWrapper)},c.a.createElement("iframe",{title:"bilibili_"+t.id,className:Object(P.a)(a.video),src:"https://player.bilibili.com/player.html?aid=".concat(t.aid),scrolling:"no",frameBorder:"no",allowFullScreen:!0}))):e.isPreview?c.a.createElement("span",null):c.a.createElement(T.a,{elevation:2,className:Object(P.a)(a.card)},c.a.createElement(O.a,{variant:"h5"},n("widget/crossnote.bilibili/Bilibili")),c.a.createElement(w.a,{className:Object(P.a)(a.actionButtons)},c.a.createElement(se.a,{title:n("general/Delete")},c.a.createElement(E.a,{onClick:function(){return e.removeSelf()}},c.a.createElement(D.w,null)))),c.a.createElement(w.a,{className:Object(P.a)(a.section)},c.a.createElement(O.a,{variant:"subtitle1",style:{marginBottom:"8px"}},n("widget/crossnote.bilibili/bilibili-video-url")),c.a.createElement(De.a,{margin:"dense",placeholder:n("widget/crossnote.bilibili/url-placeholder"),value:l,onChange:function(e){s(e.target.value),p("")},onKeyDown:function(t){if(13===t.which)if(l&&l.match(/bilibili\.com\/video\/av(\d+)/)){var a={aid:l.match(/bilibili\.com\/video\/av(\d+)/)[1]};e.replaceSelf("`@crossnote.bilibili ".concat(JSON.stringify(a).replace(/^{/,"").replace(/}$/,""),"`"))}else p(n("widget/crossnote.bilibili/error_message"))},fullWidth:!0}),c.a.createElement(O.a,{className:Object(P.a)(a.errorMessage)},m)))}var $e=Object(C.a)((function(e){return Object(N.a)({card:{padding:e.spacing(2),position:"relative"},actionButtons:{position:"absolute",top:"0",right:"0"},section:{marginTop:e.spacing(2)},videoWrapper:{cursor:"default",position:"relative",width:"100%",height:"0",paddingTop:"56.25%"},video:{backgroundColor:"#ddd",border:"none",position:"absolute",left:"0",top:"0",width:"100%",height:"100%"},errorMessage:{color:"#f44336",marginTop:e.spacing(2)}})}));function Ge(e){var t=e.attributes,a=$e(e),n=Object(b.b)().t,r=Object(i.useState)(""),o=Object(f.a)(r,2),l=o[0],s=o[1],u=Object(i.useState)(""),d=Object(f.a)(u,2),m=d[0],p=d[1];return t.videoID?c.a.createElement("span",{style:{cursor:"default"}},c.a.createElement(w.a,{className:Object(P.a)(a.videoWrapper)},c.a.createElement("iframe",{title:"youtube_"+t.videoID,className:Object(P.a)(a.video),src:"https://www.youtube.com/embed/".concat(t.videoID),scrolling:"no",frameBorder:"no",allowFullScreen:!0}))):e.isPreview?c.a.createElement("span",null):c.a.createElement(T.a,{elevation:2,className:Object(P.a)(a.card)},c.a.createElement(O.a,{variant:"h5"},n("Youtube")),c.a.createElement(w.a,{className:Object(P.a)(a.actionButtons)},c.a.createElement(se.a,{title:n("general/Delete")},c.a.createElement(E.a,{onClick:function(){return e.removeSelf()}},c.a.createElement(D.w,null)))),c.a.createElement(w.a,{className:Object(P.a)(a.section)},c.a.createElement(O.a,{variant:"subtitle1",style:{marginBottom:"8px"}},n("Youtube video URL")),c.a.createElement(De.a,{margin:"dense",placeholder:n("widget/crossnote.youtube/youtube-video-url-placeholder"),value:l,onChange:function(e){s(e.target.value),p("")},onKeyDown:function(t){if(13===t.which)if(l&&l.match(/youtube\.com\/watch\?v=(.+?)$/)){var a={videoID:l.match(/youtube\.com\/watch\?v=(.+?)$/)[1]};e.replaceSelf("`@crossnote.youtube ".concat(JSON.stringify(a).replace(/^{/,"").replace(/}$/,""),"`"))}else p(n("widget/crossnote.youtube/error_message"))},fullWidth:!0}),c.a.createElement(O.a,{className:Object(P.a)(a.errorMessage)},m)))}var Ve=a(5531),ze=a(5532),He=a(5533),Ke=a(260),Je=Object(C.a)((function(e){return Object(N.a)({card:{padding:e.spacing(2),position:"relative"},actionButtons:{position:"absolute",top:"0",right:"0"},section:{marginTop:e.spacing(2)},dropArea:{textAlign:"center",padding:"24px",border:"4px dotted #c7c7c7",backgroundColor:"#f1f1f1",cursor:"pointer","&:hover":{backgroundColor:"#eee"}},canvasWrapper:{marginTop:e.spacing(2)},canvas:{maxWidth:"100%"},disabled:{cursor:"not-allowed"}})}));function Ye(e){var t=Je(e),a=Object(b.b)().t,n=Object(i.useState)(null),l=Object(f.a)(n,2),s=l[0],u=l[1],d=Object(i.useState)(""),m=Object(f.a)(d,2),p=m[0],g=m[1],k=Object(i.useState)(""),j=Object(f.a)(k,2),y=j[0],x=j[1],C=Object(i.useState)(""),N=Object(f.a)(C,2),S=N[0],A=N[1],B=Object(i.useState)(null),R=Object(f.a)(B,2),L=R[0],F=R[1],U=Object(i.useState)(!1),W=Object(f.a)(U,2),M=W[0],_=W[1],$=Object(i.useState)([]),G=Object(f.a)($,2),V=G[0],z=G[1],H=Object(i.useState)(function(){try{return JSON.parse(localStorage.getItem("widget/crossnote.ocr/languages")||'["eng"]')}catch(e){return["eng"]}}()),K=Object(f.a)(H,2),J=K[0],Y=K[1],q=Object(i.useState)(!!localStorage.getItem("widget/crossnote.ocr/grayscale")||!0),X=Object(f.a)(q,2),Q=X[0],Z=X[1];function ae(e){Y((function(t){var a=t.indexOf(e);return a>=0?(t.splice(a,1),t=Object(I.a)(t)):t=[].concat(Object(I.a)(t),[e]),localStorage.setItem("widget/crossnote.ocr/languages",JSON.stringify(t)),t}))}return Object(i.useEffect)((function(){if(s&&y){var e=new Image,t=s.getContext("2d");e.onload=function(){s.width=e.width,s.height=e.height,t.clearRect(0,0,s.width,s.height),Q&&(t.fillStyle="#FFF",t.fillRect(0,0,s.width,s.height),t.globalCompositeOperation="luminosity"),t.drawImage(e,0,0),A(s.toDataURL())},e.onerror=function(e){throw e},e.setAttribute("crossOrigin","anonymous"),e.src=y}}),[s,y,Q]),e.isPreview?c.a.createElement("span",null):M?c.a.createElement(T.a,{elevation:2,className:Object(P.a)(t.card)},c.a.createElement(O.a,{variant:"h5"},a("general/Processing")),c.a.createElement(h.a,null,V.length>0&&c.a.createElement(v.a,null,c.a.createElement(Ve.a,null,a("tesseract/"+V[V.length-1].status)),c.a.createElement(ze.a,null,Math.floor(100*V[V.length-1].progress).toString()+"%")))):y?c.a.createElement(T.a,{elevation:2,className:Object(P.a)(t.card)},c.a.createElement(w.a,{className:Object(P.a)(t.section)},c.a.createElement(O.a,{variant:"subtitle1",style:{marginBottom:"8px"}},a("widget/crossnote.ocr/recognize-text-in-languages")),c.a.createElement(He.a,null,c.a.createElement(ee.a,{control:c.a.createElement(te.a,{checked:J.indexOf("eng")>=0,onChange:function(){return ae("eng")},value:"eng"}),label:"English"}),c.a.createElement(ee.a,{control:c.a.createElement(te.a,{checked:J.indexOf("chi_sim")>=0,onChange:function(){return ae("chi_sim")},value:"chi_sim"}),label:"\u7b80\u4f53\u4e2d\u6587"}),c.a.createElement(ee.a,{control:c.a.createElement(te.a,{checked:J.indexOf("chi_tra")>=0,onChange:function(){return ae("chi_tra")},value:"chi_tra"}),label:"\u7e41\u9ad4\u4e2d\u6587"}),c.a.createElement(ee.a,{control:c.a.createElement(te.a,{checked:J.indexOf("jpn")>=0,onChange:function(){return ae("jpn")},value:"jpn"}),label:"\u65e5\u672c\u8a9e"}))),c.a.createElement(w.a,{className:Object(P.a)(t.section)},c.a.createElement(O.a,{variant:"subtitle1",style:{marginBottom:"8px"}},a("widget/crossnote.ocr/extra-settings")),c.a.createElement(ee.a,{control:c.a.createElement(Pe.a,{checked:Q,onChange:function(){Q?localStorage.removeItem("widget/crossnote.ocr/grayscale"):localStorage.setItem("widget/crossnote.ocr/grayscale","true"),Z(!Q)},color:"primary"}),label:a("widget/crossnote.ocr/grayscale")})),c.a.createElement(w.a,{className:Object(P.a)(t.canvasWrapper)},c.a.createElement("canvas",{className:Object(P.a)(t.canvas),ref:function(e){return u(e)}})),c.a.createElement(le.a,null,c.a.createElement(re.a,{onClick:function(){x(""),A("")}},a("general/go-back")),c.a.createElement(re.a,{color:"primary",onClick:function(){return function(t){var a=Object(Ke.createWorker)({logger:function(e){z((function(t){return t.length&&t[t.length-1].status===e.status?[].concat(Object(I.a)(t.slice(0,t.length-1)),[e]):[].concat(Object(I.a)(t),[e])}))}});Object(o.a)(r.a.mark((function n(){var o,i,c;return r.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return _(!0),0===(o=J).length&&(o=["eng"]),n.next=5,a.load();case 5:return n.next=7,a.loadLanguage(o.join("+"));case 7:return n.next=9,a.initialize(o.join("+"));case 9:return n.next=11,a.recognize(t);case 11:return i=n.sent,c=i.data.text,e.replaceSelf("\n"+c),n.next=16,a.terminate();case 16:_(!1);case 17:case"end":return n.stop()}}),n)})))()}(S)},disabled:!S},a("widget/crossnote.ocr/start-ocr")))):c.a.createElement(T.a,{elevation:2,className:Object(P.a)(t.card)},c.a.createElement(O.a,{variant:"h5"},a("widget/crossnote.ocr/ocr")),c.a.createElement(w.a,{className:Object(P.a)(t.actionButtons)},c.a.createElement(se.a,{title:a("general/Delete")},c.a.createElement(E.a,{onClick:function(){return e.removeSelf()}},c.a.createElement(D.w,null)))),c.a.createElement(w.a,{className:Object(P.a)(t.section)},c.a.createElement(O.a,{variant:"subtitle1",style:{marginBottom:"8px"}},a("general/Link")),c.a.createElement(De.a,{margin:"dense",placeholder:a("widget/crossnote.image/image-url-placeholder"),value:p,onChange:function(e){g(e.target.value)},onKeyDown:function(e){13===e.which&&function(){try{x(p)}catch(e){}}()},fullWidth:!0})),c.a.createElement(O.a,{variant:"subtitle1",style:{marginTop:"16px",textAlign:"center"}},a("widget/crossnote.auth/Or")),c.a.createElement(w.a,{className:Object(P.a)(t.section)},c.a.createElement(O.a,{variant:"subtitle1",style:{marginBottom:"8px"}},a("widget/crossnote.ocr/local-image")),c.a.createElement(w.a,{className:Object(P.a)(t.dropArea,M?t.disabled:null),onClick:function(e){e.preventDefault(),e.stopPropagation(),L&&!M&&(L.onchange=function(e){var t=e.target.files||[];if(t.length)try{var a=t[0],n=new FileReader;n.readAsDataURL(a),n.onload=function(){x(n.result)},n.onerror=function(e){throw e}}catch(r){}},L.click())}},c.a.createElement(O.a,null,a(M?"utils/uploading-image":"widget/crossnote.image/click-here-to-browse-image-file")))),c.a.createElement("input",{type:"file",style:{display:"none"},ref:function(e){F(e)}}))}var qe=a(103),Xe=a(5534),Qe=a(261),Ze=a.n(Qe),et=a(140),tt=Object(C.a)((function(e){return Object(N.a)({laneHeader:{width:"256px",maxWidth:"100%",display:"flex",alignItems:"center",justifyContent:"space-between"},kanbanCard:Object(g.a)({width:"256px",maxWidth:"100%",position:"relative"},e.breakpoints.down("sm"),{marginTop:"4px",marginBottom:"4px"}),editorWrapper:{"& .CodeMirror-gutters":{display:"none"}},textarea:{width:"100%",height:"100%"},preview:{padding:e.spacing(2)}})}));function at(e){var t=tt(e),a=Object(b.b)().t,n=e.lane,r=e.board,o=e.isPreview,l=e.refreshBoard,s=Object(i.useState)(!1),u=Object(f.a)(s,2),d=u[0],m=u[1],p=Object(i.useState)(n.title),g=Object(f.a)(p,2),h=g[0],v=g[1];return Object(i.useEffect)((function(){d||h===n.title||(n.title=h||a("general/Untitled"),v(n.title),l(r))}),[d,r,n.title,h,a,l]),c.a.createElement(w.a,{className:Object(P.a)(t.laneHeader)},c.a.createElement(w.a,null,d?c.a.createElement(q.a,{value:h,onChange:function(e){v(e.target.value)},onBlur:function(){m(!1)},onKeyUp:function(e){13===e.which&&m(!1)}}):c.a.createElement(O.a,{variant:"body1",style:{cursor:"text"},onClick:function(){o||m(!0)}},h)),!o&&c.a.createElement(w.a,null,c.a.createElement(E.a,{onClick:function(){var t={id:Date.now(),title:"",description:"empty"};n&&n.cards.push(t),e.refreshBoard(r)}},c.a.createElement(D.b,null)),c.a.createElement(E.a,{onClick:function(){r.lanes=r.lanes.filter((function(e){return n.id!==e.id})),e.refreshBoard(r)}},c.a.createElement(D.f,null))))}function nt(e){var t=tt(e),a=e.board,n=e.card,r=e.isPreview,o=Object(i.useState)(null),l=Object(f.a)(o,2),s=l[0],u=l[1],d=c.a.useState(null),m=Object(f.a)(d,2),p=m[0],g=m[1],h=Object(i.useState)(null),v=Object(f.a)(h,2),O=v[0],k=v[1],j=Object(i.useState)(n.description),y=Object(f.a)(j,2),x=y[0],C=y[1],N=Object(i.useState)(!1),S=Object(f.a)(N,2),I=S[0],A=S[1];Object(b.b)().t;return Object(i.useEffect)((function(){C(n.description)}),[n.description]),Object(i.useEffect)((function(){if(s){var e=et.fromTextArea(s,{mode:{name:"hypermd",hashtag:!0},inputStyle:"textarea"});e.setValue(n.description),e.setOption("lineNumbers",!1),e.setOption("foldGutter",!1),e.setOption("autofocus",!1),r&&e.setOption("readOnly","nocursor"),e.on("changes",(function(){C(e.getValue())})),k(e)}}),[s]),Object(i.useEffect)((function(){p&&Object(de.renderPreview)(p,n.description)}),[p]),r||!I?c.a.createElement(T.a,{className:Object(P.a)(t.kanbanCard)},c.a.createElement("div",{className:Object(P.a)("preview",t.preview),ref:function(e){g(e)},onClick:function(){r||A(!0)}}),!r&&c.a.createElement(w.a,{style:{position:"absolute",top:"0",right:"0",zIndex:99}},c.a.createElement(E.a,{onClick:function(){a.lanes.forEach((function(e){e.cards=e.cards.filter((function(e){return e.id!==n.id}))})),e.refreshBoard(a)}},c.a.createElement(D.f,null)))):c.a.createElement(T.a,{className:Object(P.a)(t.kanbanCard)},c.a.createElement(Xe.a,null,c.a.createElement(w.a,{className:Object(P.a)(t.editorWrapper)},c.a.createElement("textarea",{className:t.textarea,ref:function(e){u(e)}})),x!==n.description&&c.a.createElement(w.a,null,c.a.createElement(E.a,{onClick:function(){n.description=x,e.refreshBoard(e.board),A(!1)}},c.a.createElement(D.j,null)),c.a.createElement(E.a,{onClick:function(){O&&O.setValue(n.description),C(n.description),A(!1)}},c.a.createElement(D.a,null)))))}function rt(e){tt(e),Object(b.b)().t;var t=Object(i.useState)(e.attributes.board||{lanes:[]}),a=Object(f.a)(t,2),n=a[0],r=a[1],o=function(t){var a=Object.assign({},t);e.setAttributes({board:a}),r(a)};return c.a.createElement("div",null,c.a.createElement(Ze.a,{renderLaneHeader:function(t){return c.a.createElement(at,{lane:t,board:n,refreshBoard:o,isPreview:e.isPreview})},renderCard:function(t,a){a.dragging;return c.a.createElement(nt,{card:t,board:n,refreshBoard:o,isPreview:e.isPreview})},allowAddLane:!e.isPreview,onNewLaneConfirm:function(e){n.lanes.push(Object(qe.a)({id:Date.now()},e)),o(n)},disableCardDrag:e.isPreview,disableLaneDrag:e.isPreview,onCardDragEnd:function(e,t,a){var r=t.fromPosition,i=t.fromLaneId,c=a.toPosition,l=a.toLaneId,s=n.lanes.filter((function(e){return e.id===i}))[0],u=n.lanes.filter((function(e){return e.id===l}))[0];s.cards.splice(r,1),u.cards=[].concat(Object(I.a)(u.cards.slice(0,c)),[e],Object(I.a)(u.cards.slice(c,u.cards.length))),o(n)},onLaneDragEnd:function(e,t){var a=e.fromPosition,r=t.toPosition,i=n.lanes[a],c=n.lanes[r];n.lanes[r]=i,n.lanes[a]=c,o(n)}},n))}var ot=a(265),it=a.n(ot),ct=(a(5441),Object(C.a)((function(e){return Object(N.a)({card:{padding:e.spacing(2),position:"relative"},editorWrapper:{position:"relative",padding:"2px"},editor:{width:"100%",height:"128px",resize:"none",border:"none"},canvas:{overflow:"auto !important",height:"100% !important"},saveBtn:{position:"absolute",top:"0",right:"0"}})})));function lt(e){var t=e.attributes,a=ct(e),n=(Object(b.b)().t,Object(i.useState)("abc-editor-"+F())),r=Object(f.a)(n,1)[0],o=Object(i.useState)("abc-warnings-"+F()),l=Object(f.a)(o,1)[0],s=Object(i.useState)("abc-canvas-"+F()),u=Object(f.a)(s,1)[0],d=Object(i.useState)("abc-audio-"+F()),m=Object(f.a)(d,1)[0],p=Object(i.useState)(null),g=Object(f.a)(p,2),h=g[0],v=g[1],O=Object(i.useState)(null),k=Object(f.a)(O,2),j=k[0],y=k[1],x=Object(i.useState)(null),C=Object(f.a)(x,2),N=C[0],S=C[1],I=Object(i.useState)(null),A=Object(f.a)(I,2),B=A[0],R=A[1],L=Object(i.useState)(e.isPreview),U=Object(f.a)(L,2),W=U[0],M=(U[1],Object(i.useState)(t.abc||"X: 1\nT: Cooley's\nM: 4/4\nL: 1/8\nK: Emin\n|:D2|EB{c}BA B2 EB|~B2 AB dBAG|FDAD BDAD|FDAD dAFD|")),_=Object(f.a)(M,2),$=_[0],G=_[1];return Object(i.useEffect)((function(){h&&j&&N&&B&&setTimeout((function(){new it.a.Editor(h.id,{canvas_id:N.id,warnings_id:j.id,generate_warnings:!0,synth:{el:"#".concat(B.id),options:{displayLoop:!0,displayRestart:!0,displayPlay:!0,displayProgress:!0,displayWarp:!0}},abcjsParams:{generateDownload:!0}})}),1e3)}),[h,j,N,B]),c.a.createElement(w.a,null,c.a.createElement(T.a,{elevation:2,className:Object(P.a)(a.editorWrapper),style:{display:W?"none":"block"}},c.a.createElement("textarea",{className:Object(P.a)(a.editor),id:r,ref:function(e){v(e)},value:$,onChange:function(e){G(e.target.value)},readOnly:e.isPreview}),!e.isPreview&&t.abc!==$&&c.a.createElement(E.a,{className:Object(P.a)(a.saveBtn),onClick:function(){e.setAttributes(Object.assign(e.attributes,{abc:$}))}},c.a.createElement(D.j,null))),c.a.createElement("div",{id:l,ref:function(e){y(e)}}),c.a.createElement("div",{id:u,className:Object(P.a)(a.canvas),ref:function(e){S(e)}}),c.a.createElement("div",{id:m,ref:function(e){R(e)}}))}window.CodeMirror=a(14),Object(Se.registerWidgetCreator)("crossnote.image",(function(e){var t=document.createElement("span");return s.a.render(c.a.createElement(Be,e),t),t})),Object(Se.registerWidgetCreator)("crossnote.audio",(function(e){var t=document.createElement("span");return s.a.render(c.a.createElement(Le,e),t),t})),Object(Se.registerWidgetCreator)("crossnote.netease_music",(function(e){var t=document.createElement("span");return s.a.render(c.a.createElement(Ue,e),t),t})),Object(Se.registerWidgetCreator)("crossnote.video",(function(e){var t=document.createElement("span");return s.a.render(c.a.createElement(Te,e),t),t})),Object(Se.registerWidgetCreator)("crossnote.bilibili",(function(e){var t=document.createElement("span");return s.a.render(c.a.createElement(_e,e),t),t})),Object(Se.registerWidgetCreator)("crossnote.youtube",(function(e){var t=document.createElement("span");return s.a.render(c.a.createElement(Ge,e),t),t})),Object(Se.registerWidgetCreator)("crossnote.ocr",(function(e){var t=document.createElement("span");return s.a.render(c.a.createElement(Ye,e),t),t})),Object(Se.registerWidgetCreator)("crossnote.kanban",(function(e){var t=document.createElement("span");return s.a.render(c.a.createElement(rt,e),t),t})),Object(Se.registerWidgetCreator)("crossnote.abc",(function(e){var t=document.createElement("span");return s.a.render(c.a.createElement(lt,e),t),t}));var st=Object(ye.a)({palette:{primary:xe.a,secondary:Ce.a}}),ut=function(){return Object(i.useEffect)((function(){var e=function(e){e.preventDefault(),e.prompt(),e.userChoice.then((function(e){console.log(e)}))};return window.addEventListener("beforeinstallprompt",e),function(){window.removeEventListener("beforeinstallprompt",e)}}),[]),c.a.createElement(Ne.a,{theme:st},c.a.createElement("div",{className:"App"},c.a.createElement(je,null)))},dt=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function mt(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var pt=a(47),bt=a(126),ft=a(155),gt=a(271),ht=function(){function e(t){Object(R.a)(this,e),this.fs=void 0,this.readFile=void 0,this.writeFile=void 0,this.readdir=void 0,this.unlink=void 0,this.stats=void 0,this.mkdir=void 0,this.exists=void 0,this.rename=void 0,this.rmdir=void 0,this.notebookDB=void 0,this.fs=t.fs,this.setUpFSMethods(),ft.a.plugin(gt.a),this.notebookDB=new ft.a("notebooks"),this.notebookDB.createIndex({index:{fields:["gitURL"]}})}return Object(L.a)(e,[{key:"setUpFSMethods",value:function(){var e=this;this.readFile=function(t){return new Promise((function(a,n){e.fs.readFile(t,(function(e,t){return e?n(e):a(t.toString())}))}))},this.writeFile=function(t,a){return new Promise((function(n,r){e.fs.writeFile(t,a,{encoding:"utf8"},(function(e){return e?r(e):n()}))}))},this.readdir=function(t){return new Promise((function(a,n){e.fs.readdir(t,(function(e,t){return e?n(e):a(t)}))}))},this.unlink=function(t){return new Promise((function(a,n){e.fs.unlink(t,(function(e){return e?n(e):a()}))}))},this.stats=function(t){return new Promise((function(a,n){e.fs.stat(t,(function(e,t){return e?n(e):a(t)}))}))},this.mkdir=function(t){return new Promise((function(a,n){e.fs.mkdir(t,"0777",(function(e){return e?n(e):a()}))}))},this.exists=function(t){return new Promise((function(a,n){e.fs.exists(t,(function(e){return a(e)}))}))},this.rename=function(t,a){return new Promise((function(n,r){e.fs.rename(t,a,(function(e){return e?r(e):n()}))}))};var t=function(t){return new Promise((function(a,n){e.fs.rmdir(t,(function(e){return e?n(e):a()}))}))};this.rmdir=function(){var a=Object(o.a)(r.a.mark((function a(n){var o,i,c,l;return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e.readdir(n);case 2:o=a.sent,i=0;case 4:if(!(i<o.length)){a.next=20;break}return c=o[i],l=B.resolve(n,c),a.next=9,e.stats(l);case 9:if(!a.sent.isDirectory()){a.next=15;break}return a.next=13,e.rmdir(l);case 13:a.next=17;break;case 15:return a.next=17,e.unlink(l);case 17:i++,a.next=4;break;case 20:return a.next=22,t(n);case 22:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()}},{key:"addNotebook",value:function(){var e=Object(o.a)(r.a.mark((function e(t){var a,n,o,i,c,l,s,u,d,m,p,b,f,g,h,v,w;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.name,n=void 0===a?"":a,o=t.corsProxy,i=t.gitURL,c=t.branch,l=void 0===c?"master":c,s=t.username,u=void 0===s?"":s,d=t.password,m=void 0===d?"":d,p=t.depth,b=void 0===p?3:p,f=t.rememberCredentials,g=void 0!==f&&f,!i){e.next=7;break}return e.next=4,this.cloneNotebook({name:n,corsProxy:o,gitURL:i,branch:l,username:u,password:m,depth:b,rememberCredentials:g});case 4:return e.abrupt("return",e.sent);case 7:return h=U(),v="/notebooks/".concat(h),w={_id:h,dir:v,name:n.trim()||"Unnamed",gitURL:i.trim(),gitBranch:l.trim(),gitCorsProxy:o.trim(),gitUsername:g?u.trim():"",gitPassword:g?m:""},e.next=12,this.exists("/notebooks");case 12:if(e.sent){e.next=15;break}return e.next=15,this.mkdir("/notebooks");case 15:return e.next=17,this.exists(v);case 17:if(e.sent){e.next=20;break}return e.next=20,this.mkdir(v);case 20:return e.next=22,pt.e({fs:this.fs,dir:v});case 22:return e.prev=22,e.next=25,this.notebookDB.put(w);case 25:e.next=31;break;case 27:return e.prev=27,e.t0=e.catch(22),e.next=31,this.rmdir(v);case 31:return e.abrupt("return",w);case 32:case"end":return e.stop()}}),e,this,[[22,27]])})));return function(t){return e.apply(this,arguments)}}()},{key:"cloneNotebook",value:function(){var e=Object(o.a)(r.a.mark((function e(t){var a,n,o,i,c,l,s,u,d,m,p,b,f,g,h,v,w;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.name,n=void 0===a?"":a,o=t.corsProxy,i=t.gitURL,c=t.branch,l=void 0===c?"master":c,s=t.username,u=void 0===s?"":s,d=t.password,m=void 0===d?"":d,p=t.depth,b=void 0===p?10:p,f=t.rememberCredentials,g=void 0!==f&&f,i.match(/^https?:\/\//)){e.next=3;break}throw new Error("error/invalid-git-url-prefix");case 3:return h=U(),v="/notebooks/".concat(h),e.next=7,pt.c({fs:this.fs,http:bt.a,dir:v,corsProxy:o,url:i,ref:l,depth:b,singleBranch:!0,onAuth:function(e,t){return{username:u,password:m}}});case 7:return w={_id:h,dir:v,name:n||this.getDefaultNotebookNameFromGitURL(i),gitURL:i,gitBranch:l,gitCorsProxy:o,gitUsername:g?u:"",gitPassword:g?m:""},e.prev=8,e.next=11,this.notebookDB.put(w);case 11:e.next=17;break;case 13:return e.prev=13,e.t0=e.catch(8),e.next=17,this.rmdir(v);case 17:return e.abrupt("return",w);case 18:case"end":return e.stop()}}),e,this,[[8,13]])})));return function(t){return e.apply(this,arguments)}}()},{key:"exportNotebookToJSON",value:function(){var e=Object(o.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return","");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"importNotebookFromJSON",value:function(){var e=Object(o.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return","");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteNotebook",value:function(){var e=Object(o.a)(r.a.mark((function e(t){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.notebookDB.get(t);case 2:return a=e.sent,e.next=5,this.rmdir(a.dir);case 5:return e.next=7,this.notebookDB.remove(a);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateNotebook",value:function(){var e=Object(o.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.notebookDB.put(t);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"changeNoteFilePath",value:function(){var e=Object(o.a)(r.a.mark((function e(t,a,n){var o,i,c,l,s;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=n.replace(/^\/+/,"")).endsWith(".md")||(n+=".md"),e.prev=2,e.next=5,pt.i({fs:this.fs,dir:t.dir,filepath:a.filePath});case 5:e.next=9;break;case 7:e.prev=7,e.t0=e.catch(2);case 9:o=B.dirname(B.resolve(t.dir,n)),i=o.split("/").slice(1),c=0;case 12:if(!(c<i.length)){e.next=23;break}for(l=["/"],s=0;s<=c;s++)l.push(i[s]);return e.next=17,this.exists(l.join("/"));case 17:if(e.sent){e.next=20;break}return e.next=20,this.mkdir(l.join("/"));case 20:c++,e.next=12;break;case 23:return e.next=25,this.rename(B.resolve(t.dir,a.filePath),B.resolve(t.dir,n));case 25:return e.next=27,pt.a({fs:this.fs,dir:t.dir,filepath:n});case 27:case"end":return e.stop()}}),e,this,[[2,7]])})));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"pushNotebook",value:function(){var e=Object(o.a)(r.a.mark((function e(t){var a,n,o,i,c,l,s,u,d,m,p,b,f,g,h,v;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.notebook,n=t.authorName,o=void 0===n?"crossnote":n,i=t.authorEmail,c=void 0===i?"anonymous@crossnote.com":i,l=t.username,s=t.password,u=t.message,d=void 0===u?"doc: Updated docs":u,m=t.onProgress,p=t.onMessage,b=t.onAuthFailure,f=t.onAuthSuccess,e.next=3,this.listFiles(a);case 3:if((g=e.sent).length){e.next=6;break}return e.abrupt("return",{ok:!0,error:null,refs:{}});case 6:return e.next=8,pt.d({fs:this.fs,dir:a.dir,author:{name:o,email:c},message:d});case 8:return e.sent,e.next=11,pt.h({fs:this.fs,http:bt.a,onAuth:function(e,t){return{username:l,password:s}},onProgress:function(e){m&&m(e)},onMessage:function(e){p&&p(e)},onAuthFailure:function(e,t){b&&b(e)},onAuthSuccess:function(e,t){f&&f(e)},url:a.gitURL,dir:a.dir,ref:a.gitBranch,corsProxy:a.gitCorsProxy});case 11:if(!(h=e.sent).ok){e.next=20;break}v=0;case 14:if(!(v<g.length)){e.next=20;break}return e.next=17,pt.i({fs:this.fs,dir:a.dir,filepath:g[v]});case 17:v++,e.next=14;break;case 20:return e.abrupt("return",h);case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"pullNotebook",value:function(){var e=Object(o.a)(r.a.mark((function e(t){var a,n,o,i,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.notebook,n=t.onProgress,o=t.onAuthFailure,i=t.onAuthSuccess,c=t.onMessage,e.next=3,pt.g({fs:this.fs,http:bt.a,dir:a.dir,singleBranch:!0,corsProxy:a.gitCorsProxy,ref:a.gitBranch,author:{name:"anonymous",email:"anonymous@crossnote.app"},onAuth:function(e,t){return{username:a.gitUsername,password:a.gitPassword}},onProgress:n,onAuthFailure:o,onAuthSuccess:i,onMessage:c});case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"checkoutNote",value:function(){var e=Object(o.a)(r.a.mark((function e(t){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,pt.b({fs:this.fs,dir:t.notebook.dir,filepaths:[t.filePath]});case 3:return e.next=5,pt.i({fs:this.fs,dir:t.notebook.dir,filepath:t.filePath});case 5:return e.next=7,this.getNote(t.notebook,t.filePath);case 7:return a=e.sent,e.abrupt("return",a);case 11:return e.prev=11,e.t0=e.catch(0),e.abrupt("return",null);case 14:case"end":return e.stop()}}),e,this,[[0,11]])})));return function(t){return e.apply(this,arguments)}}()},{key:"listNotebooks",value:function(){var e=Object(o.a)(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.notebookDB.find({selector:{gitURL:{$gt:null}}});case 2:return t=e.sent.docs,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"listFiles",value:function(){var e=Object(o.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,pt.f({fs:this.fs,dir:t.dir});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getNote",value:function(){var e=Object(o.a)(r.a.mark((function e(t,a,n){var o,i,c,l,s,u,d;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=B.resolve(t.dir,a),n){e.next=11;break}return e.prev=2,e.next=5,this.stats(o);case 5:n=e.sent,e.next=11;break;case 8:return e.prev=8,e.t0=e.catch(2),e.abrupt("return",null);case 11:if(!n.isFile()||!a.endsWith(".md")){e.next=23;break}return e.next=14,this.readFile(o);case 14:if(i=e.sent,c={id:"",createdAt:n.mtime,modifiedAt:n.mtime,tags:[]},l=i.trim().split("\n").filter((function(e){return e.length>0})),l[l.length-1].trim().match(/^<!--\s*note\s+/)){i=l.slice(0,l.length-1).join("\n"),s=l[l.length-1].replace(/^<!--\s*note\s+/,"").replace(/\s*-->$/,""),u={};try{(u=JSON.parse(s)).modifiedAt=new Date(u.modifiedAt||n.mtime),u.createdAt=new Date(u.createdAt||n.mtime)}catch(r){}c=Object.assign(c,u)}return d={notebook:t,filePath:B.relative(t.dir,o),title:$(i),markdown:i,config:c},e.abrupt("return",d);case 23:return e.abrupt("return",null);case 24:case"end":return e.stop()}}),e,this,[[2,8]])})));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"listNotes",value:function(){var e=Object(o.a)(r.a.mark((function e(t){var a,n,o,i,c,l,s,u,d,m,p,b;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.notebook,n=t.dir,o=void 0===n?"./":n,i=t.includeSubdirectories,c=void 0!==i&&i,l=[],s=[],e.prev=3,e.next=6,this.readdir(B.resolve(a.dir,o));case 6:s=e.sent,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),s=[];case 12:u=0;case 13:if(!(u<s.length)){e.next=32;break}return d=s[u],m=B.resolve(a.dir,o,d),e.next=18,this.stats(m);case 18:return p=e.sent,e.next=21,this.getNote(a,B.relative(a.dir,m),p);case 21:if((b=e.sent)&&l.push(b),!p.isDirectory()||".git"===d||!c){e.next=29;break}return e.t1=l,e.next=27,this.listNotes({notebook:a,dir:B.relative(a.dir,m),includeSubdirectories:c});case 27:e.t2=e.sent,l=e.t1.concat.call(e.t1,e.t2);case 29:u++,e.next=13;break;case 32:return e.abrupt("return",l);case 33:case"end":return e.stop()}}),e,this,[[3,9]])})));return function(t){return e.apply(this,arguments)}}()},{key:"writeNote",value:function(){var e=Object(o.a)(r.a.mark((function e(t,a,n,o){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o.modifiedAt=new Date,e.next=3,this.writeFile(B.resolve(t.dir,a),n+"\n\n\x3c!-- note ".concat(JSON.stringify(o),"--\x3e"));case 3:return e.next=5,pt.a({fs:this.fs,dir:t.dir,filepath:a});case 5:case"end":return e.stop()}}),e,this)})));return function(t,a,n,r){return e.apply(this,arguments)}}()},{key:"deleteNote",value:function(){var e=Object(o.a)(r.a.mark((function e(t,a){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.exists(B.resolve(t.dir,a));case 2:if(!e.sent){e.next=7;break}return e.next=5,pt.i({fs:this.fs,dir:t.dir,filepath:a});case 5:return e.next=7,this.unlink(B.resolve(t.dir,a));case 7:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"getNotebookDirectoriesFromNotes",value:function(){var e=Object(o.a)(r.a.mark((function e(t){var a,n,o;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a={name:".",path:".",children:[]},n=new Set([]),o=0;o<t.length;o++)n.add(B.dirname(t[o].filePath));return n.forEach((function(e){for(var t=e.split("/"),n=a,r=function(e){if("."===t[e])return"break";var a=n.children.filter((function(a){return a.name===t[e]}))[0];if(a)n=a;else{for(var r=[],o=0;o<=e;o++)r.push(t[o]);a={name:t[e],path:r.join("/"),children:[]},n.children.push(a),n=a}},o=0;o<t.length;o++){if("break"===r(o))break}})),e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getDefaultNotebookNameFromGitURL",value:function(e){var t=e.lastIndexOf("/");return e.slice(t+1).replace(/\.git/,"")}},{key:"getStatus",value:function(){var e=Object(o.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,pt.j({fs:this.fs,dir:t.notebook.dir,filepath:t.filePath});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();Object(u.configure)({fs:"IndexedDB",options:{}},function(){var e=Object(o.a)(r.a.mark((function e(t){var a,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=2;break}return e.abrupt("return",new m.a({type:"error",text:t.toString(),layout:"topRight",theme:"relax",timeout:2e3}).show());case 2:a=Object(u.BFSRequire)("fs");try{n=new ht({fs:a}),window.crossnote=n,s.a.render(c.a.createElement(W.Provider,{initialState:{crossnote:n}},c.a.createElement(ut,null)),document.getElementById("root"))}catch(t){console.log(t)}case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),function(e){if("serviceWorker"in navigator){if(new URL("/notehub",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/notehub","/service-worker.js");dt?(!function(e,t){fetch(e).then((function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):mt(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):mt(t,e)}))}}()}},[[5263,1,2]]]);
//# sourceMappingURL=main.a41c8580.chunk.js.map