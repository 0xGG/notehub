{"version":3,"sources":["i18n/i18n.ts","i18n/lang/enUS.ts","utilities/utils.ts","containers/crossnote.ts","utilities/note.ts","components/NoteCard.tsx","components/ConfigureNotebookDialog.tsx","components/Notes.tsx","components/PushNotebookDialog.tsx","components/Editor.tsx","components/AddNotebookDialog.tsx","components/NotebookTreeView.tsx","pages/Home.tsx","utilities/image_uploader.ts","editor/widgets/Image.tsx","editor/widgets/Audio.tsx","editor/widgets/NeteaseMusic.tsx","editor/widgets/Video.tsx","editor/widgets/Bilibili.tsx","editor/widgets/Youtube.tsx","editor/widgets/OCR.tsx","editor/widgets/Kanban.tsx","editor/widgets/ABC.tsx","editor/index.ts","App.tsx","serviceWorker.ts","lib/crossnote.ts","index.tsx"],"names":["i18next","use","initReactI18next","init","interpolation","escapeValue","keySeparator","lng","localStorage","getItem","fallbackLng","resources","translation","Editor","EDITOR","Viewer","VIEWER","Admin","ADMIN","ARCHIVED","DELETED","PINNED","OTHERS","BOOKMARKS","generateUUID","d","Date","getTime","d2","performance","now","replace","c","r","Math","random","floor","toString","cache","s","n","split","reduce","a","b","charCodeAt","x","abs","parseFloat","key","this","color","hashCode","randomID","substr","CrossnoteContainer","createContainer","initialState","useTranslation","t","crossnote","useState","notebooks","setNotebooks","selectedNotebook","setSelectedNotebook","notebookNotes","setNotebookNotes","name","path","children","notebookDirectories","setNotebookDirectories","notes","setNotes","selectedNote","setSelectedNote","includeSubdirectories","setIncludeSubdirectories","selectedDir","setSelectedDir","isAddingNotebook","setIsAddingNotebook","isPushingNotebook","setIsPushingNotebook","isPullingNotebook","setIsPullingNotebook","displayMobileEditor","setDisplayMobileEditor","updateNoteMarkdown","useCallback","note","markdown","callback","map","filePath","writeNote","notebook","config","then","getStatus","status","deleteNote","newNotes","filter","length","getNotebookDirectoriesFromNotes","directories","changeNoteFilePath","newFilePath","modifiedAt","createNewNote","fileName","endsWith","dir","noteConfig","id","tags","createdAt","title","addNotebook","gitURL","gitBranch","gitUsername","gitPassword","gitRememberCredentials","gitCorsProxy","branch","username","password","corsProxy","rememberCredentials","updateNotebook","deleteNotebook","_id","pushNotebook","args","pullNotebook","listNotes","sort","find","checkoutNote","newNote","useEffect","listNotebooks","match","indexOf","getHeaderFromMarkdown","titleMatch","trim","coverImage","images","contentString","aheadString","slice","coverMatch","push","coverImagesMatch","forEach","mdImage","image","index","self","findIndex","m","summary","join","html","hasMoreContent","video","useStyles","makeStyles","theme","createStyles","noteCard","width","display","flexDirection","alignItems","padding","spacing","textAlign","cursor","selected","borderLeft","palette","primary","main","unselected","leftPanel","paddingLeft","duration","text","secondary","rightPanel","flex","borderBottom","header","marginBottom","paddingRight","lineHeight","textOverflow","overflow","maxWidth","maxHeight","wordBreak","NoteCard","props","classes","crossnoteContainer","useContainer","setHeader","setSummary","formatDistanceStrict","generateSummaryFromMarkdown","catch","error","ButtonBase","className","clsx","onClick","Box","Typography","style","fontWeight","variant","ConfigureNotebookDialog","notebookName","setNotebookName","expanded","setExpanded","setGitURL","setGitBranch","setGitUsername","setGitPassword","setGitCorsProxy","clickDeleteCount","setClickDeleteCount","rememberCredentialsChecked","setRememberCredentialsChecked","onClose","Dialog","open","DialogTitle","DialogContent","TextField","label","value","fullWidth","onChange","event","target","ExpansionPanel","elevation","ExpansionPanelSummary","expandIcon","ExpansionPanelDetails","placeholder","disabled","type","FormControlLabel","control","Checkbox","checked","Link","href","DialogActions","Button","height","topPanel","row","sectionName","marginLeft","search","position","borderRadius","shape","backgroundColor","fade","common","white","marginRight","breakpoints","up","searchIcon","pointerEvents","justifyContent","inputRoot","border","inputInput","transition","transitions","create","notesList","overflowY","paddingBottom","Notes","searchValue","setSearchValue","notebookConfigurationDialogOpen","setNotebookConfigurationDialogOpen","Card","Hidden","smUp","implementation","IconButton","toggleDrawer","InputBase","root","input","inputProps","role","aria-label","regexp","RegExp","PushNotebookDialog","authorName","setAuthorName","authorEmail","setAuthorEmail","commitMessage","setCommitMessage","message","onAuthFailure","Noty","layout","timeout","show","console","log","setItem","EditorMode","VickyMD","require","editorPanel","bottomPanel","borderTop","controlBtn","controlBtnSelected","cursorPositionInfo","zIndex","editorWrapper","down","fullScreen","left","top","editor","preview","backBtn","textAreaElement","setTextAreaElement","setEditor","line","ch","cursorPosition","setCursorPosition","deleteDialogOpen","setDeleteDialogOpen","filePathDialogOpen","setFilePathDialogOpen","pushDialogOpen","setPushDialogOpen","setNewFilePath","editorMode","setEditorMode","previewElement","setPreviewElement","gitStatus","setGitStatus","fullScreenMode","setFullScreenMode","closeFilePathDialog","changeFilePath","fromTextArea","mode","hashtag","inputStyle","setOption","setValue","on","instance","getCursor","handler","getValue","off","switchToHyperMD","getWrapperElement","SourceCode","switchToNormal","Preview","renderPreview","childElementCount","tagName","toUpperCase","ButtonGroup","Tooltip","ref","element","right","DialogContentText","autoFocus","onKeyUp","which","AddNotebookDialog","canCancel","treeItemRoot","treeItemContent","userSelect","typography","fontWeightMedium","fontWeightRegular","treeItemGroup","treeItemExpanded","treeItemLabel","treeItemLabelRoot","treeItemLabelIcon","treeItemLabelText","flexGrow","NotebookTreeView","handleChange","nodes","stopPropagation","TreeView","defaultExpandIcon","disableFocusRipple","disableRipple","size","defaultCollapseIcon","defaultEndIcon","onNodeToggle","TreeItem","nodeId","content","group","constructDirectoryTreeItems","directory","endIcon","page","appBar","drawer","boxShadow","toolBar","displayNone","flexShrink","drawerPaper","selectedSection","menuButton","mainPanel","notesPanel","toolBarSpace","mixins","toolbar","Home","addNotebookDialogOpen","setAddNotebookDialogOpen","drawerOpen","setDrawerOpen","List","disablePadding","ListItem","disableGutters","Paper","CssBaseline","Drawer","paper","ModalProps","keepMounted","xsDown","files","promises","i","file","Promise","resolve","reject","data","FormData","append","fetch","method","headers","referrer","body","response","json","all","card","actionButtons","section","marginTop","dropArea","ImageWidget","link","setLink","asCover","setAsCover","imageUploaderElement","setImageUploaderElement","uploadingImages","setUploadingImages","isPreview","removeSelf","Switch","Input","margin","onKeyDown","replaceSelf","e","preventDefault","onchange","smmsUploadImages","urls","url","click","multiple","AudioWidget","attributes","source","setSource","autoplay","setAutoplay","controls","setControls","loop","setLoop","muted","setMuted","autoPlay","src","attrs","JSON","stringify","NeteaseMusicWidget","setID","videoWrapper","paddingTop","VideoWidget","poster","setPoster","errorMessage","BilibiliWidget","setURL","setError","scrolling","frameBorder","allowFullScreen","aid","YoutubeWidget","videoID","canvasWrapper","canvas","OCRWidget","setCanvas","imageDataURL","setImageDataURL","ocrDataURL","setOCRDataURL","imageDropAreaElement","setImageDropAreaElement","isProcessing","setIsProcessing","ocrProgresses","setOCRProgresses","parse","getInitialLanguages","selectedLanguages","setSelectedLanguages","grayscaleChecked","setGrayscaleChecked","toggleLanguage","lang","offset","splice","imageObject","Image","context","getContext","onload","clearRect","fillStyle","fillRect","globalCompositeOperation","drawImage","toDataURL","onerror","setAttribute","ListItemText","ListItemSecondaryAction","progress","FormGroup","removeItem","worker","createWorker","logger","languagesArr","load","loadLanguage","initialize","recognize","terminate","ocr","startOCRFromLink","reader","FileReader","readAsDataURL","result","laneHeader","kanbanCard","textarea","KanbanLaneHeaderDisplay","lane","board","refreshBoard","clickedTitle","setClickedTitle","titleValue","setTitleValue","onBlur","description","cards","lanes","l","KanbanCardDisplay","React","setDescription","clickedPreview","setClickedPreview","CardContent","KanbanWidget","setBoard","newBoard","Object","assign","setAttributes","renderLaneHeader","renderCard","dragging","allowAddLane","onNewLaneConfirm","newLane","disableCardDrag","disableLaneDrag","onCardDragEnd","destination","fromPosition","fromLaneId","toPosition","toLaneId","fromLane","toLane","onLaneDragEnd","resize","saveBtn","ABCWidget","abcEditorID","abcWarningsID","abcCanvasID","abcAudioID","editorElement","setEditorElement","warningsElement","setWarningsElement","canvasElement","setCanvasElement","audioControlElement","setAudioControlElement","hideEditor","abc","setABC","setTimeout","abcjs","canvas_id","warnings_id","generate_warnings","synth","el","options","displayLoop","displayRestart","displayPlay","displayProgress","displayWarp","abcjsParams","generateDownload","readOnly","window","registerWidgetCreator","document","createElement","ReactDOM","render","createMuiTheme","blue","orange","App","prompt","userChoice","choiceResult","addEventListener","removeEventListener","ThemeProvider","isLocalhost","Boolean","location","hostname","registerValidSW","swUrl","navigator","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","state","controller","onUpdate","onSuccess","Crossnote","fs","readFile","writeFile","readdir","unlink","stats","mkdir","exists","rename","rmdir","notebookDB","setUpFSMethods","PouchDB","plugin","PouchdbFind","createIndex","fields","encoding","stat","oldPath","newPath","dirPath","isDirectory","depth","cloneNotebook","git","put","Error","http","singleBranch","onAuth","auth","getDefaultNotebookNameFromGitURL","notebookID","get","remove","filepath","newDirPath","dirNames","paths","j","onProgress","onMessage","onAuthSuccess","listFiles","stagedFiles","ok","refs","author","email","pushResult","filepaths","getNote","selector","$gt","docs","absFilePath","isFile","mtime","lines","configStr","concat","rootDirectory","filePaths","Set","add","subDirectory","lastIndexOf","BFSConfigure","BFSRequire","Provider","getElementById","URL","process","origin","contentType","ready","unregister","reload","checkValidServiceWorker"],"mappings":"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","file":"static/js/main.a41c8580.chunk.js","sourcesContent":["import i18next from \"i18next\";\nimport { initReactI18next } from \"react-i18next\";\nimport { zhCN, enUS, zhTW, ja } from \"date-fns/locale\";\nimport { enUS as enUSLanguage } from \"./lang/enUS\";\n// import { zhCN as zhCNLanguage } from \"./lang/zhCN\";\n// import { zhTW as zhTWLanguage } from \"./lang/zhTW\";\n// import { jaJP as jaJPLanguage } from \"./lang/jaJP\";\n\ni18next.use(initReactI18next).init({\n  interpolation: {\n    // React already does escaping\n    escapeValue: false\n  },\n  keySeparator: false, // we do not use keys in form messages.welcome\n  lng: localStorage.getItem(\"language\") || \"en-US\", // \"en-US\" | \"zh-CN\"\n  fallbackLng: \"en-US\",\n  resources: {\n    \"en-US\": enUSLanguage\n    // TODO: Support other languages\n    // \"zh-CN\": zhCNLanguage,\n    // \"zh-TW\": zhTWLanguage,\n    // \"ja-JP\": jaJPLanguage\n  }\n});\n\nexport default i18next;\n\nexport function languageCodeToLanguageName(code: string) {\n  if (code === \"zh-CN\") {\n    return \"简体中文\";\n  } else if (code === \"zh-TW\") {\n    return \"繁体中文\";\n  } else if (code === \"ja-JP\") {\n    return \"日本語\";\n  } else {\n    return \"English\";\n  }\n}\n\nexport function languageCodeToDateFNSLocale(code: string) {\n  if (code === \"zh-CN\") {\n    return zhCN;\n  } else if (code === \"en-US\") {\n    return enUS;\n  } else if (code === \"zh-HK\") {\n    return zhTW;\n  } else if (code === \"ja-JP\") {\n    return ja;\n  } else {\n    return enUS;\n  }\n}\n","export const enUS = {\n  translation: {\n    \"title/Crossnote\": \"Crossnote\",\n    \"search/placeholder\": \"Search Notes\",\n\n    // Account\n    \"account/Anonymous\": \"Anonymous\",\n    \"account/anonymous\": \"anonymous\",\n\n    // General\n    \"general/go-back\": \"Go back\",\n    \"general/sending\": \"Sending\",\n    \"general/send\": \"Send\",\n    \"general/cancel\": \"Cancel\",\n    \"general/backed-up-at\": \"Backed up at\",\n    \"general/created-at\": \"Created at\",\n    \"general/modified-at\": \"Modified at\",\n    \"general/interacted-at\": \"Interacted at\",\n    \"general/date-created\": \"Date created\",\n    \"general/date-modified\": \"Date modified\",\n    \"general/date-interacted\": \"Date interacted\",\n    \"general/saved-at\": \"Saved at\",\n    \"general/loading\": \"Loading ...\",\n    \"general/loading-notifications\": \"Loading notifications ...\",\n    \"general/failed-to-set\": \"Failed to set\",\n    \"general/update\": \"Update\",\n    \"general/updated\": \"Updated\",\n    \"general/updating\": \"Updating\",\n    \"general/close\": \"Close\",\n    \"general/Note\": \"Note\",\n    \"general/notes\": \"notes\",\n    \"general/Settings\": \"Settings\",\n    \"general/Collaborators\": \"Collaborators\",\n    \"general/collaborators\": \"collaborators\",\n    \"general/Backups\": \"Backups\",\n    \"general/backups\": \"backups\",\n    \"general/Discussion\": \"Discussion\",\n    \"general/discussion\": \"discussion\",\n    \"general/Notifications\": \"Notifications\",\n    \"general/Username\": \"Username\",\n    \"general/Email\": \"Email\",\n    \"general/Password\": \"Password\",\n    \"general/confirm-password\": \"Confirm password\",\n    \"general/Continue\": \"Continue\",\n    \"general/enter-username\": \"Enter username\",\n    \"general/vickymd\": \"VickyMD\",\n    \"general/tags\": \"Tags\",\n    \"general/add-a-tag\": \"Add a tag\",\n    \"general/private\": \"Private\",\n    \"general/public\": \"Public\",\n    \"general/friends-only\": \"Friends only\",\n    \"general/anonymous\": \"Anonymous\",\n    \"general/onymous\": \"Onymous\",\n    \"general/Tag\": \"Tag\",\n    \"general/no-tags\": \"No tags\",\n    \"general/Untitled\": \"Untitled\",\n    \"general/untitled\": \"untitled\",\n    \"general/Unknown\": \"Unknown\",\n    \"general/unknown\": \"unknown\",\n    \"general/Agree\": \"Agree\",\n    \"general/Disagree\": \"Disagree\",\n    \"general/Print\": \"Print\",\n    Editor: \"Editor\",\n    EDITOR: \"EDITOR\",\n    Viewer: \"Viewer\",\n    VIEWER: \"VIEWER\",\n    Admin: \"Admin\",\n    ADMIN: \"ADMIN\",\n    ARCHIVED: \"ARCHIVED\",\n    \"ATTACHED NOTES\": \"ATTACHED NOTES\",\n    DELETED: \"DELETED\",\n    PINNED: \"PINNED\",\n    OTHERS: \"OTHERS\",\n    \"PUBLIC NOTES\": \"PUBLIC NOTES\",\n    \"FOLLOWINGS' NOTES\": \"FOLLOWINGS' NOTES\",\n    \"SHARED WITH ME\": \"SHARED WITH ME\",\n    BOOKMARKS: \"BOOKMARKS\",\n    \"MY TAGS\": \"MY TAGS\",\n    \"general/enter-fullscreen-mode\": \"Enter fullscreen mode\",\n    \"general/enter-presentation-mode\": \"Enter presentation mode\",\n    \"general/math-preview\": \"Math Preview\",\n    \"general/this-note-is-empty\": \"This note is empty\",\n    \"general/no-notes-found\": \"No notes found\",\n    \"general/no-notifications-found\": \"No notifications found\",\n    \"general/clear-all\": \"Clear all\",\n    \"general/Save\": \"Save\",\n    \"general/Delete\": \"Delete\",\n    \"general/Follow\": \"Follow\",\n    \"general/Following\": \"Following\",\n    \"general/Unfollow\": \"Unfollow\",\n    \"general/my-notes\": \"My notes\",\n    \"general/public-notes\": \"Public notes\",\n    \"general/followings-notes\": \"Followings' notes\",\n    \"general/shared-with-me\": \"Shared with me\",\n    \"general/Bookmarks\": \"Bookmarks\",\n    \"general/Archive\": \"Archive\",\n    \"general/Trash\": \"Trash\",\n    \"general/new-note\": \"New note\",\n    \"general/profile-updated\": \"Profile updated\",\n    \"general/ID\": \"ID\",\n    \"general/Audio\": \"Audio\",\n    \"general/Video\": \"Video\",\n    \"general/source-url\": \"Source URL\",\n    \"general/sign-in\": \"Sign in\",\n    \"general/sign-up\": \"Sign up\",\n    \"general/Link\": \"Link\",\n    \"general/Upload\": \"Upload\",\n    \"general/clicks\": \"clicks\",\n    \"general/Processing\": \"Processing...\",\n    \"general/please-wait\": \"please wait...\",\n    \"general/Languages\": \"Languages\",\n    \"general/track\": \"Track\",\n    \"general/Publish\": \"Publish\",\n\n    // Note\n    \"note/unarchive-note\": \"Unarchive note\",\n    \"note/archive-note\": \"Archive note\",\n    \"note/delete-forever\": \"Delete forever\",\n    \"note/delete-note\": \"Delete note\",\n    \"note/restore-note\": \"Restore note\",\n    \"note/report-note\": \"Report note\",\n    \"note/open-in-crossnote-website\": \"Open in Crossnote website\",\n\n    // NoteTags\n    \"note-tags/send-suggestion-failure\": \"Failed to send suggestion\",\n    \"note-tags/suggestion-sent\": \"Suggestion sent\",\n    \"note-tags/suggest-a-tag-to-this-note\": \"Suggest a tag to this note\",\n\n    // UserTags\n    \"user-tags/follow-a-tag\": \"Follow a tag\",\n\n    // ChatMessage\n    \"chat-message/reply-to-this-user\": \"Reply to this user\",\n    \"chat-message/add-reaction-to-this-message\": \"Add reaction to this message\",\n    \"chat-message/edit-this-message\": \"Edit this message\",\n    \"chat-message/modified-message\": \"modified message\",\n\n    // ChatPanel\n    \"chat-panel/post-message-failure\": \"Failed to post message\",\n    \"chat-panel/unsubscribe-info\":\n      \"Unsubscribing from this chat group will stop you from receiving notifications unless someone mentions you\",\n    \"chat-panel/subscribe-info\":\n      \"Subscribing to this chat group will let you receive notifications whenever someone posts a message\",\n\n    // Notifications\n    \"notifications/refresh\": \"Refresh to see new notifications\",\n\n    // Settings\n    \"settings/about-this-project\": \"About this project 🤔\",\n    \"settings/uploading-cover-image\": \"Uploading cover image\",\n    \"settings/upload-image-failure\": \"Failed to upload image\",\n    \"settings/Cover\": \"Cover\",\n    \"settings/enter-cover-image-url\": \"Enter cover image URL\",\n    \"settings/upload-image\": \"Upload image\",\n    \"settings/Avatar\": \"Avatar\",\n    \"settings/enter-avatar-image-url\": \"Enter avatar image URL\",\n    \"settings/Name\": \"Name\",\n    \"settings/enter-name\": \"Enter your Name (this is not your username)\",\n    \"settings/editor-cursor-color\": \"Editor cursor color\",\n    \"settings/hello\": \"Hello, \",\n    \"settings/world\": \"world!\",\n    \"settings/linked-with-github-account\": \"Linked with GitHub account\",\n    \"settings/link-with-github-account\": \"Link with GitHub account\",\n    \"settings/log-out\": \"Log out\",\n\n    // Preview\n    \"preview/attach-a-note\": \"Attach a note\",\n    \"preview/crossnote-untitled\": \"Crossnote - Untitled\",\n    \"preview/edit-this-note\": \"Edit this note\",\n\n    // ProfileCard\n    \"profile-card/followings\": \"followings\",\n    \"profile-card/followers\": \"followers\",\n    \"profile-card/Followings\": \"Followings\",\n    \"profile-card/Followers\": \"Followers\",\n    \"profile-card/notes\": \"notes\",\n    \"profile-card/follow-user-failure\": \"Failed to follow user\",\n    \"profile-card/followed-user\": \"Followed user\",\n    \"profile-card/unfollow-user-failure\": \"Failed to unfollow user\",\n    \"profile-card/unfollowed-user\": \"Unfollowed user\",\n\n    // TagCard\n    \"tag-card/pin-to-my-notes-page\": \"Pin to my notes page\",\n\n    // Interaction panel\n    \"interaction-panel/show-attached-notes\": \"Show attached notes\",\n    \"interaction-panel/add-comment\": \"Add comment\",\n    \"interaction-panel/add-reaction\": \"Add reaction\",\n\n    // Editor\n    \"editor/loading-your-note\": \"Loading your note...\",\n    \"editor/sync-failure\": \"Failed to sync... Please refresh your page\",\n    \"editor/saving\": \"Saving...\",\n    \"editor/save-failure\": \"Failed to save\",\n    \"editor/saved\": \"Saved\",\n    \"editor/update-note-failure\": \"Failed to update note\",\n\n    // * NoteControl\n    \"editor/note-control/allow-readers-to-suggest-note-tags\":\n      \"Allow readers to suggest note tags\",\n    \"editor/note-control/allow-readers-to-attach-notes-under-this-note\":\n      \"Allow readers to attach notes under this note\",\n    \"editor/note-control/inherit-parent-note-collaborators-list\":\n      \"Inherit parent note collaborators list\",\n    \"editor/note-control/note-visibility-hint\":\n      \"All collaborators will be able to see this note\",\n    \"editor/note-control/allow-readers-to-attach-notes-unchecked\":\n      \"Applies to you and collaborators that can edit and admin\",\n    \"editor/note-control/allow-readers-to-attach-notes-checked\":\n      \"Applies to anyone that can view this note\",\n    \"editor/note-control/enter-parent-note-id\": \"Enter parent note ID\",\n    \"editor/note-control/attach-note-failure\": \"Failed to attach note\",\n    \"editor/note-control/unattach-note-failure\": \"Failed to unattach note\",\n    \"editor/collaborator-hint\": \" - note will be visible to them\",\n    \"editor/shareable-link-hint\":\n      \"people with the link can view/edit this note with no need of login\",\n\n    // * BackupsControl\n    \"editor/backups-control/create-backup\": \"Create backup\",\n    \"editor/backups-control/delete-this-backup\": \"Delete this backup\",\n    \"editor/backups-control/create-backup-failure\": \"Failed to create backup\",\n    \"editor/backups-control/backup-created\": \"Backup created\",\n    \"editor/backups-control/delete-backup-failure\": \"Failed to delete backup\",\n    \"editor/backups-control/backup-deleted\": \"Backup deleted\",\n    \"editor/backups-control/cloud-version\": \"Cloud version\",\n    \"editor/backups-control/backup-name\": \"Backup name\",\n\n    // * CollaboratorasControl\n    \"editor/collaborators-control/set-collaborator-role-failure\":\n      \"Failed to set collaborator role\",\n    \"editor/collaborators-control/add-collaborator-failure\":\n      \"Failed to add collaborator\",\n    \"editor/collaborators-control/collaborator-removed\": \"Collaborator removed\",\n    \"editor/collaborators-control/collaborator-added\": \"Collaborator added\",\n    \"editor/collaborators-control/can-view\": \"Can view\",\n    \"editor/collaborators-control/can-edit\": \"Can edit\",\n    \"editor/collaborators-control/can-administrate\": \"Can administrate\",\n\n    // * EditorToolBar\n    \"editor/toolbar/insert-image\": \"Insert image\",\n    \"editor/toolbar/upload-local-images\": \"Upload local images\",\n    \"editor/toolbar/capture-webpage\": \"Capture the whole webpage\",\n    \"editor/toolbar/insert-clock\": \"Insert clock\",\n    \"editor/toolbar/insert-emoji\": \"Insert emoji\",\n    \"editor/toolbar/insert-media\": \"Insert media\",\n    \"editor/toolbar/audio-url\": \"Audio URL\",\n    \"editor/toolbar/netease-music\": \"Netease Music\",\n    \"editor/toolbar/video-url\": \"Video URL\",\n    \"editor/toolbar/youtube\": \"Youtube\",\n    \"editor/toolbar/bilibili\": \"Bilibili\",\n    \"editor/toolbar/insert-slide\": \"Insert slide\",\n    \"editor/toolbar/insert-ocr\": \"Insert OCR\",\n    \"editor/toolbar/insert-kanban\": \"Insert Kanban\",\n    \"editor/toolbar/insert-abc-notation\": \"Insert ABC notation\",\n    \"editor/toolbar/insert-header-1\": \"Insert header 1\",\n    \"editor/toolbar/insert-header-2\": \"Insert header 2\",\n    \"editor/toolbar/insert-header-3\": \"Insert header 3\",\n    \"editor/toolbar/bold\": \"Bold\",\n    \"editor/toolbar/italic\": \"Italic\",\n    \"editor/toolbar/strikethrough\": \"Strikethrough\",\n    \"editor/toolbar/insert-inline-code\": \"Insert inline code\",\n    \"editor/toolbar/insert-blockquote\": \"Insert blockquote\",\n    \"editor/toolbar/insert-unordered-list\": \"Insert unordered list\",\n    \"editor/toolbar/insert-ordered-list\": \"Insert ordered list\",\n    \"editor/toolbar/insert-link\": \"Insert link\",\n    \"editor/toolbar/insert-table\": \"Insert table\",\n\n    // * NoteControl\n    \"editor/note-control/tag-added\": \"Tag added\",\n    \"editor/note-control/tag-deleted\": \"Tag deleted\",\n    \"editor/note-control/set-note-visibility-failure\":\n      \"Failed to set note visibility\",\n    \"editor/note-control/note-visibility-updated\": \"Note visibility updated\",\n    \"editor/note-control/set-author-visibility-failure\":\n      \"Failed to set author visibility\",\n    \"editor/note-control/author-visibility-updated\":\n      \"Author visibility updated\",\n    \"editor/note-control/editor-mode\": \"Editor mode\",\n    \"editor/note-control/source-code\": \"Source code\",\n    \"editor/note-control/preview\": \"Preview\",\n    \"editor/note-control/pin-preview\": \"Pin preview on the side\",\n    \"editor/note-control/display-modification-records\":\n      \"Display modification records\",\n    \"editor/note-control/note-visibility\": \"Note visibility\",\n    \"editor/note-control/author-visibility\": \"Author visibility\",\n    \"editor/note-control/shareable-link\": \"Shareable link\",\n    \"editor/note-control/copy-to-clipboard\": \"Copy to clipboard\",\n    \"editor/note-control/link-to-preview\": \"Link to preview\",\n    \"editor/note-control/link-to-editor\": \"Link to editor\",\n    \"editor/note-control/attach-to-note\": \"Attach to note\",\n    \"editor/note-control/source-added\": \"URL added\",\n    \"editor/note-control/source-deleted\": \"URL deleted\",\n    \"editor/note-control/invalid-note-source\": \"Invalid URL\",\n    \"editor/note-control/add-note-source\": \"Add related URLs\",\n    \"editor/note-control/note-source-hint\":\n      \"Notes on the same URL will be grouped together\",\n    \"editor/note-control/enter-note-source\": \"Enter URL\",\n\n    // AvatarPanel\n    \"avatar-panel/this-note-is-private\": \"This note is private\",\n    \"avatar-panel/this-note-is-public\": \"This note is visible to public\",\n    \"avatar-panel/this-note-is-friends-only\":\n      \"This note is only visible to friends\",\n    \"avatar-panel/you-are-anonymous\": \"You are anonymous\",\n\n    // FileExporter\n    \"file-exporter/name\": \"File exporter\",\n    \"file-exporter/orientation\": \"Orientation\",\n    \"file-exporter/portrait\": \"portrait\",\n    \"file-exporter/landscape\": \"landscape\",\n    \"file-exporter/paper-size\": \"Paper size\",\n    \"file-exporter/unit\": \"Unit\",\n    \"file-exporter/margin-top\": \"Margin top\",\n    \"file-exporter/margin-bottom\": \"Margin bottom\",\n    \"file-exporter/margin-left\": \"Margin left\",\n    \"file-exporter/margin-right\": \"Margin right\",\n\n    // Utils\n    \"utils/uploading-image\": \"Uploading image...\",\n    \"utils/upload-image-failure\": \"Failed to upload image\",\n\n    // Notification\n    // * CommentPostingNotification\n    \"notification/replies-to-you-in\": \"Replies to you in\",\n    \"notification/'s-note\": \"'s note \",\n    // * NoteReactionNotification\n    \"notification/added\": \"Added\",\n    \"notification/to-your-note\": \"to your note\",\n    \"notification/add-you-as\": \"Added you as\",\n    \"notification/of-note\": \"of note\",\n    // * NoteTagSuggestion\n    \"notification/add-tag-failure\": \"Failed to add tag\",\n    \"notification/suggested-to-add-tag\": \"Suggested to add tag\",\n    // * UserFollowingNotification\n    \"notification/started-following-you\": \"Started following you\",\n    // * BookmarkNotification\n    \"notification/bookmarked-your-note\": \"Bookmarked your note\",\n\n    // GitHubOAuthCallback\n    \"github-oauth/wait\": \"Please wait ...\",\n    \"github-oauth/link-with-github-account-failure\":\n      \"Failed to link with GitHub account\",\n    \"github-oauth/sign-in-with-github-account-failure\":\n      \"Failed to sign in with GitHub account\",\n    \"github-oauth/first-time-sign-in\":\n      \"It seems to be the first time you sign in with GitHub account\",\n    \"github-oauth/first-time-sign-in-small\":\n      \"Please finish the registeration below\",\n\n    // Widgets\n    \"widget/autoplay\": \"autoplay\",\n    \"widget/controls\": \"controls\",\n    \"widget/loop\": \"loop\",\n    \"widget/muted\": \"muted\",\n    \"widget/crossnote.image/thanks_sm_ms\":\n      \"Thanks sm.ms for offering free image hosting service.\",\n    \"widget/crossnote.audio/audio_element_fail\":\n      \"Your browser does not support the audio element.\",\n    \"widget/crossnote.audio/source-url-placeholder\":\n      \"Enter audio source URL here, then press 'Enter' to insert.\",\n    \"widget/crossnote.video/video_element_fail\":\n      \"Your browser does not support the video element\",\n    \"widget/crossnote.bilibili/error_message\":\n      \"Error: Only supported https://www.bilibili.com/video/av79126732 like URL\",\n    \"widget/crossnote.youtube/error_message\":\n      \"Error: Only supported https://www.youtube.com/watch?v=MmB9b5njVbA like URL\",\n    \"widget/crossnote.auth/welcome\": \"Welcome to crossnote\",\n    \"widget/crossnote.auth/doesnt-have-account\":\n      \"Doesn't have an account? Let's create one 😉!\",\n    \"widget/crossnote.auth/forgot_password\": \"Forgot your password 😣?\",\n    \"widget/crossnote.auth/failed_to_send_code\":\n      \"Failed to send verification code\",\n    \"widget/crossnote.auth/verification_code_sent\":\n      \"Verification code has been sent to \",\n    \"widget/crossnote.auth/failed_to_reset_password\":\n      \"Failed to reset password\",\n    \"widget/crossnote.auth/password_reset\": \"Your password has been reset\",\n    \"widget/crossnote.auth/password-mismatch\": \"Passwords mismatch\",\n    \"widget/crossnote.auth/hello\": \"Hello, \",\n    \"widget/crossnote.auth/enter-the-verification-code\":\n      \"Enter the verification code\",\n    \"widget/crossnote.auth/get-code\": \"Get code\",\n    \"widget/crossnote.auth/sign-in-with-github-account\":\n      \"Sign in with GitHub account\",\n    \"widget/crossnote.auth/already-have-an-account\": \"Already have an account?\",\n    \"widget/crossnote.auth/reset-password\": \"Reset password\",\n    \"widget/crossnote.auth/Or\": \"Or\",\n    \"widget/crossnote.bilibili/Bilibili\": \"Bilibili\",\n    \"widget/crossnote.bilibili/bilibili-video-url\": \"Bilibili video URL\",\n    \"widget/crossnote.bilibili/url-placeholder\":\n      \"Enter the Bilibili video URL here, then press 'Enter' to insert.\",\n    \"widget/crossnote.image/image-helper\": \"Image helper\",\n    \"widget/crossnote.image/set-as-cover-image-in-note-card\":\n      \"Set as cover image in note card\",\n    \"widget/crossnote.image/image-url-placeholder\":\n      \"Enter image URL here, then press 'Enter' to insert.\",\n    \"widget/crossnote.image/click-here-to-browse-image-file\":\n      \"Click here to browse image file\",\n    \"widget/crossnote.neteasemusic/song-id-placeholder\":\n      \"Enter Netease Music song number ID.\",\n    \"widget/crossnote.video/video-url-placeholder\":\n      \"Enter video source URL here, then press 'Enter' to insert.\",\n    \"widget/crossnote.video/poster-url\": \"Poster URL (optional)\",\n    \"widget/crossnote.video/poster-url-placeholder\": \"Enter poster URL here.\",\n    \"widget/crossnote.youtube/youtube-video-url\": \"Youtube video URL\",\n    \"widget/crossnote.youtube/youtube-video-url-placeholder\":\n      \"Enter the Youtube video URL here, then press 'Enter' to insert.\",\n    \"widget/crossnote.ocr/ocr\": \"OCR - Optical character recognition\",\n    \"widget/crossnote.ocr/local-image\": \"Local image\",\n    \"widget/crossnote.ocr/recognize-text-in-languages\":\n      \"Recognize text in languages\",\n    \"widget/crossnote.ocr/start-ocr\": \"Start OCR\",\n    \"widget/crossnote.ocr/extra-settings\": \"Extra settings\",\n    \"widget/crossnote.ocr/grayscale\": \"Grayscale\",\n\n    // Tesseract\n    \"tesseract/loading tesseract core\": \"loading tesseract core\",\n    \"tesseract/initializing tesseract\": \"initializing tesseract\",\n    \"tesseract/initialized tesseract\": \"initialized tesseract\",\n    \"tesseract/loading language traineddata\": \"loading language traineddata\",\n    \"tesseract/loaded language traineddata\": \"loaded language traineddata\",\n    \"tesseract/initializing api\": \"initializing api\",\n    \"tesseract/initialized api\": \"initialized api\",\n    \"tesseract/recognizing text\": \"recognizing text\"\n  }\n};\n","import { PeerJSOption } from \"peerjs\";\n\nexport function waitForTimeout(timeout: number) {\n  return new Promise((resolve, reject) => {\n    return setTimeout(() => {\n      return resolve();\n    }, timeout);\n  });\n}\n\nexport const UUIDNil = \"00000000-0000-0000-0000-000000000000\";\n\nexport const OneDay = 1000 * 60 * 60 * 24;\n\nexport function getGraphQLEndpoint() {\n  if (process.env.NODE_ENV === \"production\") {\n    return `https://crossnote.app/api/graphql`;\n  } else {\n    return `http://${window.location.hostname}:9999/graphql`;\n  }\n}\n\nexport function getPeerJSEndpoint(): PeerJSOption {\n  if (process.env.NODE_ENV === \"production\") {\n    return {\n      host: `crossnote.app`,\n      path: \"/peer\",\n      secure: true\n      // config: { iceServers: [{ url: \"stun:stun.l.google.com:19302\" }] }\n    };\n  } else {\n    return {\n      host: window.location.hostname,\n      port: 9000,\n      path: \"/peer\",\n      secure: false\n      // config: { iceServers: [{ url: \"stun:stun.l.google.com:19302\" }] }\n    };\n  }\n}\n\nexport function getGitHubOAuthClientID() {\n  if (process.env.NODE_ENV === \"production\") {\n    return \"3dd81bb2c212b7749761\";\n  } else {\n    return \"c7477b9aa512785936e0\";\n  }\n}\n\nexport function getGitHubOAuthCallbackURL() {\n  if (process.env.NODE_ENV === \"production\") {\n    return \"https://crossnote.app/github_oauth_callback\";\n  } else {\n    return `http://${window.location.host}/github_oauth_callback`;\n  }\n}\n\nexport function startGitHubOAuth() {\n  window.open(\n    `https://github.com/login/oauth/authorize?client_id=${getGitHubOAuthClientID()}&redirect_uri=${encodeURIComponent(\n      getGitHubOAuthCallbackURL()\n    )}`,\n    \"_self\"\n  );\n}\n\nexport const graphqlFetchContext = {\n  fetchOptions: {\n    headers: {\n      Authorization: `Bearer ${localStorage.getItem(\"token\")}`\n    }\n  }\n};\nexport function formatDate(dateString: string) {\n  if (!dateString) return \"\";\n  const date = new Date(dateString);\n  const diff = Date.now() - date.getTime();\n  const passedTime = Math.abs(diff);\n\n  if (passedTime <= 1000 * 60 * 60 * 24) {\n    // within 24h\n    if (passedTime <= 1000 * 60 * 60) {\n      // within 1 hour\n      return (\n        (diff < 0 ? \"future \" : \"\") + Math.ceil(passedTime / (1000 * 60)) + \"m\"\n      );\n    } else {\n      return (\n        (diff < 0 ? \"future \" : \"\") +\n        Math.floor(passedTime / (1000 * 60 * 60)) +\n        \"h\"\n      );\n    }\n  } else {\n    const monthNamesShort = [\n      \"Jan\",\n      \"Feb\",\n      \"Mar\",\n      \"Apr\",\n      \"May\",\n      \"Jun\",\n      \"Jul\",\n      \"Aug\",\n      \"Sep\",\n      \"Oct\",\n      \"Nov\",\n      \"Dec\"\n    ];\n    return (\n      monthNamesShort[date.getMonth()] +\n      \" \" +\n      date.getDate() +\n      \" \" +\n      date.getFullYear()\n    );\n  }\n}\n\n// https://stackoverflow.com/questions/400212/how-do-i-copy-to-the-clipboard-in-javascript\nexport function copyToClipboard(text: string) {\n  if (\"clipboardData\" in window && (window as any).clipboardData.setData) {\n    // Internet Explorer-specific code path to prevent textarea being shown while dialog is visible.\n    return (window as any).setData(\"Text\", text);\n  } else if (\n    document.queryCommandSupported &&\n    document.queryCommandSupported(\"copy\")\n  ) {\n    var textarea = document.createElement(\"textarea\");\n    textarea.textContent = text;\n    textarea.style.position = \"fixed\"; // Prevent scrolling to bottom of page in Microsoft Edge.\n    document.body.appendChild(textarea);\n    textarea.select();\n    try {\n      return document.execCommand(\"copy\"); // Security exception may be thrown by some browsers.\n    } catch (ex) {\n      console.warn(\"Copy to clipboard failed.\", ex);\n      return false;\n    } finally {\n      document.body.removeChild(textarea);\n    }\n  }\n}\n\nexport function generateUUID() {\n  // Public Domain/MIT\n  var d = new Date().getTime(); //Timestamp\n  var d2 = (performance && performance.now && performance.now() * 1000) || 0; //Time in microseconds since page-load or 0 if unsupported\n  return \"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\".replace(/[xy]/g, function(c) {\n    var r = Math.random() * 16; //random number between 0 and 16\n    if (d > 0) {\n      //Use timestamp until depleted\n      r = (d + r) % 16 | 0;\n      d = Math.floor(d / 16);\n    } else {\n      //Use microseconds since page-load if supported\n      r = (d2 + r) % 16 | 0;\n      d2 = Math.floor(d2 / 16);\n    }\n    return (c === \"x\" ? r : (r & 0x3) | 0x8).toString(16);\n  });\n}\n\nexport class RandomColorGenerator {\n  private cache: { [key: string]: string } = {};\n  private hashCode(s: string): number {\n    let n = s.split(\"\").reduce(function(a, b) {\n      a = (a << 5) - a + b.charCodeAt(0);\n      return a & a;\n    }, 0);\n    n = Math.abs(n);\n    const x = \"0.\" + n.toString();\n    return parseFloat(x);\n  }\n  public generateColor(key: string): string {\n    if (key in this.cache) {\n      return this.cache[key];\n    } else {\n      const color =\n        \"#\" +\n        (((1 << 24) * /* Math.random() */ this.hashCode(key)) | 0).toString(16);\n      this.cache[key] = color;\n      return color;\n    }\n  }\n}\n\nexport const randomColorGenerator = new RandomColorGenerator();\n\nexport function randomID() {\n  return Math.random()\n    .toString(36)\n    .substr(2, 9);\n}\n","import { useState, useEffect, useCallback } from \"react\";\nimport { createContainer } from \"unstated-next\";\nimport * as path from \"path\";\nimport { randomID, OneDay } from \"../utilities/utils\";\nimport { useTranslation } from \"react-i18next\";\nimport Crossnote, {\n  Notebook,\n  Note,\n  Directory,\n  NoteConfig,\n  PushNotebookArgs,\n  PullNotebookArgs\n} from \"../lib/crossnote\";\n\ninterface InitialState {\n  crossnote: Crossnote;\n}\n\nfunction useCrossnoteContainer(initialState: InitialState) {\n  const { t } = useTranslation();\n  const crossnote = initialState.crossnote;\n  const [notebooks, setNotebooks] = useState<Notebook[]>([]);\n  const [selectedNotebook, setSelectedNotebook] = useState<Notebook>(null);\n  const [notebookNotes, setNotebookNotes] = useState<Note[]>([]);\n  const [notebookDirectories, setNotebookDirectories] = useState<Directory>({\n    name: \".\",\n    path: \".\",\n    children: []\n  });\n  const [notes, setNotes] = useState<Note[]>([]);\n  const [selectedNote, setSelectedNote] = useState<Note>(null);\n  const [includeSubdirectories, setIncludeSubdirectories] = useState<boolean>(\n    true\n  );\n  const [selectedDir, setSelectedDir] = useState<string>(\"$notes\"); // $notes | $todau | $todo | real directory\n  const [isAddingNotebook, setIsAddingNotebook] = useState<boolean>(false);\n  const [isPushingNotebook, setIsPushingNotebook] = useState<boolean>(false);\n  const [isPullingNotebook, setIsPullingNotebook] = useState<boolean>(false);\n  const [displayMobileEditor, setDisplayMobileEditor] = useState<boolean>(true);\n  const updateNoteMarkdown = useCallback(\n    (note: Note, markdown: string, callback?: (status: string) => void) => {\n      setNotes(notes =>\n        notes.map(n => {\n          if (n.filePath === note.filePath) {\n            n.markdown = markdown;\n            //  n.config.modifiedAt = new Date();\n            crossnote\n              .writeNote(note.notebook, note.filePath, markdown, note.config)\n              .then(() => {\n                if (callback) {\n                  crossnote.getStatus(note).then(status => {\n                    callback(status);\n                  });\n                }\n              });\n            return n;\n          } else {\n            return n;\n          }\n        })\n      );\n    },\n    [crossnote]\n  );\n\n  const deleteNote = useCallback(\n    (note: Note) => {\n      crossnote.deleteNote(selectedNotebook, note.filePath);\n      setNotebookNotes(notes => {\n        const newNotes = notes.filter(n => n.filePath !== note.filePath);\n        if (newNotes.length !== notes.length) {\n          setSelectedNote(newNotes[0]);\n        }\n\n        crossnote\n          .getNotebookDirectoriesFromNotes(newNotes)\n          .then(directories => {\n            setNotebookDirectories(directories);\n          });\n        return newNotes;\n      });\n      setDisplayMobileEditor(false);\n    },\n    [crossnote, selectedNotebook]\n  );\n\n  const changeNoteFilePath = useCallback(\n    (note: Note, newFilePath: string) => {\n      (async () => {\n        await crossnote.changeNoteFilePath(selectedNotebook, note, newFilePath);\n        const newNotes = notebookNotes.map(n => {\n          if (n.filePath === note.filePath) {\n            n.filePath = newFilePath;\n            n.config.modifiedAt = new Date();\n            return n;\n          } else {\n            return n;\n          }\n        });\n        setNotebookNotes(newNotes);\n        setNotebookDirectories(\n          await crossnote.getNotebookDirectoriesFromNotes(newNotes)\n        );\n      })();\n    },\n    [selectedNotebook, crossnote, notebookNotes]\n  );\n\n  const createNewNote = useCallback(\n    (fileName: string = \"\") => {\n      (async () => {\n        if (!fileName) {\n          fileName = randomID();\n        }\n        if (!fileName.endsWith(\".md\")) {\n          fileName = fileName + \".md\";\n        }\n        let dir = selectedDir;\n        let filePath;\n        if (\n          selectedDir === \"$notes\" ||\n          selectedDir === \"$today\" ||\n          selectedDir === \"$todo\"\n        ) {\n          filePath = fileName;\n        } else {\n          filePath = path.relative(\n            selectedNotebook.dir,\n            path.resolve(selectedNotebook.dir, dir, fileName)\n          );\n        }\n\n        const noteConfig: NoteConfig = {\n          id: \"\",\n          tags: [],\n          modifiedAt: new Date(),\n          createdAt: new Date()\n        };\n        await crossnote.writeNote(selectedNotebook, filePath, \"\", noteConfig);\n        const note: Note = {\n          notebook: selectedNotebook,\n          filePath: filePath,\n          title: \"\",\n          markdown: \"\",\n          config: noteConfig\n        };\n        setNotebookNotes(notes => [note, ...notes]);\n        setSelectedNote(note);\n        setDisplayMobileEditor(true);\n      })();\n    },\n    [selectedNotebook, crossnote, selectedDir]\n  );\n\n  const addNotebook = useCallback(\n    async (\n      name: string,\n      gitURL: string,\n      gitBranch: string,\n      gitUsername: string,\n      gitPassword: string,\n      gitRememberCredentials: boolean,\n      gitCorsProxy: string\n    ) => {\n      setIsAddingNotebook(true);\n      try {\n        const notebook = await crossnote.addNotebook({\n          name,\n          gitURL,\n          branch: gitBranch,\n          username: gitUsername,\n          password: gitPassword,\n          corsProxy: gitCorsProxy,\n          rememberCredentials: gitRememberCredentials\n        });\n        setNotebooks(notebooks => [notebook, ...notebooks]);\n        setIsAddingNotebook(false);\n      } catch (error) {\n        setIsAddingNotebook(false);\n        throw error;\n      }\n    },\n    [crossnote]\n  );\n\n  const updateNotebook = useCallback(\n    async (notebook: Notebook) => {\n      if (!crossnote) {\n        return;\n      }\n      try {\n        await crossnote.updateNotebook(notebook);\n        setNotebooks(notebooks => [...notebooks]);\n      } catch (error) {}\n    },\n    [crossnote]\n  );\n\n  const deleteNotebook = useCallback(\n    async (notebook: Notebook) => {\n      if (!crossnote) {\n        return;\n      }\n      try {\n        await crossnote.deleteNotebook(notebook._id);\n      } catch (error) {}\n      let selectedNotebook: Notebook = null;\n      setNotebooks(notebooks =>\n        notebooks.filter(n => {\n          if (!selectedNotebook && n._id !== notebook._id) {\n            selectedNotebook = n;\n          }\n          return n._id !== notebook._id;\n        })\n      );\n      setSelectedNotebook(selectedNotebook);\n    },\n    [crossnote]\n  );\n\n  const pushNotebook = useCallback(\n    async (args: PushNotebookArgs) => {\n      if (!crossnote) {\n        return;\n      }\n      setIsPushingNotebook(true);\n      try {\n        await crossnote.pushNotebook(args);\n        setIsPushingNotebook(false);\n      } catch (error) {\n        setIsPushingNotebook(false);\n        throw error;\n      }\n    },\n    [crossnote]\n  );\n\n  const pullNotebook = useCallback(\n    async (args: PullNotebookArgs) => {\n      if (!crossnote) {\n        return;\n      }\n      setIsPullingNotebook(true);\n      try {\n        await crossnote.pullNotebook(args);\n        setIsPullingNotebook(false);\n        const notes = (\n          await crossnote.listNotes({\n            notebook: args.notebook,\n            dir: \"./\",\n            includeSubdirectories: true\n          })\n        ).sort(\n          (a, b) =>\n            b.config.modifiedAt.getTime() - a.config.modifiedAt.getTime()\n        );\n        setNotebookNotes(notes);\n        setNotebookDirectories(\n          await crossnote.getNotebookDirectoriesFromNotes(notes)\n        );\n        if (!notes.find(n => n.filePath === selectedNote.filePath)) {\n          setSelectedNote(notes[0]); // TODO: pull might remove currently selectedNote\n        }\n      } catch (error) {\n        setIsPullingNotebook(false);\n        throw error;\n      }\n    },\n    [crossnote, selectedNote]\n  );\n\n  const checkoutNote = useCallback(\n    async (note: Note) => {\n      if (!crossnote) {\n        return;\n      }\n      const newNote = await crossnote.checkoutNote(note);\n      if (newNote) {\n        setNotebookNotes(notes =>\n          notes.map(n => {\n            if (n.filePath === newNote.filePath) {\n              return newNote;\n            } else {\n              return n;\n            }\n          })\n        );\n        setNotes(notes =>\n          notes.map(n => {\n            if (n.filePath === newNote.filePath) {\n              return newNote;\n            } else {\n              return n;\n            }\n          })\n        );\n        setSelectedNote(newNote);\n      } else {\n        // The note is deleted after checkout\n        setNotebookNotes(notes => {\n          const newNotes = notes.filter(n => n.filePath !== note.filePath);\n          crossnote\n            .getNotebookDirectoriesFromNotes(newNotes)\n            .then(directories => {\n              setNotebookDirectories(directories);\n            });\n          return newNotes;\n        });\n        setNotes(notes => {\n          const newNotes = notes.filter(n => n.filePath !== note.filePath);\n          setSelectedNote(newNotes[0]);\n          return newNotes;\n        });\n      }\n    },\n    [crossnote]\n  );\n\n  useEffect(() => {\n    if (!crossnote) {\n      return;\n    }\n\n    (async () => {\n      const notebooks = await crossnote.listNotebooks();\n      let notebook: Notebook = null;\n      if (notebooks.length) {\n        setNotebooks(notebooks);\n        setSelectedNotebook(notebooks[0]); // TODO: <= default selected\n        notebook = notebooks[0];\n      } else {\n        /*\n        notebook = await crossnote.cloneNotebook({\n          corsProxy: \"https://cors.isomorphic-git.org\",\n          gitURL: \"https://github.com/0xGG/crossnote-doc.git\"\n        });\n        */\n        notebook = await crossnote.addNotebook({\n          name: \"Unamed\",\n          corsProxy: \"https://cors.isomorphic-git.org\",\n          gitURL: \"\"\n        });\n        setNotebooks([notebook]);\n        setSelectedNotebook(notebook);\n      }\n    })();\n  }, [crossnote]);\n\n  useEffect(() => {\n    if (!crossnote) {\n      return;\n    }\n    (async () => {\n      const notes = (\n        await crossnote.listNotes({\n          notebook: selectedNotebook,\n          dir: \"./\",\n          includeSubdirectories: true\n        })\n      ).sort(\n        (a, b) => b.config.modifiedAt.getTime() - a.config.modifiedAt.getTime()\n      );\n      setNotebookNotes(notes);\n      setNotebookDirectories(\n        await crossnote.getNotebookDirectoriesFromNotes(notes)\n      );\n      setSelectedNote(notes[0]);\n    })();\n  }, [crossnote, selectedNotebook]);\n\n  useEffect(() => {\n    if (crossnote && selectedNotebook) {\n      setSelectedDir(\"$notes\");\n    }\n  }, [crossnote, selectedNotebook]);\n\n  useEffect(() => {\n    if (crossnote && selectedNotebook && notebookNotes) {\n      if (\n        notebookNotes.length &&\n        notebookNotes[0].notebook._id !== selectedNotebook._id\n      ) {\n        return;\n      }\n\n      let notes: Note[] = [];\n      if (selectedDir === \"$notes\") {\n        notes = [...notebookNotes];\n      } else if (selectedDir === \"$todo\") {\n        notes = notebookNotes.filter(note =>\n          note.markdown.match(/(\\*|-|\\d+\\.)\\s\\[(\\s+|x|X)\\]\\s/gm)\n        );\n      } else if (selectedDir === \"$today\") {\n        notes = notebookNotes.filter(\n          note => Date.now() - note.config.modifiedAt.getTime() <= OneDay\n        );\n      } else {\n        if (includeSubdirectories) {\n          notes = notebookNotes.filter(\n            note => note.filePath.indexOf(selectedDir + \"/\") === 0\n          );\n        } else {\n          notes = notebookNotes.filter(\n            note => path.dirname(note.filePath) === selectedDir\n          );\n        }\n      }\n\n      setNotes(notes);\n      if (!selectedNote) {\n        setSelectedNote(notes[0]);\n      }\n    }\n  }, [\n    selectedDir,\n    crossnote,\n    selectedNotebook,\n    includeSubdirectories,\n    selectedNote,\n    notebookNotes\n  ]);\n\n  return {\n    crossnote,\n    notebooks,\n    selectedNotebook,\n    setSelectedNotebook,\n    notes,\n    selectedNote,\n    setSelectedNote,\n    updateNoteMarkdown,\n    createNewNote,\n    selectedDir,\n    setSelectedDir,\n    includeSubdirectories,\n    setIncludeSubdirectories,\n    deleteNote,\n    changeNoteFilePath,\n    notebookDirectories,\n    addNotebook,\n    isAddingNotebook,\n    isPushingNotebook,\n    isPullingNotebook,\n    updateNotebook,\n    deleteNotebook,\n    pushNotebook,\n    pullNotebook,\n    checkoutNote,\n    displayMobileEditor,\n    setDisplayMobileEditor\n  };\n}\n\nexport const CrossnoteContainer = createContainer(useCrossnoteContainer);\n","import { UUIDNil } from \"./utils\";\n\nexport interface Summary {\n  title: string;\n  summary: string;\n  coverImage: string;\n  images: string[]; // If has `title`, then images[0] is cover.\n  /**\n   * HTML code for video.\n   */\n  video: string;\n  tags: string[]; // TODO: support tags\n  html: string; // original html\n  hasMoreContent?: boolean; // has more content => display `continue reading`\n}\n\n/*\nexport async function getTopicsAndMentionsFromHTML(\n  html: string,\n  ribbit: Ribbit\n): Promise<{\n  topics: string[];\n  mentions: { name: string; address: string }[];\n}> {\n  const div = document.createElement(\"div\");\n  const topics = [];\n  const mentions = [];\n  div.innerHTML = html;\n\n  const tagElems = div.getElementsByClassName(\"tag\");\n  for (let i = 0; i < tagElems.length; i++) {\n    const tagElem = tagElems[i] as HTMLAnchorElement;\n    if (tagElem.classList.contains(\"tag-mention\")) {\n      const mention = tagElem.getAttribute(\"data-mention\");\n      const userInfo = await ribbit.getUserInfoFromUsername(mention);\n      mentions.push({\n        name: userInfo.username,\n        address: userInfo.address\n      });\n    } else if (tagElem.classList.contains(\"tag-topic\")) {\n      const topic = tagElem.getAttribute(\"data-topic\");\n      topics.push(topic);\n    }\n  }\n  div.remove();\n\n  return {\n    topics: Array.from(new Set(topics)),\n    mentions\n  };\n}\n*/\n\nexport function getHeaderFromMarkdown(markdown: string): string {\n  const titleMatch = markdown.match(/^#\\s.+$/gim);\n  if (titleMatch && titleMatch.length) {\n    return titleMatch[0].replace(/^#/, \"\").trim();\n  }\n  return \"\";\n}\n\nexport function getMentionsFromMarkdown(markdown: string): string[] {\n  return (markdown.match(/@(?:[a-zA-Z\\d]+-)*[a-zA-Z\\d]+/g) || [])\n    .map(username => username.replace(/^@/, \"\").toLocaleLowerCase())\n    .filter(\n      (username, index, self) =>\n        index === self.findIndex(username2 => username === username2)\n    );\n}\n\nexport async function generateSummaryFromMarkdown(\n  markdown: string\n): Promise<Summary> {\n  let title = \"\",\n    summary = \"\",\n    coverImage = \"\",\n    images: string[] = [],\n    hasMoreContent = true;\n\n  markdown = markdown.replace(/^---.+?\\n---/, \"\"); // Remove front matter\n  let contentString = markdown;\n\n  const titleMatch = markdown.match(/^#\\s.+$/gim);\n  if (titleMatch && titleMatch.length) {\n    title = titleMatch[0].replace(/^#/, \"\").trim();\n    const aheadString = markdown\n      .slice(0, markdown.indexOf(titleMatch[0]))\n      .trim();\n    contentString = markdown.slice(\n      markdown.indexOf(titleMatch[0]) + titleMatch[0].length,\n      markdown.length\n    );\n    const coverMatch = aheadString.match(/^!\\[.*?\\]\\(.+?\\)/gim);\n    if (coverMatch && coverMatch.length) {\n      images.push(coverMatch[0].match(/\\(([^)\"]+?)\\)/)[1].trim());\n      coverImage = images[0];\n    }\n  }\n\n  const coverImagesMatch = markdown.match(/^!\\[\\s*cover\\s*\\]\\(.+?\\)/gim);\n  if (coverImagesMatch && coverImagesMatch.length) {\n    coverImagesMatch.forEach(mdImage => {\n      images.push(mdImage.match(/\\(([^)\"]+?)\\)/)[1].trim());\n    });\n    images = images.filter(\n      (image, index, self) => index === self.findIndex(m => m === image)\n    );\n  }\n\n  summary = contentString\n    .split(\"\\n\")\n    .filter(\n      x =>\n        x.trim().length > 0 &&\n        !x.match(/!\\[.*?\\]\\(.+?\\)/) && // Remove image\n        !x.match(/`@.+?`/) // Remove widget\n    )\n    .map(x => x.replace(/#+\\s(.+)\\s*$/, \"**$1**\").trim()) // Replace headers to bold\n    .slice(0, 10)\n    .join(\"  \\n\");\n\n  return {\n    title,\n    summary,\n    coverImage,\n    images,\n    tags: [],\n    html: \"\",\n    hasMoreContent,\n    video: \"\"\n  };\n}\n\nexport const EmptyPageInfo = {\n  hasPreviousPage: false,\n  hasNextPage: false,\n  startCursor: UUIDNil,\n  endCursor: UUIDNil\n};\n","import React, { useState, useEffect } from \"react\";\nimport { createStyles, makeStyles, Theme } from \"@material-ui/core/styles\";\nimport clsx from \"clsx\";\nimport { CrossnoteContainer } from \"../containers/crossnote\";\nimport { Box, Typography, ButtonBase } from \"@material-ui/core\";\nimport { Note } from \"../lib/crossnote\";\nimport {\n  getHeaderFromMarkdown,\n  generateSummaryFromMarkdown,\n  Summary\n} from \"../utilities/note\";\nimport { formatDistanceStrict } from \"date-fns/esm\";\nimport { useTranslation } from \"react-i18next\";\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    noteCard: {\n      width: \"100%\",\n      display: \"flex\",\n      flexDirection: \"row\",\n      alignItems: \"flex-start\",\n      padding: theme.spacing(2, 0.5, 0),\n      textAlign: \"left\",\n      cursor: \"default\"\n    },\n    selected: {\n      borderLeft: `4px solid ${theme.palette.primary.main}`\n    },\n    unselected: {\n      borderLeft: `4px solid rgba(0, 0, 0, 0)`\n    },\n    leftPanel: {\n      width: \"48px\",\n      paddingLeft: theme.spacing(0.5)\n    },\n    duration: {\n      color: theme.palette.text.secondary\n    },\n    rightPanel: {\n      flex: \"1\",\n      borderBottom: \"1px solid #ededed\"\n    },\n    header: {\n      marginBottom: theme.spacing(2)\n    },\n    summary: {\n      color: theme.palette.text.secondary,\n      marginBottom: theme.spacing(2),\n      paddingRight: theme.spacing(2),\n      display: \"-webkit-box\",\n      lineHeight: \"1.3rem !important\",\n      textOverflow: \"ellipsis !important\",\n      overflow: \"hidden !important\",\n      maxWidth: \"100%\",\n      maxHeight: \"2.6rem\", // lineHeight x -website-line-clamp\n      \"-webkit-line-clamp\": 2,\n      \"-webkit-box-orient\": \"vertical\",\n      wordBreak: \"break-all\"\n    },\n    filePath: {}\n  })\n);\n\ninterface Props {\n  note: Note;\n}\n\nexport default function NoteCard(props: Props) {\n  const classes = useStyles(props);\n  const note = props.note;\n  const crossnoteContainer = CrossnoteContainer.useContainer();\n  const [header, setHeader] = useState<string>(\"\");\n  const [summary, setSummary] = useState<Summary>(null);\n  const { t } = useTranslation();\n  const duration = formatDistanceStrict(note.config.modifiedAt, Date.now())\n    .replace(/\\sseconds?/, \"s\")\n    .replace(/\\sminutes?/, \"m\")\n    .replace(/\\shours?/, \"h\")\n    .replace(/\\sdays?/, \"d\")\n    .replace(/\\sweeks?/, \"w\")\n    .replace(/\\smonths?/, \"mo\")\n    .replace(/\\syears?/, \"y\");\n\n  useEffect(() => {\n    setHeader(getHeaderFromMarkdown(note.markdown));\n    generateSummaryFromMarkdown(\n      note.markdown || t(\"general/this-note-is-empty\")\n    )\n      .then(summary => {\n        setSummary(summary);\n      })\n      .catch(error => {});\n  }, [note.markdown, t]);\n\n  return (\n    <ButtonBase\n      className={clsx(\n        classes.noteCard,\n        crossnoteContainer.selectedNote &&\n          crossnoteContainer.selectedNote.filePath === note.filePath\n          ? classes.selected\n          : classes.unselected\n      )}\n      onClick={() => {\n        crossnoteContainer.setSelectedNote(note);\n        crossnoteContainer.setDisplayMobileEditor(true);\n      }}\n    >\n      <Box className={clsx(classes.leftPanel)}>\n        <Typography className={clsx(classes.duration)}>{duration}</Typography>\n      </Box>\n      <Box className={clsx(classes.rightPanel)}>\n        {header && (\n          <Typography\n            style={{ fontWeight: \"bold\" }}\n            variant={\"body1\"}\n            className={clsx(classes.header)}\n          >\n            {header}\n          </Typography>\n        )}\n        {summary && (\n          <Typography className={clsx(classes.summary)}>\n            {summary && summary.summary}\n          </Typography>\n        )}\n        <Typography variant={\"caption\"} className={clsx(classes.filePath)}>\n          {note.filePath}\n        </Typography>\n      </Box>\n    </ButtonBase>\n  );\n}\n","import React, { useState, useEffect, useCallback } from \"react\";\nimport {\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  TextField,\n  Box,\n  Typography,\n  DialogActions,\n  Button,\n  Link,\n  FormControlLabel,\n  Checkbox,\n  ExpansionPanel,\n  ExpansionPanelDetails,\n  ExpansionPanelSummary\n} from \"@material-ui/core\";\nimport { ChevronDown } from \"mdi-material-ui\";\nimport { CrossnoteContainer } from \"../containers/crossnote\";\nimport { Notebook } from \"../lib/crossnote\";\n\ninterface Props {\n  open: boolean;\n  onClose: () => void;\n  notebook: Notebook;\n}\n\nconst MaxClickDeleteCount = 3;\nexport default function ConfigureNotebookDialog(props: Props) {\n  const crossnoteContainer = CrossnoteContainer.useContainer();\n  const [notebookName, setNotebookName] = useState<string>(\"\");\n  const [expanded, setExpanded] = useState<boolean>(false);\n  const [gitURL, setGitURL] = useState<string>(\"\");\n  const [gitBranch, setGitBranch] = useState<string>(\"\");\n  const [gitUsername, setGitUsername] = useState<string>(\"\");\n  const [gitPassword, setGitPassword] = useState<string>(\"\");\n  const [gitCorsProxy, setGitCorsProxy] = useState<string>(\n    \"https://cors.isomorphic-git.org\"\n  );\n  const [clickDeleteCount, setClickDeleteCount] = useState<number>(\n    MaxClickDeleteCount\n  );\n  const [rememberCredentialsChecked, setRememberCredentialsChecked] = useState<\n    boolean\n  >(false);\n\n  useEffect(() => {\n    const notebook = props.notebook;\n    if (!notebook) {\n      return;\n    }\n    setNotebookName(notebook.name);\n    setGitURL(notebook.gitURL);\n    setGitBranch(notebook.gitBranch || \"master\");\n    setGitUsername(notebook.gitUsername);\n    setGitPassword(notebook.gitPassword);\n    setGitCorsProxy(notebook.gitCorsProxy);\n  }, [props.notebook]);\n\n  const updateNotebook = useCallback(async () => {\n    const notebook = props.notebook;\n    if (!notebook) {\n      props.onClose();\n      return;\n    }\n    notebook.name = notebookName.trim();\n    notebook.gitURL = gitURL.trim();\n    notebook.gitBranch = gitBranch.trim();\n    notebook.gitUsername = gitUsername.trim();\n    notebook.gitPassword = gitPassword;\n    notebook.gitCorsProxy = gitCorsProxy.trim();\n    try {\n      await crossnoteContainer.updateNotebook(notebook);\n    } catch (error) {}\n    props.onClose();\n  }, [\n    props,\n    props.notebook,\n    notebookName,\n    gitURL,\n    gitBranch,\n    gitUsername,\n    gitPassword,\n    gitCorsProxy\n  ]);\n\n  const deleteNotebook = useCallback(async () => {\n    const notebook = props.notebook;\n    try {\n      await crossnoteContainer.deleteNotebook(notebook);\n    } catch (error) {}\n    props.onClose();\n  }, [props.notebook]);\n\n  useEffect(() => {\n    setClickDeleteCount(MaxClickDeleteCount);\n  }, [props.notebook]);\n\n  return (\n    <Dialog open={props.open} onClose={props.onClose}>\n      <DialogTitle>Configure a notebook</DialogTitle>\n      <DialogContent>\n        <TextField\n          label={\"Notebook name\"}\n          value={notebookName}\n          fullWidth={true}\n          onChange={event => {\n            setNotebookName(event.target.value);\n          }}\n          style={{ marginBottom: \"16px\" }}\n        ></TextField>\n        <ExpansionPanel\n          elevation={2}\n          expanded={expanded}\n          onChange={() => setExpanded(!expanded)}\n        >\n          <ExpansionPanelSummary expandIcon={<ChevronDown></ChevronDown>}>\n            <Typography>{\"Git repository (optional)\"}</Typography>\n          </ExpansionPanelSummary>\n          <ExpansionPanelDetails>\n            <Box>\n              <TextField\n                label={\"url\"}\n                placeholder={\"https://abc/def.git\"}\n                disabled={true}\n                fullWidth={true}\n                value={gitURL}\n                onChange={event => setGitURL(event.target.value)}\n              ></TextField>\n              <TextField\n                label={\"branch\"}\n                placeholder={\"master\"}\n                disabled={true}\n                fullWidth={true}\n                value={gitBranch}\n                onChange={event => setGitBranch(event.target.value)}\n              ></TextField>\n              <TextField\n                label={\"username (optional)\"}\n                placeholder={\"username (optional)\"}\n                fullWidth={true}\n                value={gitUsername}\n                onChange={event => setGitUsername(event.target.value)}\n              ></TextField>\n              <TextField\n                label={\"password (optional)\"}\n                placeholder={\"password (optional)\"}\n                type={\"password\"}\n                fullWidth={true}\n                value={gitPassword}\n                onChange={event => setGitPassword(event.target.value)}\n              ></TextField>\n              <FormControlLabel\n                control={\n                  <Checkbox\n                    checked={rememberCredentialsChecked}\n                    onChange={() =>\n                      setRememberCredentialsChecked(!rememberCredentialsChecked)\n                    }\n                    value={rememberCredentialsChecked}\n                  />\n                }\n                label={\n                  <Typography>\n                    {\"Remember credentials\" +\n                      \" \" +\n                      (rememberCredentialsChecked ? \"(stored locally)\" : \"\")}\n                  </Typography>\n                }\n              />\n              <TextField\n                label={\"cors proxy\"}\n                placeholder={\"https://cors.isomorphic-git.org\"}\n                fullWidth={true}\n                value={gitCorsProxy}\n                onChange={event => setGitCorsProxy(event.target.value)}\n              ></TextField>\n              <Link\n                href={\n                  \"https://github.com/isomorphic-git/isomorphic-git#cors-support\"\n                }\n                target={\"_blank\"}\n              >\n                Why we need cors proxy?\n              </Link>\n            </Box>\n          </ExpansionPanelDetails>\n        </ExpansionPanel>\n      </DialogContent>\n      <DialogActions>\n        <Button\n          variant={\"contained\"}\n          color={\"secondary\"}\n          disabled={!clickDeleteCount}\n          onClick={() => {\n            if (clickDeleteCount === 1) {\n              deleteNotebook();\n              setClickDeleteCount(clickDeleteCount - 1);\n            } else {\n              setClickDeleteCount(clickDeleteCount - 1);\n            }\n          }}\n        >\n          {\"Delete\" +\n            (clickDeleteCount < MaxClickDeleteCount\n              ? ` ${clickDeleteCount}`\n              : \"\")}\n        </Button>\n        <Button\n          variant={\"contained\"}\n          color={\"primary\"}\n          onClick={updateNotebook}\n        >\n          {\"Save\"}\n        </Button>\n        <Button onClick={props.onClose}>{\"Cancel\"}</Button>\n      </DialogActions>\n    </Dialog>\n  );\n}\n","import React, { useState } from \"react\";\nimport {\n  fade,\n  createStyles,\n  makeStyles,\n  Theme\n} from \"@material-ui/core/styles\";\nimport clsx from \"clsx\";\nimport { CrossnoteContainer } from \"../containers/crossnote\";\nimport {\n  Box,\n  InputBase,\n  Card,\n  IconButton,\n  Typography,\n  Hidden\n} from \"@material-ui/core\";\nimport NoteCard from \"./NoteCard\";\nimport {\n  Magnify,\n  FileEditOutline,\n  Settings,\n  Menu as MenuIcon\n} from \"mdi-material-ui\";\nimport { useTranslation } from \"react-i18next\";\nimport ConfigureNotebookDialog from \"./ConfigureNotebookDialog\";\n\nconst OneDay = 1000 * 60 * 60 * 24;\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    notes: {\n      display: \"flex\",\n      flexDirection: \"column\",\n      height: \"100%\"\n    },\n    topPanel: {\n      padding: theme.spacing(1)\n    },\n    row: {\n      display: \"flex\",\n      alignItems: \"center\"\n    },\n    sectionName: {\n      marginLeft: theme.spacing(1)\n    },\n    search: {\n      position: \"relative\",\n      borderRadius: theme.shape.borderRadius,\n      backgroundColor: fade(theme.palette.common.white, 0.15),\n      \"&:hover\": {\n        backgroundColor: fade(theme.palette.common.white, 0.25)\n      },\n      marginRight: 0, // theme.spacing(2),\n      marginLeft: 0,\n      width: \"100%\",\n      [theme.breakpoints.up(\"sm\")]: {\n        // marginLeft: theme.spacing(3),\n        // width: \"auto\"\n      }\n    },\n    searchIcon: {\n      width: theme.spacing(7),\n      color: \"rgba(0, 0, 0, 0.54)\",\n      height: \"100%\",\n      position: \"absolute\",\n      pointerEvents: \"none\",\n      display: \"flex\",\n      alignItems: \"center\",\n      justifyContent: \"center\"\n    },\n    inputRoot: {\n      color: \"inherit\",\n      border: \"1px solid #bbb\",\n      borderRadius: \"4px\"\n    },\n    inputInput: {\n      padding: theme.spacing(1, 1, 1, 7),\n      transition: theme.transitions.create(\"width\"),\n      width: \"100%\",\n      [theme.breakpoints.up(\"md\")]: {\n        // width: 200\n      }\n    },\n    notesList: {\n      flex: \"1\",\n      overflowY: \"auto\",\n      paddingBottom: theme.spacing(12)\n    }\n  })\n);\n\ninterface Props {\n  toggleDrawer: () => void;\n}\n\nexport default function Notes(props: Props) {\n  const classes = useStyles(props);\n  const { t } = useTranslation();\n  const crossnoteContainer = CrossnoteContainer.useContainer();\n\n  // Search\n  const [searchValue, setSearchValue] = useState<string>(\"\");\n\n  const [\n    notebookConfigurationDialogOpen,\n    setNotebookConfigurationDialogOpen\n  ] = useState<boolean>(false);\n\n  return (\n    <Box className={clsx(classes.notes)}>\n      <Card className={clsx(classes.topPanel)}>\n        <Box className={clsx(classes.row)}>\n          <Hidden smUp implementation=\"css\">\n            <IconButton onClick={props.toggleDrawer}>\n              <MenuIcon></MenuIcon>\n            </IconButton>\n          </Hidden>\n          <div className={classes.search}>\n            <div className={classes.searchIcon}>\n              <Magnify />\n            </div>\n            <InputBase\n              placeholder={t(\"search/placeholder\")}\n              classes={{\n                root: classes.inputRoot,\n                input: classes.inputInput\n              }}\n              value={searchValue}\n              inputProps={{ \"aria-label\": \"search\" }}\n              onChange={event => setSearchValue(event.target.value)}\n            />\n          </div>\n          <IconButton\n            onClick={() => {\n              crossnoteContainer.createNewNote();\n            }}\n          >\n            <FileEditOutline></FileEditOutline>\n          </IconButton>\n        </Box>\n        <Box\n          className={clsx(classes.row)}\n          style={{ justifyContent: \"space-between\" }}\n        >\n          {crossnoteContainer.selectedDir === \"$notes\" ? (\n            <Box className={clsx(classes.row)}>\n              <span role=\"img\" aria-label=\"notes\">\n                📒\n              </span>\n              <Typography className={clsx(classes.sectionName)}>\n                {crossnoteContainer.selectedNotebook &&\n                  crossnoteContainer.selectedNotebook.name}\n              </Typography>\n            </Box>\n          ) : crossnoteContainer.selectedDir === \"$today\" ? (\n            <Box className={clsx(classes.row)}>\n              <span role=\"img\" aria-label=\"today-notes\">\n                🗓\n              </span>\n              <Typography className={clsx(classes.sectionName)}>\n                {\" today\"}\n              </Typography>\n            </Box>\n          ) : crossnoteContainer.selectedDir === \"$todo\" ? (\n            <Box className={clsx(classes.row)}>\n              <span role=\"img\" aria-label=\"todo-notes\">\n                ☑️\n              </span>\n              <Typography className={clsx(classes.sectionName)}>\n                {\" todo\"}\n              </Typography>\n            </Box>\n          ) : (\n            crossnoteContainer.selectedDir && (\n              <Box className={clsx(classes.row)}>\n                <span role=\"img\" aria-label=\"folder\">\n                  {\"📁\"}\n                </span>\n                <Typography className={clsx(classes.sectionName)}>\n                  {crossnoteContainer.selectedDir}\n                </Typography>\n              </Box>\n            )\n          )}\n\n          {crossnoteContainer.selectedDir === \"$notes\" && (\n            <IconButton\n              onClick={() => setNotebookConfigurationDialogOpen(true)}\n            >\n              <Settings></Settings>\n            </IconButton>\n          )}\n        </Box>\n      </Card>\n\n      <ConfigureNotebookDialog\n        open={notebookConfigurationDialogOpen}\n        onClose={() => setNotebookConfigurationDialogOpen(false)}\n        notebook={crossnoteContainer.selectedNotebook}\n      ></ConfigureNotebookDialog>\n\n      <Box className={clsx(classes.notesList)}>\n        {crossnoteContainer.notes.map(note => {\n          if (searchValue.trim().length) {\n            const regexp = new RegExp(\n              \"(\" +\n                searchValue\n                  .trim()\n                  .split(/\\s+/g)\n                  .map(s => \"\\\\\" + s.split(\"\").join(\"\\\\\"))\n                  .join(\"|\") +\n                \")\",\n              \"i\"\n            );\n\n            if (note.markdown.match(regexp) || note.filePath.match(regexp)) {\n              return (\n                <NoteCard\n                  key={\"note-card-\" + note.filePath}\n                  note={note}\n                ></NoteCard>\n              );\n            }\n          } else {\n            return (\n              <NoteCard\n                key={\"note-card-\" + note.filePath}\n                note={note}\n              ></NoteCard>\n            );\n          }\n        })}\n      </Box>\n    </Box>\n  );\n}\n","import React, { useState, useEffect, useCallback } from \"react\";\nimport {\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogActions,\n  Button,\n  TextField,\n  Typography,\n  Box\n} from \"@material-ui/core\";\nimport { CrossnoteContainer } from \"../containers/crossnote\";\nimport { Notebook } from \"../lib/crossnote\";\nimport Noty from \"noty\";\n\ninterface Props {\n  open: boolean;\n  onClose: () => void;\n  notebook: Notebook;\n}\n\nexport default function PushNotebookDialog(props: Props) {\n  const crossnoteContainer = CrossnoteContainer.useContainer();\n  const notebook = props.notebook;\n  const [authorName, setAuthorName] = useState<string>(\n    localStorage.getItem(\"authorName\") || \"anonymous\"\n  );\n  const [authorEmail, setAuthorEmail] = useState<string>(\n    localStorage.getItem(\"authorEmail\") || \"anonymous@crossnote.app\"\n  );\n  const [gitUsername, setGitUsername] = useState<string>(notebook.gitUsername);\n  const [gitPassword, setGitPassword] = useState<string>(notebook.gitPassword);\n  const [commitMessage, setCommitMessage] = useState<string>(\n    \"doc: Updated docs\"\n  );\n\n  const pushNotebook = useCallback(() => {\n    crossnoteContainer\n      .pushNotebook({\n        notebook,\n        authorName,\n        authorEmail,\n        username: gitUsername,\n        password: gitPassword,\n        message: commitMessage,\n        onAuthFailure: () => {\n          new Noty({\n            type: \"error\",\n            text: \"Authentication failed\",\n            layout: \"topRight\",\n            theme: \"relax\",\n            timeout: 5000\n          }).show();\n        }\n      })\n      .then(() => {\n        props.onClose();\n        new Noty({\n          type: \"success\",\n          text: \"Notebook pushed\",\n          layout: \"topRight\",\n          theme: \"relax\",\n          timeout: 2000\n        }).show();\n      })\n      .catch(error => {\n        console.log(error);\n        props.onClose();\n        new Noty({\n          type: \"error\",\n          text: \"Failed to push notebook\",\n          layout: \"topRight\",\n          theme: \"relax\",\n          timeout: 2000\n        }).show();\n      });\n  }, [\n    authorEmail,\n    authorName,\n    gitUsername,\n    gitPassword,\n    notebook,\n    commitMessage,\n    props\n  ]);\n\n  useEffect(() => {\n    localStorage.setItem(\"authorName\", authorName);\n  }, [authorName]);\n\n  useEffect(() => {\n    localStorage.setItem(\"authorEmail\", authorEmail);\n  }, [authorEmail]);\n\n  useEffect(() => {\n    setGitUsername(notebook.gitUsername);\n  }, [notebook.gitUsername, props.open]);\n\n  useEffect(() => {\n    setGitPassword(notebook.gitPassword);\n  }, [notebook.gitPassword, props.open]);\n\n  return (\n    <Dialog\n      open={props.open}\n      onClose={() => {\n        if (!crossnoteContainer.isPushingNotebook) {\n          props.onClose();\n        }\n      }}\n    >\n      <DialogTitle>\n        {`Push notebook ${notebook.name} to git repository`}\n        <Box>\n          <Typography variant={\"caption\"}>\n            {notebook.gitURL + \":\" + notebook.gitBranch}\n          </Typography>\n        </Box>\n      </DialogTitle>\n      <DialogContent>\n        <TextField\n          label={\"Author name\"}\n          fullWidth={true}\n          value={authorName}\n          onChange={event => setAuthorName(event.target.value)}\n        ></TextField>\n        <TextField\n          label={\"Author email\"}\n          fullWidth={true}\n          value={authorEmail}\n          onChange={event => setAuthorEmail(event.target.value)}\n        ></TextField>\n        <TextField\n          label={\"Commit message\"}\n          fullWidth={true}\n          value={commitMessage}\n          onChange={event => setCommitMessage(event.target.value)}\n        ></TextField>\n        <TextField\n          label={\"username\"}\n          placeholder={\"username\"}\n          fullWidth={true}\n          value={gitUsername}\n          onChange={event => setGitUsername(event.target.value)}\n        ></TextField>\n        <TextField\n          label={\"password\"}\n          placeholder={\"password\"}\n          type={\"password\"}\n          fullWidth={true}\n          value={gitPassword}\n          onChange={event => setGitPassword(event.target.value)}\n        ></TextField>\n      </DialogContent>\n      <DialogActions>\n        <Button\n          variant={\"contained\"}\n          color={\"primary\"}\n          disabled={crossnoteContainer.isPushingNotebook}\n          onClick={pushNotebook}\n        >\n          {crossnoteContainer.isPushingNotebook ? \"Pushing...\" : \"Push\"}\n        </Button>\n        <Button onClick={props.onClose}>{\"Cancel\"}</Button>\n      </DialogActions>\n    </Dialog>\n  );\n}\n","import React, { useState, useCallback, useEffect } from \"react\";\nimport { createStyles, makeStyles, Theme } from \"@material-ui/core/styles\";\nimport clsx from \"clsx\";\nimport { Note } from \"../lib/crossnote\";\nimport { CrossnoteContainer } from \"../containers/crossnote\";\nimport { useTranslation } from \"react-i18next\";\nimport {\n  Box,\n  Typography,\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogContentText,\n  DialogActions,\n  Button,\n  Tooltip,\n  TextField,\n  ButtonGroup,\n  IconButton\n} from \"@material-ui/core\";\nimport { Editor as CodeMirrorEditor } from \"codemirror\";\nimport {\n  RenameBox,\n  Delete,\n  FilePresentationBox,\n  Pencil,\n  CodeTags,\n  CloudUploadOutline,\n  CloudDownloadOutline,\n  Restore,\n  Fullscreen,\n  FullscreenExit,\n  ChevronLeft\n} from \"mdi-material-ui\";\nimport { renderPreview } from \"vickymd/preview\";\nimport PushNotebookDialog from \"./PushNotebookDialog\";\nimport Noty from \"noty\";\n\nconst VickyMD = require(\"vickymd\");\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    editorPanel: {\n      width: \"100%\",\n      height: \"100%\",\n      display: \"flex\",\n      flexDirection: \"column\"\n    },\n    topPanel: {\n      position: \"relative\",\n      padding: theme.spacing(0.5, 1), // theme.spacing(0.5, 1),\n      display: \"flex\",\n      alignItems: \"center\",\n      justifyContent: \"space-between\",\n      borderBottom: \"1px solid #eee\",\n      overflow: \"auto\"\n    },\n    bottomPanel: {\n      position: \"relative\",\n      padding: theme.spacing(0.5, 1),\n      display: \"flex\",\n      alignItems: \"center\",\n      justifyContent: \"space-between\",\n      borderTop: \"1px solid #eee\"\n      // color: theme.palette.primary.contrastText,\n      // backgroundColor: theme.palette.primary.main\n    },\n    controlBtn: {\n      padding: theme.spacing(0.5, 0),\n      color: theme.palette.text.secondary\n    },\n    controlBtnSelected: {\n      color: theme.palette.primary.main\n    },\n    row: {\n      display: \"flex\",\n      flexDirection: \"row\",\n      alignItems: \"center\"\n    },\n    cursorPositionInfo: {\n      // position: \"absolute\",\n      // right: \"16px\",\n      // bottom: \"16px\",\n      zIndex: 150\n    },\n    editorWrapper: {\n      //     display: \"contents\",\n      flex: 1,\n      overflow: \"auto\",\n      \"& .CodeMirror-gutters\": {\n        display: \"none\"\n      },\n      \"& .CodeMirror-code\": {\n        width: \"100%\"\n      },\n      \"& .CodeMirror\": {\n        height: \"100%\",\n        padding: theme.spacing(0, 2),\n        [theme.breakpoints.down(\"sm\")]: {\n          padding: theme.spacing(0)\n        }\n      },\n      \"& .CodeMirror-vscrollbar\": {\n        display: \"none !important\"\n      }\n    },\n    fullScreen: {\n      position: \"fixed\",\n      width: \"100%\",\n      height: \"100%\",\n      left: \"0\",\n      top: \"0\",\n      zIndex: 2000,\n      overflow: \"auto\"\n    },\n    editor: {\n      width: \"100%\",\n      height: \"100%\"\n    },\n    preview: {\n      position: \"relative\",\n      left: \"0\",\n      top: \"0\",\n      width: \"100%\",\n      height: \"100%\",\n      border: \"none\",\n      overflow: \"auto !important\",\n      padding: theme.spacing(2),\n      zIndex: 99\n      // gridArea: \"2 / 2 / 3 / 3\"\n    },\n    backBtn: {\n      marginRight: \"8px\",\n      [theme.breakpoints.up(\"sm\")]: {\n        display: \"none\"\n      }\n    }\n  })\n);\n\nexport enum EditorMode {\n  VickyMD = \"VickyMD\",\n  SourceCode = \"SourceCode\",\n  Preview = \"Preview\"\n}\ninterface CursorPosition {\n  ch: number;\n  line: number;\n}\ninterface Props {\n  note: Note;\n}\nexport default function Editor(props: Props) {\n  const note = props.note;\n  const classes = useStyles(props);\n  const [textAreaElement, setTextAreaElement] = useState<HTMLTextAreaElement>(\n    null\n  );\n  const [editor, setEditor] = useState<CodeMirrorEditor>(null);\n  const [cursorPosition, setCursorPosition] = useState<CursorPosition>({\n    line: 0,\n    ch: 0\n  });\n  const [deleteDialogOpen, setDeleteDialogOpen] = useState<boolean>(false);\n  const [filePathDialogOpen, setFilePathDialogOpen] = useState<boolean>(false);\n  const [pushDialogOpen, setPushDialogOpen] = useState<boolean>(false);\n  const [newFilePath, setNewFilePath] = useState<string>(note.filePath);\n  const [editorMode, setEditorMode] = useState<EditorMode>(EditorMode.VickyMD);\n  const [previewElement, setPreviewElement] = useState<HTMLElement>(null);\n  const [gitStatus, setGitStatus] = useState<string>(\"\");\n  const [fullScreenMode, setFullScreenMode] = useState<boolean>(false);\n  const crossnoteContainer = CrossnoteContainer.useContainer();\n  const { t } = useTranslation();\n\n  const closeFilePathDialog = useCallback(() => {\n    setFilePathDialogOpen(false);\n    setNewFilePath(note.filePath);\n  }, [note]);\n\n  const changeFilePath = useCallback(\n    (newFilePath: string) => {\n      (async () => {\n        newFilePath = newFilePath.replace(/^\\/+/, \"\");\n        if (!newFilePath.endsWith(\".md\")) {\n          newFilePath = newFilePath + \".md\";\n        }\n        if (note.filePath !== newFilePath) {\n          await crossnoteContainer.changeNoteFilePath(note, newFilePath);\n        }\n        setNewFilePath(newFilePath);\n        setFilePathDialogOpen(false);\n      })();\n    },\n    [note, closeFilePathDialog]\n  );\n\n  const pullNotebook = useCallback(() => {\n    new Noty({\n      type: \"info\",\n      text: \"Pulling notebook...\",\n      layout: \"topRight\",\n      theme: \"relax\",\n      timeout: 2000\n    }).show();\n    crossnoteContainer\n      .pullNotebook({\n        notebook: note.notebook,\n        onAuthFailure: () => {\n          new Noty({\n            type: \"error\",\n            text: \"Authentication failed\",\n            layout: \"topRight\",\n            theme: \"relax\",\n            timeout: 5000\n          }).show();\n        }\n      })\n      .then(() => {\n        new Noty({\n          type: \"success\",\n          text: \"Notebook pulled\",\n          layout: \"topRight\",\n          theme: \"relax\",\n          timeout: 2000\n        }).show();\n      })\n      .catch(error => {\n        console.log(error);\n        new Noty({\n          type: \"error\",\n          text: \"Failed to pull notebook\",\n          layout: \"topRight\",\n          theme: \"relax\",\n          timeout: 2000\n        }).show();\n      });\n  }, [note]);\n\n  const checkoutNote = useCallback(() => {\n    crossnoteContainer.checkoutNote(note);\n  }, [note]);\n\n  useEffect(() => {\n    setNewFilePath(note.filePath);\n  }, [note.filePath]);\n\n  useEffect(() => {\n    crossnoteContainer.crossnote.getStatus(note).then(status => {\n      setGitStatus(status);\n    });\n  }, [note]);\n\n  useEffect(() => {\n    if (!crossnoteContainer.displayMobileEditor) {\n      setEditor(null);\n    }\n  }, [crossnoteContainer.displayMobileEditor]);\n\n  useEffect(() => {\n    if (textAreaElement && !editor) {\n      // console.log(\"textarea element mounted\");\n      const editor: CodeMirrorEditor = VickyMD.fromTextArea(textAreaElement, {\n        mode: {\n          name: \"hypermd\",\n          hashtag: true\n        },\n        inputStyle: \"textarea\"\n      });\n      editor.setOption(\"lineNumbers\", false);\n      editor.setOption(\"foldGutter\", false);\n      // editor.setOption(\"readOnly\", false);\n      editor.setValue(note.markdown || \"\");\n      // crossnoteContainer.setEditor(editor);\n      editor.on(\"cursorActivity\", instance => {\n        const cursor = instance.getCursor();\n        if (cursor) {\n          setCursorPosition({\n            line: cursor.line,\n            ch: cursor.ch\n          });\n        }\n      });\n      setEditor(editor);\n    }\n  }, [textAreaElement, note, editor]);\n\n  useEffect(() => {\n    if (editor && note) {\n      editor.setValue(note.markdown);\n      const handler = () => {\n        const markdown = editor.getValue();\n        crossnoteContainer.updateNoteMarkdown(note, markdown, status => {\n          setGitStatus(status);\n        });\n      };\n      editor.on(\"changes\", handler);\n      return () => {\n        editor.off(\"changes\", handler);\n      };\n    }\n  }, [editor, note]);\n\n  useEffect(() => {\n    if (!editor) return;\n    if (editorMode === EditorMode.VickyMD) {\n      VickyMD.switchToHyperMD(editor);\n      editor.getWrapperElement().style.display = \"block\";\n    } else if (editorMode === EditorMode.SourceCode) {\n      VickyMD.switchToNormal(editor);\n      editor.getWrapperElement().style.display = \"block\";\n    } else {\n      editor.getWrapperElement().style.display = \"none\";\n    }\n  }, [editorMode, editor, note]);\n\n  useEffect(() => {\n    if (editorMode === EditorMode.Preview && editor && previewElement) {\n      renderPreview(previewElement, editor.getValue());\n      if (\n        previewElement.childElementCount &&\n        previewElement.children[0].tagName.toUpperCase() === \"IFRAME\"\n      ) {\n        // presentation\n        previewElement.style.maxWidth = \"100%\";\n        previewElement.style.height = \"100%\";\n        previewElement.style.overflow = \"hidden !important\";\n      } else {\n        // normal\n        // previewElement.style.maxWidth = `${EditorPreviewMaxWidth}px`;\n        previewElement.style.height = \"auto\";\n        previewElement.style.overflow = \"hidden !important\";\n      }\n    }\n  }, [editorMode, editor, previewElement, note]);\n\n  return (\n    <Box className={clsx(classes.editorPanel)}>\n      <Box className={clsx(classes.topPanel)}>\n        <Box className={clsx(classes.row)}>\n          <ButtonGroup className={clsx(classes.backBtn)}>\n            <Button\n              className={clsx(classes.controlBtn)}\n              onClick={() => {\n                crossnoteContainer.setDisplayMobileEditor(false);\n              }}\n            >\n              <ChevronLeft></ChevronLeft>\n            </Button>\n          </ButtonGroup>\n          <ButtonGroup\n            variant={\"outlined\"}\n            color=\"default\"\n            aria-label=\"editor mode\"\n          >\n            <Tooltip title={t(\"general/vickymd\")}>\n              <Button\n                className={clsx(\n                  classes.controlBtn,\n                  editorMode === EditorMode.VickyMD &&\n                    classes.controlBtnSelected\n                )}\n                color={\n                  editorMode === EditorMode.VickyMD ? \"primary\" : \"default\"\n                }\n                onClick={() => setEditorMode(EditorMode.VickyMD)}\n              >\n                <Pencil></Pencil>\n              </Button>\n            </Tooltip>\n            <Tooltip title={t(\"editor/note-control/source-code\")}>\n              <Button\n                className={clsx(\n                  classes.controlBtn,\n                  editorMode === EditorMode.SourceCode &&\n                    classes.controlBtnSelected\n                )}\n                color={\n                  editorMode === EditorMode.SourceCode ? \"primary\" : \"default\"\n                }\n                onClick={() => setEditorMode(EditorMode.SourceCode)}\n              >\n                <CodeTags></CodeTags>\n              </Button>\n            </Tooltip>\n            <Tooltip title={t(\"editor/note-control/preview\")}>\n              <Button\n                className={clsx(\n                  classes.controlBtn,\n                  editorMode === EditorMode.Preview &&\n                    classes.controlBtnSelected\n                )}\n                color={\n                  editorMode === EditorMode.Preview ? \"primary\" : \"default\"\n                }\n                onClick={() => setEditorMode(EditorMode.Preview)}\n              >\n                <FilePresentationBox></FilePresentationBox>\n              </Button>\n            </Tooltip>\n          </ButtonGroup>\n          <ButtonGroup style={{ marginLeft: \"8px\" }}>\n            <Tooltip title={\"Fullscreen\"}>\n              <Button\n                className={clsx(classes.controlBtn)}\n                onClick={() => setFullScreenMode(true)}\n              >\n                <Fullscreen></Fullscreen>\n              </Button>\n            </Tooltip>\n          </ButtonGroup>\n          <ButtonGroup style={{ marginLeft: \"8px\" }}>\n            <Tooltip title={\"Change file path\"}>\n              <Button\n                className={clsx(classes.controlBtn)}\n                onClick={() => setFilePathDialogOpen(true)}\n              >\n                <RenameBox></RenameBox>\n              </Button>\n            </Tooltip>\n            <Tooltip title={\"Restore (checkout)\"}>\n              <Button\n                className={clsx(classes.controlBtn)}\n                onClick={checkoutNote}\n              >\n                <Restore></Restore>\n              </Button>\n            </Tooltip>\n            <Tooltip title={\"Delete file\"}>\n              <Button\n                className={clsx(classes.controlBtn)}\n                onClick={() => setDeleteDialogOpen(true)}\n              >\n                <Delete></Delete>\n              </Button>\n            </Tooltip>\n          </ButtonGroup>\n          {note.notebook.gitURL && ( // If no git url set, then don't allow push/pull\n            <ButtonGroup style={{ marginLeft: \"8px\" }}>\n              <Tooltip title={\"Push\"}>\n                <Button\n                  className={clsx(classes.controlBtn)}\n                  onClick={() => setPushDialogOpen(true)}\n                >\n                  <CloudUploadOutline></CloudUploadOutline>\n                </Button>\n              </Tooltip>\n              <Tooltip title={\"Pull\"}>\n                <Button\n                  className={clsx(classes.controlBtn)}\n                  onClick={pullNotebook}\n                  disabled={crossnoteContainer.isPullingNotebook}\n                >\n                  <CloudDownloadOutline></CloudDownloadOutline>\n                </Button>\n              </Tooltip>\n            </ButtonGroup>\n          )}\n        </Box>\n      </Box>\n      <Box\n        className={clsx(\n          classes.editorWrapper,\n          fullScreenMode ? classes.fullScreen : null\n        )}\n      >\n        <textarea\n          className={clsx(classes.editor, \"editor-textarea\")}\n          placeholder={\"#  Hi 😀\"}\n          ref={(element: HTMLTextAreaElement) => {\n            setTextAreaElement(element);\n          }}\n        ></textarea>\n        {editorMode === EditorMode.Preview &&\n        /*!editorContainer.pinPreviewOnTheSide &&*/\n        editor ? (\n          <div\n            className={clsx(classes.preview, \"preview\")}\n            id=\"preview\"\n            ref={(element: HTMLElement) => {\n              setPreviewElement(element);\n            }}\n          ></div>\n        ) : null}\n        {fullScreenMode && (\n          <IconButton\n            style={{\n              position: \"fixed\",\n              right: \"0\",\n              top: \"0\",\n              zIndex: 2001\n            }}\n            onClick={() => setFullScreenMode(false)}\n          >\n            <FullscreenExit></FullscreenExit>\n          </IconButton>\n        )}\n      </Box>\n      <Box className={clsx(classes.bottomPanel)}>\n        <Box className={clsx(classes.row)}>\n          <Typography\n            variant={\"caption\"}\n            style={{ cursor: \"pointer\" }}\n            onClick={() => {\n              setFilePathDialogOpen(true);\n            }}\n          >\n            {note.filePath}\n          </Typography>\n          <Typography variant={\"caption\"} style={{ marginLeft: \"4px\" }}>\n            {\"- \" + gitStatus}\n          </Typography>\n        </Box>\n        <Box className={clsx(classes.cursorPositionInfo)}>\n          <Typography variant={\"caption\"}>\n            {`Ln ${cursorPosition.line + 1}, Col ${cursorPosition.ch}`}\n          </Typography>\n        </Box>\n      </Box>\n      <Dialog\n        open={deleteDialogOpen}\n        onClose={() => setDeleteDialogOpen(false)}\n      >\n        <DialogTitle>Are you sure to delete this file?</DialogTitle>\n        <DialogContent>\n          <DialogContentText>Can't be undone</DialogContentText>\n        </DialogContent>\n        <DialogActions>\n          <Button\n            style={{ color: \"red\" }}\n            onClick={() => {\n              crossnoteContainer.deleteNote(note);\n              setDeleteDialogOpen(false);\n            }}\n          >\n            Delete\n          </Button>\n          <Button onClick={() => setDeleteDialogOpen(false)}>Cancel</Button>\n        </DialogActions>\n      </Dialog>\n      <Dialog open={filePathDialogOpen} onClose={closeFilePathDialog}>\n        <DialogTitle>Change file path</DialogTitle>\n        <DialogContent>\n          <TextField\n            value={newFilePath}\n            autoFocus={true}\n            onChange={event => setNewFilePath(event.target.value)}\n            onKeyUp={event => {\n              if (event.which === 13) {\n                changeFilePath(newFilePath);\n              }\n            }}\n          ></TextField>\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={() => changeFilePath(newFilePath)}>Save</Button>\n          <Button onClick={closeFilePathDialog}>Cancel</Button>\n        </DialogActions>\n      </Dialog>\n      <PushNotebookDialog\n        open={pushDialogOpen}\n        onClose={() => setPushDialogOpen(false)}\n        notebook={note.notebook}\n      ></PushNotebookDialog>\n    </Box>\n  );\n}\n","import React, { useState, useCallback } from \"react\";\nimport {\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  TextField,\n  Box,\n  Typography,\n  DialogActions,\n  Button,\n  Link,\n  FormControlLabel,\n  Checkbox,\n  ExpansionPanel,\n  ExpansionPanelDetails,\n  ExpansionPanelSummary\n} from \"@material-ui/core\";\nimport { ChevronDown } from \"mdi-material-ui\";\nimport { CrossnoteContainer } from \"../containers/crossnote\";\nimport Noty from \"noty\";\n\ninterface Props {\n  open: boolean;\n  onClose: () => void;\n  canCancel: boolean;\n}\n\nexport default function AddNotebookDialog(props: Props) {\n  const crossnoteContainer = CrossnoteContainer.useContainer();\n  const [notebookName, setNotebookName] = useState<string>(\"\");\n  const [expanded, setExpanded] = useState<boolean>(false);\n  const [gitURL, setGitURL] = useState<string>(\"\");\n  const [gitBranch, setGitBranch] = useState<string>(\"\");\n  const [gitUsername, setGitUsername] = useState<string>(\"\");\n  const [gitPassword, setGitPassword] = useState<string>(\"\");\n  const [gitCorsProxy, setGitCorsProxy] = useState<string>(\n    \"https://cors.isomorphic-git.org\"\n  );\n  const [rememberCredentialsChecked, setRememberCredentialsChecked] = useState<\n    boolean\n  >(false);\n\n  const addNotebook = useCallback(async () => {\n    try {\n      new Noty({\n        type: \"info\",\n        text: \"Getting notebook...\",\n        layout: \"topRight\",\n        theme: \"relax\",\n        timeout: 2000\n      }).show();\n      await crossnoteContainer.addNotebook(\n        notebookName,\n        gitURL,\n        gitBranch,\n        gitUsername,\n        gitPassword,\n        rememberCredentialsChecked,\n        gitCorsProxy\n      );\n      props.onClose();\n    } catch (error) {\n      new Noty({\n        type: \"error\",\n        text: \"Failed to get notebook...\",\n        layout: \"topRight\",\n        theme: \"relax\",\n        timeout: 2000\n      }).show();\n      props.onClose();\n    }\n  }, [\n    props,\n    notebookName,\n    gitURL,\n    gitBranch,\n    gitUsername,\n    gitPassword,\n    rememberCredentialsChecked,\n    gitCorsProxy\n  ]);\n\n  return (\n    <Dialog\n      open={props.open}\n      onClose={() => {\n        if (!crossnoteContainer.isAddingNotebook) {\n          props.onClose();\n        }\n      }}\n    >\n      <DialogTitle>Add a notebook</DialogTitle>\n      <DialogContent>\n        <TextField\n          label={\"Notebook name\"}\n          value={notebookName}\n          fullWidth={true}\n          onChange={event => {\n            setNotebookName(event.target.value);\n          }}\n          style={{ marginBottom: \"16px\" }}\n        ></TextField>\n        <ExpansionPanel\n          elevation={2}\n          expanded={expanded}\n          onChange={() => setExpanded(!expanded)}\n        >\n          <ExpansionPanelSummary expandIcon={<ChevronDown></ChevronDown>}>\n            <Typography>{\"Git repository (optional)\"}</Typography>\n          </ExpansionPanelSummary>\n          <ExpansionPanelDetails>\n            <Box>\n              <TextField\n                label={\"url\"}\n                placeholder={\"https://abc/def.git\"}\n                fullWidth={true}\n                value={gitURL}\n                onChange={event => setGitURL(event.target.value)}\n              ></TextField>\n              <TextField\n                label={\"branch\"}\n                placeholder={\"master\"}\n                fullWidth={true}\n                value={gitBranch}\n                onChange={event => setGitBranch(event.target.value)}\n              ></TextField>\n              <TextField\n                label={\"username (optional)\"}\n                placeholder={\"username (optional)\"}\n                fullWidth={true}\n                value={gitUsername}\n                onChange={event => setGitUsername(event.target.value)}\n              ></TextField>\n              <TextField\n                label={\"password (optional)\"}\n                placeholder={\"password (optional)\"}\n                type={\"password\"}\n                fullWidth={true}\n                value={gitPassword}\n                onChange={event => setGitPassword(event.target.value)}\n              ></TextField>\n              <FormControlLabel\n                control={\n                  <Checkbox\n                    checked={rememberCredentialsChecked}\n                    onChange={() =>\n                      setRememberCredentialsChecked(!rememberCredentialsChecked)\n                    }\n                    value={rememberCredentialsChecked}\n                  />\n                }\n                label={\n                  <Typography>\n                    {\"Remember credentials\" +\n                      \" \" +\n                      (rememberCredentialsChecked ? \"(stored locally)\" : \"\")}\n                  </Typography>\n                }\n              />\n              <TextField\n                label={\"cors proxy\"}\n                placeholder={\"https://cors.isomorphic-git.org\"}\n                fullWidth={true}\n                value={gitCorsProxy}\n                onChange={event => setGitCorsProxy(event.target.value)}\n              ></TextField>\n              <Link\n                href={\n                  \"https://github.com/isomorphic-git/isomorphic-git#cors-support\"\n                }\n                target={\"_blank\"}\n              >\n                Why we need cors proxy?\n              </Link>\n            </Box>\n          </ExpansionPanelDetails>\n        </ExpansionPanel>\n      </DialogContent>\n      <DialogActions>\n        <Button\n          variant={\"contained\"}\n          color={\"primary\"}\n          onClick={addNotebook}\n          disabled={crossnoteContainer.isAddingNotebook}\n        >\n          {crossnoteContainer.isAddingNotebook ? \"Adding...\" : \"Add\"}\n        </Button>\n        {props.canCancel && <Button onClick={props.onClose}>{\"Cancel\"}</Button>}\n      </DialogActions>\n    </Dialog>\n  );\n}\n","import { TreeView, TreeItem } from \"@material-ui/lab\";\nimport { createStyles, makeStyles, Theme } from \"@material-ui/core/styles\";\nimport clsx from \"clsx\";\nimport React, { useState, useCallback, useEffect } from \"react\";\nimport { IconButton, Box, Typography } from \"@material-ui/core\";\nimport { ChevronRight, ChevronDown } from \"mdi-material-ui\";\nimport { CrossnoteContainer } from \"../containers/crossnote\";\nimport { useTranslation } from \"react-i18next\";\nimport { Directory, Notebook } from \"../lib/crossnote\";\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    treeItemRoot: {\n      paddingLeft: \"4px\",\n      // color: theme.palette.text.secondary,\n      \"&:focus > $treeItemContent\": {\n        color: \"#1a73e8\",\n        backgroundColor: \"#e8f0fe\" //theme.palette.primary.main\n        // backgroundColor: `var(--tree-view-bg-color, ${theme.palette.grey[400]})`,\n        // color: \"var(--tree-view-color)\"\n      },\n      \"&:focus > $treeItemLabelIcon\": {\n        color: \"#1a73e8\"\n      }\n    },\n    treeItemContent: {\n      cursor: \"default\",\n      color: theme.palette.text.primary,\n      paddingLeft: theme.spacing(1),\n      paddingRight: theme.spacing(1),\n      userSelect: \"none\",\n      fontWeight: theme.typography.fontWeightMedium,\n      \"$treeItemExpanded > &\": {\n        fontWeight: theme.typography.fontWeightRegular\n      }\n    },\n    treeItemGroup: {\n      marginLeft: 0,\n      \"& $treeItemContent\": {\n        paddingLeft: theme.spacing(2)\n      }\n    },\n    treeItemExpanded: {},\n    treeItemLabel: {\n      fontWeight: \"inherit\",\n      color: \"inherit\"\n    },\n    treeItemLabelRoot: {\n      display: \"flex\",\n      alignItems: \"center\",\n      padding: theme.spacing(1, 0)\n    },\n    treeItemLabelIcon: {\n      color: \"rgba(0, 0, 0, 0.54)\"\n    },\n    treeItemLabelText: {\n      paddingLeft: \"12px\",\n      flexGrow: 1\n    }\n  })\n);\n\ninterface Props {\n  notebook: Notebook;\n}\nexport default function NotebookTreeView(props: Props) {\n  const classes = useStyles();\n  const crossnoteContainer = CrossnoteContainer.useContainer();\n\n  const [expanded, setExpanded] = useState<string[]>([]);\n  const handleChange = useCallback(\n    (event: React.ChangeEvent<{}>, nodes: string[]) => {\n      event.stopPropagation();\n      const element = event.target as HTMLElement;\n      if (\n        element &&\n        element.tagName &&\n        element.tagName.toUpperCase().match(/^(SVG|PATH|BUTTON)$/)\n      ) {\n        crossnoteContainer.setSelectedNotebook(props.notebook);\n        setExpanded(nodes);\n      }\n    },\n    [props.notebook]\n  );\n\n  const constructDirectoryTreeItems: (directory: Directory) => any = (\n    directory: Directory\n  ) => {\n    if (directory.name === \".\") {\n      return (\n        <>{directory.children.map(dir => constructDirectoryTreeItems(dir))}</>\n      );\n    } else {\n      return (\n        <TreeItem\n          nodeId={directory.name}\n          classes={{\n            root: classes.treeItemRoot,\n            content: classes.treeItemContent,\n            expanded: classes.treeItemExpanded,\n            group: classes.treeItemGroup,\n            label: classes.treeItemLabel\n          }}\n          endIcon={<div style={{ width: 24 }}></div>}\n          key={directory.name}\n          label={\n            <Box\n              onClick={() => {\n                crossnoteContainer.setSelectedDir(directory.path);\n              }}\n              className={clsx(classes.treeItemLabelRoot)}\n            >\n              <span role=\"img\" aria-label=\"folder\">\n                {\"📁\"}\n              </span>\n              <Typography\n                color={\"inherit\"}\n                variant={\"body1\"}\n                className={clsx(classes.treeItemLabelText)}\n              >\n                {directory.name}\n              </Typography>\n            </Box>\n          }\n        >\n          {directory.children.map(dir => constructDirectoryTreeItems(dir))}\n        </TreeItem>\n      );\n    }\n  };\n\n  useEffect(() => {\n    if (crossnoteContainer.selectedNotebook !== props.notebook) {\n      setExpanded([]);\n    }\n  }, [crossnoteContainer.selectedNotebook, props.notebook]);\n\n  return (\n    <TreeView\n      defaultExpandIcon={\n        <IconButton\n          disableFocusRipple={true}\n          disableRipple={true}\n          size={\"medium\"}\n        >\n          <ChevronRight></ChevronRight>\n        </IconButton>\n      }\n      defaultCollapseIcon={\n        <IconButton\n          disableFocusRipple={true}\n          disableRipple={true}\n          size={\"medium\"}\n        >\n          <ChevronDown></ChevronDown>\n        </IconButton>\n      }\n      defaultEndIcon={<div style={{ width: 24 }} />}\n      expanded={expanded}\n      onNodeToggle={handleChange}\n      style={{ width: \"100%\" }}\n    >\n      <TreeItem\n        nodeId={\"notes\"}\n        classes={{\n          root: classes.treeItemRoot,\n          content: classes.treeItemContent,\n          expanded: classes.treeItemExpanded,\n          group: classes.treeItemGroup,\n          label: classes.treeItemLabel\n        }}\n        label={\n          <Box\n            onClick={() => {\n              crossnoteContainer.setSelectedNotebook(props.notebook);\n              crossnoteContainer.setSelectedDir(\"$notes\");\n            }}\n            className={clsx(classes.treeItemLabelRoot)}\n          >\n            {/*\n            <span role=\"img\" aria-label=\"notes\">\n              📒\n          </span>*/}\n            <Typography\n              color={\"inherit\"}\n              variant={\"body1\"}\n              className={clsx(classes.treeItemLabelText)}\n            >\n              {props.notebook.name}\n            </Typography>\n          </Box>\n        }\n      >\n        {/*\n        <TreeItem\n          nodeId={\"today-notes\"}\n          classes={{\n            root: classes.treeItemRoot,\n            content: classes.treeItemContent,\n            expanded: classes.treeItemExpanded,\n            group: classes.treeItemGroup,\n            label: classes.treeItemLabel\n          }}\n          label={\n            <Box\n              onClick={() => {\n                crossnoteContainer.setSelectedDir(\"$today\");\n              }}\n              className={clsx(classes.treeItemLabelRoot)}\n            >\n              <span role=\"img\" aria-label=\"today-notes\">\n                🗓\n              </span>\n              <Typography className={clsx(classes.treeItemLabelText)}>\n                {\"today\"}\n              </Typography>\n            </Box>\n          }\n        ></TreeItem>\n        <TreeItem\n          nodeId={\"todo-notes\"}\n          classes={{\n            root: classes.treeItemRoot,\n            content: classes.treeItemContent,\n            expanded: classes.treeItemExpanded,\n            group: classes.treeItemGroup,\n            label: classes.treeItemLabel\n          }}\n          label={\n            <Box\n              onClick={() => {\n                crossnoteContainer.setSelectedDir(\"$todo\");\n              }}\n              className={clsx(classes.treeItemLabelRoot)}\n            >\n              <span role=\"img\" aria-label=\"todo-notes\">\n                ☑️\n              </span>\n              <Typography className={clsx(classes.treeItemLabelText)}>\n                {\"todo\"}\n              </Typography>\n            </Box>\n          }\n        ></TreeItem>*/}\n        {constructDirectoryTreeItems(crossnoteContainer.notebookDirectories)}\n      </TreeItem>\n    </TreeView>\n  );\n}\n","import {\n  Box,\n  CssBaseline,\n  Drawer,\n  Hidden,\n  List,\n  ListItem,\n  IconButton,\n  Paper,\n  Typography\n} from \"@material-ui/core\";\nimport {\n  fade,\n  createStyles,\n  makeStyles,\n  Theme\n} from \"@material-ui/core/styles\";\nimport clsx from \"clsx\";\nimport React, { useState, useCallback } from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport { PlusCircle } from \"mdi-material-ui\";\nimport { CrossnoteContainer } from \"../containers/crossnote\";\nimport Notes from \"../components/Notes\";\nimport Editor from \"../components/Editor\";\nimport AddNotebookDialog from \"../components/AddNotebookDialog\";\nimport NotebookTreeView from \"../components/NotebookTreeView\";\n\nconst drawerWidth = 200;\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    page: {\n      display: \"flex\",\n      width: \"100%\",\n      height: \"100%\",\n      backgroundColor: \"#2196F1\"\n    },\n    appBar: {\n      zIndex: theme.zIndex.drawer + 1,\n      boxShadow: \"none\"\n    },\n    toolBar: {\n      display: \"flex\",\n      flexDirection: \"row\",\n      justifyContent: \"space-between\"\n    },\n    search: {\n      position: \"relative\",\n      borderRadius: theme.shape.borderRadius,\n      backgroundColor: fade(theme.palette.common.white, 0.15),\n      \"&:hover\": {\n        backgroundColor: fade(theme.palette.common.white, 0.25)\n      },\n      marginRight: theme.spacing(2),\n      marginLeft: 0,\n      width: \"100%\",\n      [theme.breakpoints.up(\"sm\")]: {\n        marginLeft: theme.spacing(3),\n        width: \"auto\"\n      }\n    },\n    searchIcon: {\n      width: theme.spacing(7),\n      height: \"100%\",\n      position: \"absolute\",\n      pointerEvents: \"none\",\n      display: \"flex\",\n      alignItems: \"center\",\n      justifyContent: \"center\"\n    },\n    inputRoot: {\n      color: \"inherit\"\n    },\n    inputInput: {\n      padding: theme.spacing(1, 1, 1, 7),\n      transition: theme.transitions.create(\"width\"),\n      width: \"100%\",\n      [theme.breakpoints.up(\"md\")]: {\n        width: 200\n      }\n    },\n    displayNone: {\n      display: \"none\"\n    },\n    drawer: {\n      [theme.breakpoints.up(\"sm\")]: {\n        width: drawerWidth,\n        flexShrink: 0\n      }\n    },\n    drawerPaper: {\n      width: drawerWidth\n      // backgroundColor: \"#2196f1\",\n      // color: \"#fff\"\n    },\n    selectedSection: {\n      backgroundColor: \"#ccc\"\n    },\n    left: {\n      display: \"flex\",\n      flexDirection: \"row\",\n      alignItems: \"center\"\n    },\n    menuButton: {\n      marginRight: theme.spacing(2)\n      /*\n      [theme.breakpoints.up(\"sm\")]: {\n        display: \"none\"\n      }\n      */\n    },\n    mainPanel: {\n      position: \"relative\",\n      display: \"flex\",\n      flexDirection: \"row\",\n      flexGrow: 1,\n      overflow: \"auto\",\n      backgroundColor: \"#eee\"\n    },\n    notesPanel: {\n      width: \"350px\",\n      maxWidth: \"100%\",\n      height: \"100%\",\n      [theme.breakpoints.down(\"xs\")]: {\n        width: \"100%\"\n      }\n    },\n    editorPanel: {\n      flex: \"1\",\n      [theme.breakpoints.down(\"xs\")]: {\n        display: \"none\",\n        position: \"absolute\",\n        top: \"0\",\n        left: \"0\",\n        width: \"100%\",\n        height: \"100%\"\n      }\n    },\n    toolBarSpace: theme.mixins.toolbar\n  })\n);\n\ninterface Props {}\n\nexport function Home(props: Props) {\n  const classes = useStyles(props);\n  const crossnoteContainer = CrossnoteContainer.useContainer();\n\n  const [addNotebookDialogOpen, setAddNotebookDialogOpen] = useState<boolean>(\n    false\n  );\n  const [drawerOpen, setDrawerOpen] = useState<boolean>(false);\n\n  const toggleDrawer = useCallback(() => {\n    setDrawerOpen(!drawerOpen);\n  }, [drawerOpen]);\n\n  const drawer = (\n    <div>\n      <List disablePadding={true}>\n        <ListItem disableGutters={true}>\n          <Box\n            style={{\n              width: \"100%\",\n              display: \"flex\",\n              flexDirection: \"row\",\n              alignItems: \"center\",\n              justifyContent: \"center\",\n              padding: \"0 8px\"\n            }}\n          >\n            <Typography variant={\"body1\"} style={{ fontWeight: \"bold\" }}>\n              {\"Notebooks\"}\n            </Typography>\n            <IconButton onClick={() => setAddNotebookDialogOpen(true)}>\n              <PlusCircle></PlusCircle>\n            </IconButton>\n          </Box>\n        </ListItem>\n        {crossnoteContainer.notebooks.map(notebook => {\n          return (\n            <ListItem\n              disableGutters={true}\n              style={{ padding: \"0\" }}\n              key={notebook._id}\n            >\n              <NotebookTreeView notebook={notebook}></NotebookTreeView>\n            </ListItem>\n          );\n        })}\n      </List>\n    </div>\n  );\n\n  const notesPanel = (\n    <Paper className={clsx(classes.notesPanel)}>\n      <Notes toggleDrawer={toggleDrawer}></Notes>\n    </Paper>\n  );\n\n  return (\n    <Box className={clsx(classes.page)}>\n      <CssBaseline></CssBaseline>\n      <nav className={classes.drawer}>\n        {/* The implementation can be swapped with js to avoid SEO duplication of links. */}\n        <Hidden smUp implementation=\"css\">\n          <Drawer\n            variant=\"temporary\"\n            open={drawerOpen}\n            onClose={toggleDrawer}\n            classes={{\n              paper: classes.drawerPaper\n            }}\n            ModalProps={{\n              keepMounted: true // Better open performance on mobile.\n            }}\n          >\n            {drawer}\n          </Drawer>\n        </Hidden>\n        <Hidden xsDown implementation=\"css\">\n          <Drawer\n            classes={{\n              paper: classes.drawerPaper\n            }}\n            variant=\"permanent\"\n            open\n          >\n            {drawer}\n          </Drawer>\n        </Hidden>\n      </nav>\n      <Box className={clsx(classes.mainPanel)} id=\"main-panel\">\n        {notesPanel}\n        <Paper\n          className={clsx(classes.editorPanel)}\n          style={{ display: crossnoteContainer.displayMobileEditor && \"block\" }}\n        >\n          {crossnoteContainer.selectedNote && (\n            <Editor note={crossnoteContainer.selectedNote}></Editor>\n          )}\n        </Paper>\n      </Box>\n      <AddNotebookDialog\n        open={addNotebookDialogOpen}\n        onClose={() => setAddNotebookDialogOpen(false)}\n        canCancel={true}\n      ></AddNotebookDialog>\n    </Box>\n  );\n}\n","/**\n * Upload image to sm.ms\n * @param filePath\n */\nexport async function smmsUploadImages(files: File[] = []): Promise<string[]> {\n  const promises = [];\n  for (let i = 0; i < files.length; i++) {\n    const file = files[i];\n    if (!file.type.match(\"image.*\")) {\n      continue;\n    }\n    promises.push(\n      new Promise<string>((resolve, reject) => {\n        const headers = {\n          // \"Content-Type\": \"multipart/form-data\" // <= Adding this will cause problem.\n        };\n        const data = new FormData();\n        data.append(\"smfile\", file);\n        data.append(\"format\", \"json\");\n        fetch(\"https://sm.ms/api/v2/upload\", {\n          method: \"POST\",\n          mode: \"cors\",\n          headers,\n          referrer: \"\",\n          body: data\n        })\n          .then(response => response.json())\n          .then(json => {\n            if (json[\"success\"]) {\n              return resolve(json[\"data\"][\"url\"]);\n            } else if (\n              json[\"code\"] === \"image_repeated\" ||\n              (json[\"code\"] === \"exception\" &&\n                json[\"message\"].match(/this image exists at:/))\n            ) {\n              return resolve(json[\"message\"].match(/https:\\/\\/.+$/)[0]);\n            } else {\n              return reject(json[\"message\"]);\n            }\n          })\n          .catch(error => {\n            return reject(\"Failed to connect to sm.ms host\");\n          });\n      })\n    );\n  }\n  return await Promise.all(promises);\n}\n","import { WidgetCreator, WidgetArgs } from \"vickymd/widget\";\nimport React, { useState } from \"react\";\nimport ReactDOM from \"react-dom\";\nimport {\n  Card,\n  Typography,\n  IconButton,\n  Box,\n  Input,\n  Tooltip,\n  Switch,\n  FormControlLabel\n} from \"@material-ui/core\";\nimport { createStyles, makeStyles, Theme } from \"@material-ui/core/styles\";\nimport clsx from \"clsx\";\nimport { TrashCan } from \"mdi-material-ui\";\nimport { useTranslation } from \"react-i18next\";\nimport { smmsUploadImages } from \"../../utilities/image_uploader\";\nimport Noty from \"noty\";\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    card: {\n      padding: theme.spacing(2),\n      position: \"relative\"\n    },\n    actionButtons: {\n      position: \"absolute\",\n      top: \"0\",\n      right: \"0\"\n    },\n    section: {\n      marginTop: theme.spacing(2)\n    },\n    dropArea: {\n      textAlign: \"center\",\n      padding: \"24px\",\n      border: \"4px dotted #c7c7c7\",\n      backgroundColor: \"#f1f1f1\",\n      cursor: \"pointer\",\n      \"&:hover\": {\n        backgroundColor: \"#eee\"\n      }\n    },\n    disabled: {\n      cursor: \"not-allowed\"\n    }\n  })\n);\n\nfunction ImageWidget(props: WidgetArgs) {\n  const classes = useStyles(props);\n  const { t } = useTranslation();\n  const [link, setLink] = useState<string>(\"\");\n  const [asCover, setAsCover] = useState<boolean>(false);\n  const [imageUploaderElement, setImageUploaderElement] = useState<\n    HTMLInputElement\n  >(null);\n  const [uploadingImages, setUploadingImages] = useState<boolean>(false);\n\n  function clickDropArea(e: any) {\n    e.preventDefault();\n    e.stopPropagation();\n    if (!imageUploaderElement || uploadingImages) return;\n    imageUploaderElement.onchange = function(event) {\n      const target = event.target as any;\n      const files = target.files || [];\n      new Noty({\n        type: \"info\",\n        text: t(\"utils/uploading-image\"),\n        layout: \"topRight\",\n        theme: \"relax\",\n        timeout: 2000\n      }).show();\n      setUploadingImages(true);\n      smmsUploadImages(files)\n        .then(urls => {\n          let markdown = ``;\n          urls.forEach(url => {\n            markdown = markdown + `![${asCover ? \"cover\" : \"\"}](${url})  \\n`;\n          });\n          props.replaceSelf(markdown);\n        })\n        .catch((error: any) => {\n          // console.log(error);\n          setUploadingImages(false);\n          new Noty({\n            type: \"error\",\n            text: t(\"utils/upload-image-failure\"),\n            layout: \"topRight\",\n            theme: \"relax\",\n            timeout: 2000\n          }).show();\n        });\n    };\n    imageUploaderElement.click();\n  }\n\n  if (props.isPreview) {\n    return <span></span>;\n  }\n\n  return (\n    <Card elevation={2} className={clsx(classes.card)}>\n      <Typography variant={\"h5\"}>\n        {t(\"widget/crossnote.image/image-helper\")}\n      </Typography>\n      <Box className={clsx(classes.actionButtons)}>\n        <Tooltip title={t(\"general/Delete\")}>\n          <IconButton onClick={() => props.removeSelf()}>\n            <TrashCan></TrashCan>\n          </IconButton>\n        </Tooltip>\n      </Box>\n      {!uploadingImages && (\n        <Box className={clsx(classes.section)}>\n          <FormControlLabel\n            label={t(\"widget/crossnote.image/set-as-cover-image-in-note-card\")}\n            control={\n              <Switch\n                checked={asCover}\n                onChange={() => setAsCover(!asCover)}\n                color={\"primary\"}\n              ></Switch>\n            }\n          ></FormControlLabel>\n        </Box>\n      )}\n      {!uploadingImages && (\n        <Box className={clsx(classes.section)}>\n          <Typography variant={\"subtitle1\"} style={{ marginBottom: \"8px\" }}>\n            {t(\"general/Link\")}\n          </Typography>\n          <Input\n            margin={\"dense\"}\n            placeholder={t(\"widget/crossnote.image/image-url-placeholder\")}\n            value={link}\n            onChange={event => {\n              setLink(event.target.value);\n            }}\n            onKeyDown={event => {\n              if (event.which === 13) {\n                props.replaceSelf(`![${asCover ? \"cover\" : \"\"}](${link})\\n`);\n              }\n            }}\n            fullWidth={true}\n          ></Input>\n        </Box>\n      )}\n      <Box className={clsx(classes.section)}>\n        <Typography variant={\"subtitle1\"} style={{ marginBottom: \"8px\" }}>\n          {t(\"general/Upload\")}\n        </Typography>\n        <Box\n          className={clsx(\n            classes.dropArea,\n            uploadingImages ? classes.disabled : null\n          )}\n          onClick={clickDropArea}\n        >\n          <Typography>\n            {uploadingImages\n              ? t(\"utils/uploading-image\")\n              : t(\"widget/crossnote.image/click-here-to-browse-image-file\")}\n          </Typography>\n        </Box>\n      </Box>\n      <Box className={clsx(classes.section)}>\n        <Typography variant={\"caption\"}>\n          {t(\"widget/crossnote.image/thanks_sm_ms\")}\n        </Typography>\n      </Box>\n      <input\n        type=\"file\"\n        multiple\n        style={{ display: \"none\" }}\n        ref={(element: HTMLInputElement) => {\n          setImageUploaderElement(element);\n        }}\n      ></input>\n    </Card>\n  );\n}\n\nexport const ImageWidgetCreator: WidgetCreator = args => {\n  const el = document.createElement(\"span\");\n  ReactDOM.render(<ImageWidget {...args}></ImageWidget>, el);\n  return el;\n};\n","import { WidgetCreator, WidgetArgs } from \"vickymd/widget\";\nimport React, { useState } from \"react\";\nimport ReactDOM from \"react-dom\";\nimport {\n  Card,\n  Typography,\n  IconButton,\n  Box,\n  Input,\n  Tooltip,\n  Switch,\n  FormControlLabel\n} from \"@material-ui/core\";\nimport { createStyles, makeStyles, Theme } from \"@material-ui/core/styles\";\nimport clsx from \"clsx\";\nimport { TrashCan } from \"mdi-material-ui\";\nimport { useTranslation } from \"react-i18next\";\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    card: {\n      padding: theme.spacing(2),\n      position: \"relative\"\n    },\n    actionButtons: {\n      position: \"absolute\",\n      top: \"0\",\n      right: \"0\"\n    },\n    section: {\n      marginTop: theme.spacing(2)\n    },\n    dropArea: {\n      textAlign: \"center\",\n      padding: \"24px\",\n      border: \"4px dotted #c7c7c7\",\n      backgroundColor: \"#f1f1f1\",\n      cursor: \"pointer\",\n      \"&:hover\": {\n        backgroundColor: \"#eee\"\n      }\n    },\n    disabled: {\n      cursor: \"not-allowed\"\n    }\n  })\n);\n\nfunction AudioWidget(props: WidgetArgs) {\n  const attributes = props.attributes;\n  const classes = useStyles(props);\n  const { t } = useTranslation();\n  const [source, setSource] = useState<string>(attributes[\"source\"] || \"\");\n  const [autoplay, setAutoplay] = useState<boolean>(\n    attributes[\"autoplay\"] || false\n  );\n  const [controls, setControls] = useState<boolean>(\n    attributes[\"controls\"] || true\n  );\n  const [loop, setLoop] = useState<boolean>(attributes[\"loop\"] || false);\n  const [muted, setMuted] = useState<boolean>(attributes[\"muted\"] || false);\n\n  if (attributes[\"src\"]) {\n    return (\n      <span style={{ cursor: \"default\" }}>\n        <audio\n          autoPlay={attributes[\"autoplay\"] || attributes[\"autoPlay\"]}\n          controls={attributes[\"controls\"]}\n          loop={attributes[\"loop\"]}\n          muted={attributes[\"muted\"]}\n          style={attributes[\"style\"]}\n        >\n          {t(\"widget/crossnote.audio/audio_element_fail\")}\n          <source src={attributes[\"src\"]} type={attributes[\"type\"]}></source>\n        </audio>\n        {!props.isPreview && !attributes[\"controls\"] && \"🎵\"}\n      </span>\n    );\n  }\n\n  if (props.isPreview) {\n    return <span></span>;\n  }\n\n  return (\n    <Card elevation={2} className={clsx(classes.card)}>\n      <Typography variant={\"h5\"}>{t(\"general/Audio\")}</Typography>\n      <Box className={clsx(classes.actionButtons)}>\n        <Tooltip title={t(\"general/Delete\")}>\n          <IconButton onClick={() => props.removeSelf()}>\n            <TrashCan></TrashCan>\n          </IconButton>\n        </Tooltip>\n      </Box>\n      <Box className={clsx(classes.section)}>\n        <Typography variant={\"subtitle1\"} style={{ marginBottom: \"8px\" }}>\n          {t(\"general/source-url\")}\n        </Typography>\n        <Input\n          margin={\"dense\"}\n          placeholder={t(\"widget/crossnote.audio/source-url-placeholder\")}\n          value={source}\n          onChange={event => {\n            setSource(event.target.value);\n          }}\n          onKeyDown={event => {\n            if (event.which === 13) {\n              if (source) {\n                const attrs = {\n                  autoplay,\n                  controls,\n                  loop,\n                  muted,\n                  src: source\n                };\n                props.replaceSelf(\n                  `\\`@crossnote.audio ${JSON.stringify(attrs)\n                    .replace(/^{/, \"\")\n                    .replace(/}$/, \"\")}\\``\n                );\n              }\n            }\n          }}\n          fullWidth={true}\n        ></Input>\n      </Box>\n      <Box className={clsx(classes.section)}>\n        <FormControlLabel\n          label={t(\"widget/autoplay\")}\n          control={\n            <Switch\n              checked={autoplay}\n              onChange={() => setAutoplay(!autoplay)}\n              color={\"primary\"}\n            ></Switch>\n          }\n        ></FormControlLabel>\n        <FormControlLabel\n          label={t(\"widget/controls\")}\n          control={\n            <Switch\n              checked={controls}\n              onChange={() => setControls(!controls)}\n              color={\"primary\"}\n            ></Switch>\n          }\n        ></FormControlLabel>\n        <FormControlLabel\n          label={t(\"widget/loop\")}\n          control={\n            <Switch\n              checked={loop}\n              onChange={() => setLoop(!loop)}\n              color={\"primary\"}\n            ></Switch>\n          }\n        ></FormControlLabel>\n        <FormControlLabel\n          label={t(\"widget/muted\")}\n          control={\n            <Switch\n              checked={muted}\n              onChange={() => setMuted(!muted)}\n              color={\"primary\"}\n            ></Switch>\n          }\n        ></FormControlLabel>\n      </Box>\n    </Card>\n  );\n}\n\nexport const AudioWidgetCreator: WidgetCreator = args => {\n  const el = document.createElement(\"span\");\n  ReactDOM.render(<AudioWidget {...args}></AudioWidget>, el);\n  return el;\n};\n","import { WidgetCreator, WidgetArgs } from \"vickymd/widget\";\nimport React, { useState } from \"react\";\nimport ReactDOM from \"react-dom\";\nimport {\n  Card,\n  Typography,\n  IconButton,\n  Box,\n  Input,\n  Tooltip,\n  Switch,\n  FormControlLabel\n} from \"@material-ui/core\";\nimport { createStyles, makeStyles, Theme } from \"@material-ui/core/styles\";\nimport clsx from \"clsx\";\nimport { TrashCan } from \"mdi-material-ui\";\nimport { useTranslation } from \"react-i18next\";\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    card: {\n      padding: theme.spacing(2),\n      position: \"relative\"\n    },\n    actionButtons: {\n      position: \"absolute\",\n      top: \"0\",\n      right: \"0\"\n    },\n    section: {\n      marginTop: theme.spacing(2)\n    },\n    dropArea: {\n      textAlign: \"center\",\n      padding: \"24px\",\n      border: \"4px dotted #c7c7c7\",\n      backgroundColor: \"#f1f1f1\",\n      cursor: \"pointer\",\n      \"&:hover\": {\n        backgroundColor: \"#eee\"\n      }\n    },\n    disabled: {\n      cursor: \"not-allowed\"\n    }\n  })\n);\n\nfunction NeteaseMusicWidget(props: WidgetArgs) {\n  const attributes = props.attributes;\n  const classes = useStyles(props);\n  const { t } = useTranslation();\n  const [id, setID] = useState<string>(attributes[\"id\"] || \"\");\n  const [autoplay, setAutoplay] = useState<boolean>(\n    attributes[\"autoplay\"] || false\n  );\n\n  if (attributes[\"id\"]) {\n    return (\n      <iframe\n        title={\"netease_music_\" + attributes[\"id\"]}\n        style={{\n          maxWidth: \"100%\",\n          width: \"333px\",\n          height: \"86px\",\n          border: \"none\"\n        }}\n        src={`https://music.163.com/outchain/player?type=2&id=${\n          attributes[\"id\"]\n        }&auto=${attributes[\"autoplay\"] ? \"1\" : \"0\"}&height=66`}\n      ></iframe>\n    );\n  }\n\n  if (props.isPreview) {\n    return <span></span>;\n  }\n\n  return (\n    <Card elevation={2} className={clsx(classes.card)}>\n      <Typography variant={\"h5\"}>{t(\"general/Audio\")}</Typography>\n      <Box className={clsx(classes.actionButtons)}>\n        <Tooltip title={t(\"general/Delete\")}>\n          <IconButton onClick={() => props.removeSelf()}>\n            <TrashCan></TrashCan>\n          </IconButton>\n        </Tooltip>\n      </Box>\n      <Box className={clsx(classes.section)}>\n        <Typography variant={\"subtitle1\"} style={{ marginBottom: \"8px\" }}>\n          {t(\"general/ID\")}\n        </Typography>\n        <Input\n          margin={\"dense\"}\n          placeholder={t(\"widget/crossnote.neteasemusic/song-id-placeholder\")}\n          value={id}\n          onChange={event => {\n            setID(event.target.value);\n          }}\n          onKeyDown={event => {\n            if (event.which === 13) {\n              if (id) {\n                const attrs = {\n                  autoplay,\n                  id\n                };\n                props.replaceSelf(\n                  `\\`@crossnote.netease_music ${JSON.stringify(attrs)\n                    .replace(/^{/, \"\")\n                    .replace(/}$/, \"\")}\\``\n                );\n              }\n            }\n          }}\n          fullWidth={true}\n        ></Input>\n      </Box>\n      <Box className={clsx(classes.section)}>\n        <FormControlLabel\n          label={t(\"widget/autoplay\")}\n          control={\n            <Switch\n              checked={autoplay}\n              onChange={() => setAutoplay(!autoplay)}\n              color={\"primary\"}\n            ></Switch>\n          }\n        ></FormControlLabel>\n      </Box>\n    </Card>\n  );\n}\n\nexport const NeteaseMusicWidgetCreator: WidgetCreator = args => {\n  const el = document.createElement(\"span\");\n  ReactDOM.render(<NeteaseMusicWidget {...args}></NeteaseMusicWidget>, el);\n  return el;\n};\n","import { WidgetCreator, WidgetArgs } from \"vickymd/widget\";\nimport React, { useState } from \"react\";\nimport ReactDOM from \"react-dom\";\nimport {\n  Card,\n  Typography,\n  IconButton,\n  Box,\n  Input,\n  Tooltip,\n  Switch,\n  FormControlLabel\n} from \"@material-ui/core\";\nimport { createStyles, makeStyles, Theme } from \"@material-ui/core/styles\";\nimport clsx from \"clsx\";\nimport { TrashCan } from \"mdi-material-ui\";\nimport { useTranslation } from \"react-i18next\";\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    card: {\n      padding: theme.spacing(2),\n      position: \"relative\"\n    },\n    actionButtons: {\n      position: \"absolute\",\n      top: \"0\",\n      right: \"0\"\n    },\n    section: {\n      marginTop: theme.spacing(2)\n    },\n    videoWrapper: {\n      cursor: \"default\",\n      position: \"relative\",\n      width: \"100%\",\n      height: \"0\",\n      paddingTop: \"56.25%\"\n    },\n    video: {\n      position: \"absolute\",\n      left: \"0\",\n      top: \"0\",\n      width: \"100%\",\n      height: \"100%\"\n    }\n  })\n);\n\nfunction VideoWidget(props: WidgetArgs) {\n  const attributes = props.attributes;\n  const classes = useStyles(props);\n  const { t } = useTranslation();\n  const [source, setSource] = useState<string>(attributes[\"source\"] || \"\");\n  const [autoplay, setAutoplay] = useState<boolean>(\n    attributes[\"autoplay\"] || false\n  );\n  const [controls, setControls] = useState<boolean>(\n    attributes[\"controls\"] || true\n  );\n  const [loop, setLoop] = useState<boolean>(attributes[\"loop\"] || false);\n  const [muted, setMuted] = useState<boolean>(attributes[\"muted\"] || false);\n  const [poster, setPoster] = useState<string>(attributes[\"poster\"] || \"\");\n\n  if (attributes[\"src\"]) {\n    return (\n      <span style={{ cursor: \"default\" }}>\n        <Box className={clsx(classes.videoWrapper)}>\n          <video\n            className={clsx(classes.video)}\n            autoPlay={attributes[\"autoplay\"] || attributes[\"autoPlay\"]}\n            controls={attributes[\"controls\"]}\n            loop={attributes[\"loop\"]}\n            muted={attributes[\"muted\"]}\n            style={attributes[\"style\"]}\n            poster={attributes[\"poster\"]}\n          >\n            {t(\"widget/crossnote.video/video_element_fail\")}\n            <source src={attributes[\"src\"]} type={attributes[\"type\"]}></source>\n          </video>\n        </Box>\n      </span>\n    );\n  }\n\n  if (props.isPreview) {\n    return <span></span>;\n  }\n\n  return (\n    <Card elevation={2} className={clsx(classes.card)}>\n      <Typography variant={\"h5\"}>{t(\"general/Video\")}</Typography>\n      <Box className={clsx(classes.actionButtons)}>\n        <Tooltip title={t(\"general/Delete\")}>\n          <IconButton onClick={() => props.removeSelf()}>\n            <TrashCan></TrashCan>\n          </IconButton>\n        </Tooltip>\n      </Box>\n      <Box className={clsx(classes.section)}>\n        <Typography variant={\"subtitle1\"} style={{ marginBottom: \"8px\" }}>\n          {t(\"general/source-url\")}\n        </Typography>\n        <Input\n          margin={\"dense\"}\n          placeholder={t(\"widget/crossnote.video/video-url-placeholder\")}\n          value={source}\n          onChange={event => {\n            setSource(event.target.value);\n          }}\n          onKeyDown={event => {\n            if (event.which === 13) {\n              if (source) {\n                const attrs = {\n                  autoplay,\n                  controls,\n                  loop,\n                  muted,\n                  src: source,\n                  poster\n                };\n                props.replaceSelf(\n                  `\\`@crossnote.video ${JSON.stringify(attrs)\n                    .replace(/^{/, \"\")\n                    .replace(/}$/, \"\")}\\``\n                );\n              }\n            }\n          }}\n          fullWidth={true}\n        ></Input>\n      </Box>\n      <Box className={clsx(classes.section)}>\n        <Typography variant={\"subtitle1\"} style={{ marginBottom: \"8px\" }}>\n          {t(\"widget/crossnote.video/poster-url\")}\n        </Typography>\n        <Input\n          margin={\"dense\"}\n          placeholder={t(\"widget/crossnote.video/poster-url-placeholder\")}\n          value={poster}\n          onChange={event => {\n            setPoster(event.target.value);\n          }}\n          fullWidth={true}\n        ></Input>\n      </Box>\n      <Box className={clsx(classes.section)}>\n        <FormControlLabel\n          label={t(\"widget/autoplay\")}\n          control={\n            <Switch\n              checked={autoplay}\n              onChange={() => setAutoplay(!autoplay)}\n              color={\"primary\"}\n            ></Switch>\n          }\n        ></FormControlLabel>\n        <FormControlLabel\n          label={t(\"widget/controls\")}\n          control={\n            <Switch\n              checked={controls}\n              onChange={() => setControls(!controls)}\n              color={\"primary\"}\n            ></Switch>\n          }\n        ></FormControlLabel>\n        <FormControlLabel\n          label={t(\"widget/loop\")}\n          control={\n            <Switch\n              checked={loop}\n              onChange={() => setLoop(!loop)}\n              color={\"primary\"}\n            ></Switch>\n          }\n        ></FormControlLabel>\n        <FormControlLabel\n          label={t(\"widget/muted\")}\n          control={\n            <Switch\n              checked={muted}\n              onChange={() => setMuted(!muted)}\n              color={\"primary\"}\n            ></Switch>\n          }\n        ></FormControlLabel>\n      </Box>\n    </Card>\n  );\n}\n\nexport const VideoWidgetCreator: WidgetCreator = args => {\n  const el = document.createElement(\"span\");\n  ReactDOM.render(<VideoWidget {...args}></VideoWidget>, el);\n  return el;\n};\n","import { WidgetCreator, WidgetArgs } from \"vickymd/widget\";\nimport React, { useState } from \"react\";\nimport ReactDOM from \"react-dom\";\nimport {\n  Card,\n  Typography,\n  IconButton,\n  Box,\n  Input,\n  Tooltip\n} from \"@material-ui/core\";\nimport { createStyles, makeStyles, Theme } from \"@material-ui/core/styles\";\nimport clsx from \"clsx\";\nimport { TrashCan } from \"mdi-material-ui\";\nimport { useTranslation } from \"react-i18next\";\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    card: {\n      padding: theme.spacing(2),\n      position: \"relative\"\n    },\n    actionButtons: {\n      position: \"absolute\",\n      top: \"0\",\n      right: \"0\"\n    },\n    section: {\n      marginTop: theme.spacing(2)\n    },\n    videoWrapper: {\n      cursor: \"default\",\n      position: \"relative\",\n      width: \"100%\",\n      height: \"0\",\n      paddingTop: \"56.25%\"\n    },\n    video: {\n      backgroundColor: \"#ddd\",\n      border: \"none\",\n      position: \"absolute\",\n      left: \"0\",\n      top: \"0\",\n      width: \"100%\",\n      height: \"100%\"\n    },\n    errorMessage: {\n      color: \"#f44336\",\n      marginTop: theme.spacing(2)\n    }\n  })\n);\n\nfunction BilibiliWidget(props: WidgetArgs) {\n  const attributes = props.attributes;\n  const classes = useStyles(props);\n  const { t } = useTranslation();\n  const [url, setURL] = useState<string>(\"\");\n  const [error, setError] = useState<string>(\"\");\n\n  if (attributes[\"aid\"]) {\n    return (\n      <span style={{ cursor: \"default\" }}>\n        <Box className={clsx(classes.videoWrapper)}>\n          <iframe\n            title={\"bilibili_\" + attributes[\"id\"]}\n            className={clsx(classes.video)}\n            src={`https://player.bilibili.com/player.html?aid=${attributes[\"aid\"]}`}\n            scrolling={\"no\"}\n            frameBorder={\"no\"}\n            allowFullScreen={true}\n          ></iframe>\n        </Box>\n      </span>\n    );\n  }\n\n  if (props.isPreview) {\n    return <span></span>;\n  }\n\n  return (\n    <Card elevation={2} className={clsx(classes.card)}>\n      <Typography variant={\"h5\"}>\n        {t(\"widget/crossnote.bilibili/Bilibili\")}\n      </Typography>\n      <Box className={clsx(classes.actionButtons)}>\n        <Tooltip title={t(\"general/Delete\")}>\n          <IconButton onClick={() => props.removeSelf()}>\n            <TrashCan></TrashCan>\n          </IconButton>\n        </Tooltip>\n      </Box>\n      <Box className={clsx(classes.section)}>\n        <Typography variant={\"subtitle1\"} style={{ marginBottom: \"8px\" }}>\n          {t(\"widget/crossnote.bilibili/bilibili-video-url\")}\n        </Typography>\n        <Input\n          margin={\"dense\"}\n          placeholder={t(\"widget/crossnote.bilibili/url-placeholder\")}\n          value={url}\n          onChange={event => {\n            setURL(event.target.value);\n            setError(\"\");\n          }}\n          onKeyDown={event => {\n            if (event.which === 13) {\n              if (url && url.match(/bilibili\\.com\\/video\\/av(\\d+)/)) {\n                const aid = url.match(/bilibili\\.com\\/video\\/av(\\d+)/)[1];\n                const attrs = {\n                  aid\n                };\n                props.replaceSelf(\n                  `\\`@crossnote.bilibili ${JSON.stringify(attrs)\n                    .replace(/^{/, \"\")\n                    .replace(/}$/, \"\")}\\``\n                );\n              } else {\n                setError(t(\"widget/crossnote.bilibili/error_message\"));\n              }\n            }\n          }}\n          fullWidth={true}\n        ></Input>\n        <Typography className={clsx(classes.errorMessage)}>{error}</Typography>\n      </Box>\n    </Card>\n  );\n}\n\nexport const BilibiliWidgetCreator: WidgetCreator = args => {\n  const el = document.createElement(\"span\");\n  ReactDOM.render(<BilibiliWidget {...args}></BilibiliWidget>, el);\n  return el;\n};\n","import { WidgetCreator, WidgetArgs } from \"vickymd/widget\";\nimport React, { useState } from \"react\";\nimport ReactDOM from \"react-dom\";\nimport {\n  Card,\n  Typography,\n  IconButton,\n  Box,\n  Input,\n  Tooltip\n} from \"@material-ui/core\";\nimport { createStyles, makeStyles, Theme } from \"@material-ui/core/styles\";\nimport clsx from \"clsx\";\nimport { TrashCan } from \"mdi-material-ui\";\nimport { useTranslation } from \"react-i18next\";\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    card: {\n      padding: theme.spacing(2),\n      position: \"relative\"\n    },\n    actionButtons: {\n      position: \"absolute\",\n      top: \"0\",\n      right: \"0\"\n    },\n    section: {\n      marginTop: theme.spacing(2)\n    },\n    videoWrapper: {\n      cursor: \"default\",\n      position: \"relative\",\n      width: \"100%\",\n      height: \"0\",\n      paddingTop: \"56.25%\"\n    },\n    video: {\n      backgroundColor: \"#ddd\",\n      border: \"none\",\n      position: \"absolute\",\n      left: \"0\",\n      top: \"0\",\n      width: \"100%\",\n      height: \"100%\"\n    },\n    errorMessage: {\n      color: \"#f44336\",\n      marginTop: theme.spacing(2)\n    }\n  })\n);\n\nfunction YoutubeWidget(props: WidgetArgs) {\n  const attributes = props.attributes;\n  const classes = useStyles(props);\n  const { t } = useTranslation();\n  const [url, setURL] = useState<string>(\"\");\n  const [error, setError] = useState<string>(\"\");\n\n  if (attributes[\"videoID\"]) {\n    return (\n      <span style={{ cursor: \"default\" }}>\n        <Box className={clsx(classes.videoWrapper)}>\n          <iframe\n            title={\"youtube_\" + attributes[\"videoID\"]}\n            className={clsx(classes.video)}\n            src={`https://www.youtube.com/embed/${attributes[\"videoID\"]}`}\n            scrolling={\"no\"}\n            frameBorder={\"no\"}\n            allowFullScreen={true}\n          ></iframe>\n        </Box>\n      </span>\n    );\n  }\n\n  if (props.isPreview) {\n    return <span></span>;\n  }\n\n  return (\n    <Card elevation={2} className={clsx(classes.card)}>\n      <Typography variant={\"h5\"}>{t(\"Youtube\")}</Typography>\n      <Box className={clsx(classes.actionButtons)}>\n        <Tooltip title={t(\"general/Delete\")}>\n          <IconButton onClick={() => props.removeSelf()}>\n            <TrashCan></TrashCan>\n          </IconButton>\n        </Tooltip>\n      </Box>\n      <Box className={clsx(classes.section)}>\n        <Typography variant={\"subtitle1\"} style={{ marginBottom: \"8px\" }}>\n          {t(\"Youtube video URL\")}\n        </Typography>\n        <Input\n          margin={\"dense\"}\n          placeholder={t(\n            \"widget/crossnote.youtube/youtube-video-url-placeholder\"\n          )}\n          value={url}\n          onChange={event => {\n            setURL(event.target.value);\n            setError(\"\");\n          }}\n          onKeyDown={event => {\n            if (event.which === 13) {\n              if (url && url.match(/youtube\\.com\\/watch\\?v=(.+?)$/)) {\n                const videoID = url.match(/youtube\\.com\\/watch\\?v=(.+?)$/)[1];\n                const attrs = {\n                  videoID\n                };\n                props.replaceSelf(\n                  `\\`@crossnote.youtube ${JSON.stringify(attrs)\n                    .replace(/^{/, \"\")\n                    .replace(/}$/, \"\")}\\``\n                );\n              } else {\n                setError(t(\"widget/crossnote.youtube/error_message\"));\n              }\n            }\n          }}\n          fullWidth={true}\n        ></Input>\n        <Typography className={clsx(classes.errorMessage)}>{error}</Typography>\n      </Box>\n    </Card>\n  );\n}\n\nexport const YoutubeWidgetCreator: WidgetCreator = args => {\n  const el = document.createElement(\"span\");\n  ReactDOM.render(<YoutubeWidget {...args}></YoutubeWidget>, el);\n  return el;\n};\n","import { WidgetCreator, WidgetArgs } from \"vickymd/widget\";\nimport React, { useState, useEffect } from \"react\";\nimport ReactDOM from \"react-dom\";\nimport {\n  Card,\n  Typography,\n  IconButton,\n  Box,\n  Input,\n  Tooltip,\n  Switch,\n  FormControlLabel,\n  ListItem,\n  ListItemText,\n  List,\n  ListItemSecondaryAction,\n  FormGroup,\n  Checkbox,\n  ButtonGroup,\n  Button\n} from \"@material-ui/core\";\nimport { createStyles, makeStyles, Theme } from \"@material-ui/core/styles\";\nimport clsx from \"clsx\";\nimport { TrashCan } from \"mdi-material-ui\";\nimport { useTranslation } from \"react-i18next\";\nimport { createWorker } from \"tesseract.js\";\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    card: {\n      padding: theme.spacing(2),\n      position: \"relative\"\n    },\n    actionButtons: {\n      position: \"absolute\",\n      top: \"0\",\n      right: \"0\"\n    },\n    section: {\n      marginTop: theme.spacing(2)\n    },\n    dropArea: {\n      textAlign: \"center\",\n      padding: \"24px\",\n      border: \"4px dotted #c7c7c7\",\n      backgroundColor: \"#f1f1f1\",\n      cursor: \"pointer\",\n      \"&:hover\": {\n        backgroundColor: \"#eee\"\n      }\n    },\n    canvasWrapper: {\n      marginTop: theme.spacing(2)\n      // height: 0,\n      // paddingTop: \"56.25%\" // 16:9\n    },\n    canvas: {\n      maxWidth: \"100%\"\n    },\n    disabled: {\n      cursor: \"not-allowed\"\n    }\n  })\n);\n\ninterface OCRProgress {\n  status: string;\n  progress: number;\n  workerId?: string;\n}\n\nfunction getInitialLanguages() {\n  try {\n    return JSON.parse(\n      localStorage.getItem(\"widget/crossnote.ocr/languages\") || '[\"eng\"]'\n    );\n  } catch (error) {\n    return [\"eng\"];\n  }\n}\n\nfunction OCRWidget(props: WidgetArgs) {\n  const classes = useStyles(props);\n  const { t } = useTranslation();\n  const [canvas, setCanvas] = useState<HTMLCanvasElement>(null);\n  // https://github.com/tesseract-ocr/tesseract/wiki/Data-Files#data-files-for-version-400-november-29-2016\n  const [link, setLink] = useState<string>(\"\");\n  const [imageDataURL, setImageDataURL] = useState<string>(\"\");\n  const [ocrDataURL, setOCRDataURL] = useState<string>(\"\");\n  const [imageDropAreaElement, setImageDropAreaElement] = useState<\n    HTMLInputElement\n  >(null);\n  const [isProcessing, setIsProcessing] = useState<boolean>(false);\n  const [ocrProgresses, setOCRProgresses] = useState<OCRProgress[]>([]);\n  const [selectedLanguages, setSelectedLanguages] = useState<string[]>(\n    getInitialLanguages()\n  );\n  const [grayscaleChecked, setGrayscaleChecked] = useState<boolean>(\n    !!localStorage.getItem(\"widget/crossnote.ocr/grayscale\") || true\n  );\n\n  useEffect(() => {\n    if (canvas && imageDataURL) {\n      const imageObject = new Image();\n      const context = canvas.getContext(\"2d\");\n      imageObject.onload = function() {\n        canvas.width = imageObject.width;\n        canvas.height = imageObject.height;\n        context.clearRect(0, 0, canvas.width, canvas.height);\n        if (grayscaleChecked) {\n          context.fillStyle = \"#FFF\";\n          context.fillRect(0, 0, canvas.width, canvas.height);\n          context.globalCompositeOperation = \"luminosity\";\n        }\n        context.drawImage(imageObject, 0, 0);\n        setOCRDataURL(canvas.toDataURL());\n      };\n      imageObject.onerror = error => {\n        throw error;\n      };\n      imageObject.setAttribute(\"crossOrigin\", \"anonymous\");\n      imageObject.src = imageDataURL;\n    }\n  }, [canvas, imageDataURL, grayscaleChecked]);\n\n  function clickDropArea(e: any) {\n    e.preventDefault();\n    e.stopPropagation();\n    if (!imageDropAreaElement || isProcessing) return;\n    imageDropAreaElement.onchange = function(event) {\n      const target = event.target as any;\n      const files = target.files || [];\n      if (files.length) {\n        try {\n          const file = files[0] as File;\n          const reader = new FileReader();\n          reader.readAsDataURL(file);\n          reader.onload = () => {\n            setImageDataURL(reader.result as string);\n          };\n          reader.onerror = error => {\n            throw error;\n          };\n        } catch (error) {}\n      }\n    };\n    imageDropAreaElement.click();\n  }\n\n  function startOCRFromLink() {\n    try {\n      setImageDataURL(link);\n    } catch (error) {}\n  }\n\n  function ocr(input: File | string | HTMLCanvasElement) {\n    const worker = createWorker({\n      logger: (m: OCRProgress) => {\n        setOCRProgresses(ocrProgresses => {\n          if (\n            ocrProgresses.length &&\n            ocrProgresses[ocrProgresses.length - 1].status === m.status\n          ) {\n            return [...ocrProgresses.slice(0, ocrProgresses.length - 1), m];\n          } else {\n            return [...ocrProgresses, m];\n          }\n        });\n      }\n    });\n\n    (async () => {\n      setIsProcessing(true);\n      let languagesArr = selectedLanguages;\n      if (languagesArr.length === 0) {\n        languagesArr = [\"eng\"];\n      }\n\n      await worker.load();\n      await worker.loadLanguage(languagesArr.join(\"+\"));\n      await worker.initialize(languagesArr.join(\"+\"));\n      const {\n        data: { text }\n      } = await worker.recognize(input);\n      props.replaceSelf(\"\\n\" + text);\n      await worker.terminate();\n      setIsProcessing(false);\n    })();\n  }\n\n  function toggleLanguage(lang: string) {\n    setSelectedLanguages(selectedLanguages => {\n      const offset = selectedLanguages.indexOf(lang);\n      if (offset >= 0) {\n        selectedLanguages.splice(offset, 1);\n        selectedLanguages = [...selectedLanguages];\n      } else {\n        selectedLanguages = [...selectedLanguages, lang];\n      }\n      localStorage.setItem(\n        \"widget/crossnote.ocr/languages\",\n        JSON.stringify(selectedLanguages)\n      );\n      return selectedLanguages;\n    });\n  }\n\n  if (props.isPreview) {\n    return <span></span>;\n  }\n\n  if (isProcessing) {\n    return (\n      <Card elevation={2} className={clsx(classes.card)}>\n        <Typography variant={\"h5\"}>{t(\"general/Processing\")}</Typography>\n        {/*<Typography variant={\"body1\"}>{t(\"general/please-wait\")}</Typography>*/}\n        <List>\n          {ocrProgresses.length > 0 && (\n            <ListItem>\n              <ListItemText>\n                {t(\n                  \"tesseract/\" + ocrProgresses[ocrProgresses.length - 1].status\n                )}\n              </ListItemText>\n              <ListItemSecondaryAction>\n                {Math.floor(\n                  ocrProgresses[ocrProgresses.length - 1].progress * 100\n                ).toString() + \"%\"}\n              </ListItemSecondaryAction>\n            </ListItem>\n          )}\n        </List>\n      </Card>\n    );\n  }\n\n  if (imageDataURL) {\n    return (\n      <Card elevation={2} className={clsx(classes.card)}>\n        <Box className={clsx(classes.section)}>\n          <Typography variant={\"subtitle1\"} style={{ marginBottom: \"8px\" }}>\n            {t(\"widget/crossnote.ocr/recognize-text-in-languages\")}\n          </Typography>\n          <FormGroup>\n            <FormControlLabel\n              control={\n                <Checkbox\n                  checked={selectedLanguages.indexOf(\"eng\") >= 0}\n                  onChange={() => toggleLanguage(\"eng\")}\n                  value=\"eng\"\n                />\n              }\n              label=\"English\"\n            />\n            <FormControlLabel\n              control={\n                <Checkbox\n                  checked={selectedLanguages.indexOf(\"chi_sim\") >= 0}\n                  onChange={() => toggleLanguage(\"chi_sim\")}\n                  value=\"chi_sim\"\n                />\n              }\n              label=\"简体中文\"\n            />\n            <FormControlLabel\n              control={\n                <Checkbox\n                  checked={selectedLanguages.indexOf(\"chi_tra\") >= 0}\n                  onChange={() => toggleLanguage(\"chi_tra\")}\n                  value=\"chi_tra\"\n                />\n              }\n              label=\"繁體中文\"\n            />\n            <FormControlLabel\n              control={\n                <Checkbox\n                  checked={selectedLanguages.indexOf(\"jpn\") >= 0}\n                  onChange={() => toggleLanguage(\"jpn\")}\n                  value=\"jpn\"\n                />\n              }\n              label=\"日本語\"\n            />\n          </FormGroup>\n        </Box>\n        <Box className={clsx(classes.section)}>\n          <Typography variant={\"subtitle1\"} style={{ marginBottom: \"8px\" }}>\n            {t(\"widget/crossnote.ocr/extra-settings\")}\n          </Typography>\n          <FormControlLabel\n            control={\n              <Switch\n                checked={grayscaleChecked}\n                onChange={() => {\n                  if (grayscaleChecked) {\n                    localStorage.removeItem(\"widget/crossnote.ocr/grayscale\");\n                  } else {\n                    localStorage.setItem(\n                      \"widget/crossnote.ocr/grayscale\",\n                      \"true\"\n                    );\n                  }\n                  setGrayscaleChecked(!grayscaleChecked);\n                }}\n                color={\"primary\"}\n              ></Switch>\n            }\n            label={t(\"widget/crossnote.ocr/grayscale\")}\n          ></FormControlLabel>\n        </Box>\n        <Box className={clsx(classes.canvasWrapper)}>\n          <canvas\n            className={clsx(classes.canvas)}\n            ref={element => setCanvas(element)}\n          ></canvas>\n        </Box>\n        <ButtonGroup>\n          <Button\n            onClick={() => {\n              setImageDataURL(\"\");\n              setOCRDataURL(\"\");\n            }}\n          >\n            {t(\"general/go-back\")}\n          </Button>\n          <Button\n            color={\"primary\"}\n            onClick={() => ocr(ocrDataURL)}\n            disabled={!ocrDataURL}\n          >\n            {t(\"widget/crossnote.ocr/start-ocr\")}\n          </Button>\n        </ButtonGroup>\n      </Card>\n    );\n  }\n\n  return (\n    <Card elevation={2} className={clsx(classes.card)}>\n      <Typography variant={\"h5\"}>{t(\"widget/crossnote.ocr/ocr\")}</Typography>\n      <Box className={clsx(classes.actionButtons)}>\n        <Tooltip title={t(\"general/Delete\")}>\n          <IconButton onClick={() => props.removeSelf()}>\n            <TrashCan></TrashCan>\n          </IconButton>\n        </Tooltip>\n      </Box>\n      <Box className={clsx(classes.section)}>\n        <Typography variant={\"subtitle1\"} style={{ marginBottom: \"8px\" }}>\n          {t(\"general/Link\")}\n        </Typography>\n        <Input\n          margin={\"dense\"}\n          placeholder={t(\"widget/crossnote.image/image-url-placeholder\")}\n          value={link}\n          onChange={event => {\n            setLink(event.target.value);\n          }}\n          onKeyDown={event => {\n            if (event.which === 13) {\n              startOCRFromLink();\n            }\n          }}\n          fullWidth={true}\n        ></Input>\n      </Box>\n      <Typography\n        variant={\"subtitle1\"}\n        style={{ marginTop: \"16px\", textAlign: \"center\" }}\n      >\n        {t(\"widget/crossnote.auth/Or\")}\n      </Typography>\n      <Box className={clsx(classes.section)}>\n        <Typography variant={\"subtitle1\"} style={{ marginBottom: \"8px\" }}>\n          {t(\"widget/crossnote.ocr/local-image\")}\n        </Typography>\n        <Box\n          className={clsx(\n            classes.dropArea,\n            isProcessing ? classes.disabled : null\n          )}\n          onClick={clickDropArea}\n        >\n          <Typography>\n            {isProcessing\n              ? t(\"utils/uploading-image\")\n              : t(\"widget/crossnote.image/click-here-to-browse-image-file\")}\n          </Typography>\n        </Box>\n      </Box>\n      <input\n        type=\"file\"\n        // multiple\n        style={{ display: \"none\" }}\n        ref={(element: HTMLInputElement) => {\n          setImageDropAreaElement(element);\n        }}\n      ></input>\n    </Card>\n  );\n}\n\nexport const OCRWidgetCreator: WidgetCreator = args => {\n  const el = document.createElement(\"span\");\n  ReactDOM.render(<OCRWidget {...args}></OCRWidget>, el);\n  return el;\n};\n","import { WidgetCreator, WidgetArgs } from \"vickymd/widget\";\nimport React, { useState, useEffect } from \"react\";\nimport ReactDOM from \"react-dom\";\nimport {\n  Card,\n  Typography,\n  IconButton,\n  Box,\n  CardContent,\n  TextField\n} from \"@material-ui/core\";\nimport { createStyles, makeStyles, Theme } from \"@material-ui/core/styles\";\nimport clsx from \"clsx\";\nimport { CardPlus, Close, ContentSave, Cancel } from \"mdi-material-ui\";\nimport { useTranslation } from \"react-i18next\";\n\n// @ts-ignore\nimport Board from \"@lourenci/react-kanban\";\nimport { Editor as CodeMirrorEditor } from \"codemirror\";\nimport { renderPreview } from \"vickymd/preview\";\nconst VickyMD = require(\"vickymd\");\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    laneHeader: {\n      width: \"256px\",\n      maxWidth: \"100%\",\n      display: \"flex\",\n      alignItems: \"center\",\n      justifyContent: \"space-between\"\n    },\n    kanbanCard: {\n      width: \"256px\",\n      maxWidth: \"100%\",\n      position: \"relative\",\n      [theme.breakpoints.down(\"sm\")]: {\n        marginTop: \"4px\",\n        marginBottom: \"4px\"\n      }\n    },\n    editorWrapper: {\n      // height: \"160px\",\n      // border: \"2px solid #96c3e6\",\n      \"& .CodeMirror-gutters\": {\n        display: \"none\"\n      }\n    },\n    textarea: {\n      width: \"100%\",\n      height: \"100%\"\n    },\n    preview: {\n      padding: theme.spacing(2)\n    }\n  })\n);\n\ninterface KanbanCard {\n  id: number;\n  title: string;\n  description: string;\n}\n\ninterface KanbanLane {\n  id: number;\n  title: string;\n  wip: boolean;\n  cards: KanbanCard[];\n}\n\ninterface KanbanBoard {\n  lanes: KanbanLane[];\n}\n\ninterface KanbanLaneHeaderProps {\n  lane: KanbanLane;\n  board: KanbanBoard;\n  refreshBoard: (board: Board) => void;\n  isPreview: boolean;\n}\n\nfunction KanbanLaneHeaderDisplay(props: KanbanLaneHeaderProps) {\n  const classes = useStyles(props);\n  const { t } = useTranslation();\n  const lane = props.lane;\n  const board = props.board;\n  const isPreview = props.isPreview;\n  const refreshBoard = props.refreshBoard;\n  const [clickedTitle, setClickedTitle] = useState<boolean>(false);\n  const [titleValue, setTitleValue] = useState<string>(lane.title);\n\n  useEffect(() => {\n    if (!clickedTitle && titleValue !== lane.title) {\n      lane.title = titleValue || t(\"general/Untitled\");\n      setTitleValue(lane.title);\n      refreshBoard(board);\n    }\n  }, [clickedTitle, board, lane.title, titleValue, t, refreshBoard]);\n\n  return (\n    <Box className={clsx(classes.laneHeader)}>\n      <Box>\n        {clickedTitle ? (\n          <TextField\n            value={titleValue}\n            onChange={event => {\n              setTitleValue(event.target.value);\n            }}\n            onBlur={() => {\n              setClickedTitle(false);\n            }}\n            onKeyUp={event => {\n              if (event.which === 13) {\n                setClickedTitle(false);\n              }\n            }}\n          ></TextField>\n        ) : (\n          <Typography\n            variant={\"body1\"}\n            style={{ cursor: \"text\" }}\n            onClick={() => {\n              if (!isPreview) {\n                setClickedTitle(true);\n              }\n            }}\n          >\n            {titleValue}\n          </Typography>\n        )}\n      </Box>\n      {!isPreview && (\n        <Box>\n          <IconButton\n            onClick={() => {\n              const card: KanbanCard = {\n                id: Date.now(),\n                title: \"\", //\"Card \" + lane.cards.length,\n                description: \"empty\"\n              };\n              if (lane) {\n                lane.cards.push(card);\n              }\n              props.refreshBoard(board);\n            }}\n          >\n            <CardPlus></CardPlus>\n          </IconButton>\n          <IconButton\n            onClick={() => {\n              board.lanes = board.lanes.filter(l => lane.id !== l.id);\n              props.refreshBoard(board);\n            }}\n          >\n            <Close></Close>\n          </IconButton>\n        </Box>\n      )}\n    </Box>\n  );\n}\n\ninterface KanbanCardProps {\n  card: KanbanCard;\n  board: KanbanBoard;\n  refreshBoard: (board: Board) => void;\n  isPreview: boolean;\n}\nfunction KanbanCardDisplay(props: KanbanCardProps) {\n  const classes = useStyles(props);\n  const board = props.board;\n  const card = props.card;\n  const isPreview = props.isPreview;\n  const [textAreaElement, setTextAreaElement] = useState<HTMLTextAreaElement>(\n    null\n  );\n  const [previewElement, setPreviewElement] = React.useState<HTMLElement>(null);\n\n  const [editor, setEditor] = useState<CodeMirrorEditor>(null);\n  const [description, setDescription] = useState<string>(card.description);\n  const [clickedPreview, setClickedPreview] = useState<boolean>(false);\n  const { t } = useTranslation();\n\n  useEffect(() => {\n    setDescription(card.description);\n  }, [card.description]);\n\n  useEffect(() => {\n    if (textAreaElement) {\n      const editor: CodeMirrorEditor = VickyMD.fromTextArea(textAreaElement, {\n        mode: {\n          name: \"hypermd\",\n          hashtag: true\n        },\n        inputStyle: \"textarea\"\n        // autofocus: false\n      });\n      editor.setValue(card.description);\n      editor.setOption(\"lineNumbers\", false);\n      editor.setOption(\"foldGutter\", false);\n      editor.setOption(\"autofocus\", false);\n      if (isPreview) {\n        editor.setOption(\"readOnly\", \"nocursor\");\n      }\n      editor.on(\"changes\", () => {\n        setDescription(editor.getValue());\n      });\n      /*\n      // Cause save not working\n      editor.on(\"blur\", () => {\n        setClickedPreview(false);\n        setEditor(null);\n      });\n      */\n      // editor.display.input.blur();\n      setEditor(editor);\n    }\n  }, [textAreaElement]);\n\n  useEffect(() => {\n    if (previewElement) {\n      renderPreview(previewElement, card.description);\n    }\n  }, [previewElement]);\n\n  if (isPreview || !clickedPreview) {\n    return (\n      <Card className={clsx(classes.kanbanCard)}>\n        <div\n          className={clsx(\"preview\", classes.preview)}\n          ref={(element: HTMLElement) => {\n            setPreviewElement(element);\n          }}\n          onClick={() => {\n            if (!isPreview) {\n              setClickedPreview(true);\n            }\n          }}\n        ></div>\n        {!isPreview && (\n          <Box\n            style={{ position: \"absolute\", top: \"0\", right: \"0\", zIndex: 99 }}\n          >\n            <IconButton\n              onClick={() => {\n                board.lanes.forEach(lane => {\n                  lane.cards = lane.cards.filter(c => c.id !== card.id);\n                });\n                props.refreshBoard(board);\n              }}\n            >\n              <Close></Close>\n            </IconButton>\n          </Box>\n        )}\n      </Card>\n    );\n  }\n\n  return (\n    <Card className={clsx(classes.kanbanCard)}>\n      <CardContent>\n        <Box className={clsx(classes.editorWrapper)}>\n          <textarea\n            className={classes.textarea}\n            ref={(element: HTMLTextAreaElement) => {\n              setTextAreaElement(element);\n            }}\n          ></textarea>\n        </Box>\n\n        {description !== card.description && (\n          <Box\n          // style={{ position: \"absolute\", top: \"0\", right: \"0\", zIndex: 99 }}\n          >\n            <IconButton\n              onClick={() => {\n                card.description = description;\n                props.refreshBoard(props.board);\n                setClickedPreview(false);\n              }}\n            >\n              <ContentSave></ContentSave>\n            </IconButton>\n            <IconButton\n              onClick={() => {\n                if (editor) {\n                  editor.setValue(card.description);\n                }\n                setDescription(card.description);\n                setClickedPreview(false);\n              }}\n            >\n              <Cancel></Cancel>\n            </IconButton>\n          </Box>\n        )}\n      </CardContent>\n    </Card>\n  );\n}\n\nfunction KanbanWidget(props: WidgetArgs) {\n  const classes = useStyles(props);\n  const { t } = useTranslation();\n  const [board, setBoard] = useState<KanbanBoard>(\n    props.attributes[\"board\"] || {\n      lanes: []\n    }\n  );\n\n  const refreshBoard = (board: KanbanBoard) => {\n    const newBoard = Object.assign({}, board);\n    props.setAttributes({ board: newBoard });\n    setBoard(newBoard as KanbanBoard);\n  };\n\n  return (\n    <div>\n      <Board\n        renderLaneHeader={(lane: KanbanLane) => (\n          <KanbanLaneHeaderDisplay\n            lane={lane}\n            board={board}\n            refreshBoard={refreshBoard}\n            isPreview={props.isPreview}\n          ></KanbanLaneHeaderDisplay>\n        )}\n        renderCard={(card: KanbanCard, { dragging }: { dragging: boolean }) => {\n          return (\n            <KanbanCardDisplay\n              card={card}\n              board={board}\n              refreshBoard={refreshBoard}\n              isPreview={props.isPreview}\n            ></KanbanCardDisplay>\n          );\n        }}\n        allowAddLane={!props.isPreview}\n        onNewLaneConfirm={(newLane: any) => {\n          board.lanes.push({ id: Date.now(), ...newLane });\n          refreshBoard(board);\n        }}\n        disableCardDrag={props.isPreview}\n        disableLaneDrag={props.isPreview}\n        onCardDragEnd={(\n          card: KanbanCard,\n          source: { fromPosition: number; fromLaneId: number },\n          destination: { toPosition: number; toLaneId: number }\n        ) => {\n          const { fromPosition, fromLaneId } = source;\n          let { toPosition, toLaneId } = destination;\n          const fromLane = board.lanes.filter(l => l.id === fromLaneId)[0];\n          const toLane = board.lanes.filter(l => l.id === toLaneId)[0];\n          fromLane.cards.splice(fromPosition, 1);\n          toLane.cards = [\n            ...toLane.cards.slice(0, toPosition),\n            card,\n            ...toLane.cards.slice(toPosition, toLane.cards.length)\n          ];\n\n          refreshBoard(board);\n        }}\n        onLaneDragEnd={(\n          source: { fromPosition: number },\n          destination: { toPosition: number }\n        ) => {\n          const fromPosition: number = source.fromPosition;\n          const toPosition: number = destination.toPosition;\n          const fromLane = board.lanes[fromPosition];\n          const toLane = board.lanes[toPosition];\n          board.lanes[toPosition] = fromLane;\n          board.lanes[fromPosition] = toLane;\n          refreshBoard(board);\n        }}\n      >\n        {board}\n      </Board>\n    </div>\n  );\n}\n\nexport const KanbanWidgetCreator: WidgetCreator = args => {\n  const el = document.createElement(\"span\");\n  ReactDOM.render(<KanbanWidget {...args}></KanbanWidget>, el);\n  return el;\n};\n","import { WidgetCreator, WidgetArgs } from \"vickymd/widget\";\nimport React, { useState, useEffect } from \"react\";\nimport ReactDOM from \"react-dom\";\nimport clsx from \"clsx\";\nimport { createStyles, makeStyles, Theme } from \"@material-ui/core/styles\";\nimport { Box, IconButton, Card } from \"@material-ui/core\";\nimport { useTranslation } from \"react-i18next\";\nimport { generateUUID } from \"../../utilities/utils\";\n\n// @ts-ignore\nimport abcjs from \"abcjs\";\nimport \"abcjs/abcjs-audio.css\";\nimport { ContentSave } from \"mdi-material-ui\";\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    card: {\n      padding: theme.spacing(2),\n      position: \"relative\"\n    },\n    editorWrapper: {\n      position: \"relative\",\n      padding: \"2px\"\n    },\n    editor: {\n      width: \"100%\",\n      height: \"128px\",\n      resize: \"none\",\n      border: \"none\"\n    },\n    canvas: {\n      overflow: \"auto !important\",\n      height: \"100% !important\"\n    },\n    saveBtn: {\n      position: \"absolute\",\n      top: \"0\",\n      right: \"0\"\n    }\n  })\n);\n\nfunction ABCWidget(props: WidgetArgs) {\n  const attributes = props.attributes;\n  const classes = useStyles(props);\n  const { t } = useTranslation();\n  const [abcEditorID] = useState<string>(\"abc-editor-\" + generateUUID());\n  const [abcWarningsID] = useState<string>(\"abc-warnings-\" + generateUUID());\n  const [abcCanvasID] = useState<string>(\"abc-canvas-\" + generateUUID());\n  const [abcAudioID] = useState<string>(\"abc-audio-\" + generateUUID());\n  const [editorElement, setEditorElement] = useState<HTMLElement>(null);\n  const [warningsElement, setWarningsElement] = useState<HTMLElement>(null);\n  const [canvasElement, setCanvasElement] = useState<HTMLElement>(null);\n  const [audioControlElement, setAudioControlElement] = useState<HTMLElement>(\n    null\n  );\n  const [hideEditor, setHideEditor] = useState<boolean>(props.isPreview);\n\n  const [abc, setABC] = useState<string>(\n    attributes[\"abc\"] ||\n      `X: 1\nT: Cooley's\nM: 4/4\nL: 1/8\nK: Emin\n|:D2|EB{c}BA B2 EB|~B2 AB dBAG|FDAD BDAD|FDAD dAFD|`\n  );\n\n  useEffect(() => {\n    if (\n      editorElement &&\n      warningsElement &&\n      canvasElement &&\n      audioControlElement\n    ) {\n      setTimeout(() => {\n        const editor = new abcjs.Editor(editorElement.id, {\n          canvas_id: canvasElement.id,\n          warnings_id: warningsElement.id,\n          generate_warnings: true,\n          synth: {\n            el: `#${audioControlElement.id}`,\n            options: {\n              displayLoop: true,\n              displayRestart: true,\n              displayPlay: true,\n              displayProgress: true,\n              displayWarp: true\n            }\n          },\n          abcjsParams: {\n            generateDownload: true\n          }\n        });\n\n        // Test synth\n      }, 1000);\n    }\n  }, [editorElement, warningsElement, canvasElement, audioControlElement]);\n\n  return (\n    <Box>\n      {/*<Typography variant={\"h5\"}>{t(\"widget/crossnote.abc/title\")}</Typography>*/}\n      <Card\n        elevation={2}\n        className={clsx(classes.editorWrapper)}\n        style={{\n          display: hideEditor ? \"none\" : \"block\"\n        }}\n      >\n        <textarea\n          className={clsx(classes.editor)}\n          id={abcEditorID}\n          ref={(element: HTMLElement) => {\n            setEditorElement(element);\n          }}\n          value={abc}\n          onChange={event => {\n            setABC(event.target.value);\n          }}\n          readOnly={props.isPreview}\n        ></textarea>\n        {!props.isPreview && attributes[\"abc\"] !== abc && (\n          <IconButton\n            className={clsx(classes.saveBtn)}\n            onClick={() => {\n              props.setAttributes(Object.assign(props.attributes, { abc }));\n            }}\n          >\n            <ContentSave></ContentSave>\n          </IconButton>\n        )}\n      </Card>\n      <div\n        id={abcWarningsID}\n        ref={(element: HTMLElement) => {\n          setWarningsElement(element);\n        }}\n      ></div>\n      <div\n        id={abcCanvasID}\n        className={clsx(classes.canvas)}\n        ref={(element: HTMLElement) => {\n          setCanvasElement(element);\n        }}\n      ></div>\n      <div\n        id={abcAudioID}\n        ref={(element: HTMLElement) => {\n          setAudioControlElement(element);\n        }}\n      ></div>\n    </Box>\n  );\n}\n\nexport const ABCWidgetCreator: WidgetCreator = args => {\n  const el = document.createElement(\"span\");\n  ReactDOM.render(<ABCWidget {...args}></ABCWidget>, el);\n  return el;\n};\n","// Import VickyMD related modules\n// VickyMD\nimport \"codemirror\";\n// Load these modes if you want highlighting ...\nimport \"codemirror/lib/codemirror.css\";\nimport \"codemirror/mode/htmlmixed/htmlmixed\"; // for embedded HTML\nimport \"codemirror/mode/markdown/markdown\";\nimport \"codemirror/mode/stex/stex\"; // for Math TeX Formular\nimport \"codemirror/mode/yaml/yaml\"; // for Front Matters\nimport \"codemirror/mode/javascript/javascript\"; // eg. javascript\nimport \"codemirror/mode/python/python\";\nimport \"codemirror/addon/display/placeholder\";\n\n// Essential\nimport \"vickymd\"; // ESSENTIAL\n// Widgets\n// Load PowerPacks if you want to utilize 3rd-party libs\nimport \"vickymd/powerpack/fold-math-with-katex\";\nimport \"vickymd/powerpack/fold-code-with-mermaid\";\nimport \"vickymd/powerpack/fold-code-with-plantuml\";\nimport \"vickymd/powerpack/fold-code-with-echarts\";\nimport \"vickymd/powerpack/fold-code-with-wavedrom\";\nimport \"vickymd/powerpack/hover-with-marked\";\nimport { registerWidgetCreator } from \"vickymd/widget\";\nimport { ImageWidgetCreator } from \"./widgets/Image\";\nimport { AudioWidgetCreator } from \"./widgets/Audio\";\nimport { NeteaseMusicWidgetCreator } from \"./widgets/NeteaseMusic\";\nimport { VideoWidgetCreator } from \"./widgets/Video\";\nimport { BilibiliWidgetCreator } from \"./widgets/Bilibili\";\nimport { YoutubeWidgetCreator } from \"./widgets/Youtube\";\nimport { OCRWidgetCreator } from \"./widgets/OCR\";\nimport { KanbanWidgetCreator } from \"./widgets/Kanban\";\nimport { ABCWidgetCreator } from \"./widgets/ABC\";\n\n// Set necessary window scope variables\nwindow[\"CodeMirror\"] = require(\"codemirror\");\n\n// Register widget creators\nregisterWidgetCreator(\"crossnote.image\", ImageWidgetCreator);\nregisterWidgetCreator(\"crossnote.audio\", AudioWidgetCreator);\nregisterWidgetCreator(\"crossnote.netease_music\", NeteaseMusicWidgetCreator);\nregisterWidgetCreator(\"crossnote.video\", VideoWidgetCreator);\nregisterWidgetCreator(\"crossnote.bilibili\", BilibiliWidgetCreator);\nregisterWidgetCreator(\"crossnote.youtube\", YoutubeWidgetCreator);\nregisterWidgetCreator(\"crossnote.ocr\", OCRWidgetCreator);\nregisterWidgetCreator(\"crossnote.kanban\", KanbanWidgetCreator);\nregisterWidgetCreator(\"crossnote.abc\", ABCWidgetCreator);\n","import React, { useEffect } from \"react\";\nimport \"./App.css\";\nimport { Home } from \"./pages/Home\";\nimport { createMuiTheme } from \"@material-ui/core\";\nimport { orange, blue } from \"@material-ui/core/colors\";\nimport { ThemeProvider } from \"@material-ui/styles\";\n\nimport \"./editor\";\n\nconst theme = createMuiTheme({\n  palette: {\n    primary: blue,\n    secondary: orange\n  }\n});\n\nconst App: React.FC = () => {\n  useEffect(() => {\n    const handler = (event: any) => {\n      event.preventDefault();\n      event.prompt();\n      event.userChoice.then((choiceResult: any) => {\n        console.log(choiceResult);\n      });\n    };\n    window.addEventListener(\"beforeinstallprompt\", handler);\n    return () => {\n      window.removeEventListener(\"beforeinstallprompt\", handler);\n    };\n  }, []);\n  return (\n    <ThemeProvider theme={theme}>\n      <div className=\"App\">\n        <Home></Home>\n      </div>\n    </ThemeProvider>\n  );\n};\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      (process as { env: { [key: string]: string } }).env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import { FSModule } from \"browserfs/dist/node/core/FS\";\nimport * as git from \"isomorphic-git\";\nimport http from \"isomorphic-git/http/web\";\nimport * as path from \"path\";\nimport PouchDB from \"pouchdb\";\nimport PouchdbFind from \"pouchdb-find\";\nimport { randomID } from \"../utilities/utils\";\nimport Stats from \"browserfs/dist/node/core/node_fs_stats\";\nimport { getHeaderFromMarkdown } from \"../utilities/note\";\n\nexport interface Notebook {\n  _id: string;\n  dir: string;\n  name: string;\n\n  // git\n  gitURL: string;\n  gitBranch: string;\n  gitCorsProxy?: string;\n  gitUsername?: string;\n  gitPassword?: string;\n}\n\nexport interface Note {\n  notebook: Notebook;\n  filePath: string;\n  title: string;\n  markdown: string;\n  config: NoteConfig;\n  // createdAt: Date; // <- Can't get modifiedAt time\n}\n\nexport interface Directory {\n  name: string;\n  path: string;\n  children?: Directory[];\n}\n\nexport interface NoteConfig {\n  id?: string;\n  createdAt: Date;\n  modifiedAt: Date;\n  tags?: string[];\n}\n\nexport interface NotebookConfig {\n  repository: string;\n  branch: string;\n  author: string;\n  contributors: string[];\n}\n\ninterface CrossnoteConstructorProps {\n  fs: FSModule;\n}\ninterface CloneNotebookArgs {\n  name?: string;\n  corsProxy?: string;\n  gitURL: string;\n  branch?: string;\n  depth?: number;\n  username?: string;\n  password?: string;\n  rememberCredentials?: boolean;\n}\n\ninterface ListNotesArgs {\n  notebook: Notebook;\n  dir: string;\n  includeSubdirectories?: Boolean;\n}\nexport interface PushNotebookArgs {\n  notebook: Notebook;\n  authorName?: string;\n  authorEmail?: string;\n  username?: string;\n  password?: string;\n  message?: string;\n  onProgress?: (progress: git.GitProgressEvent) => void;\n  onMessage?: (message: string) => void;\n  onAuthFailure?: (url: string) => void;\n  onAuthSuccess?: (url: string) => void;\n}\n\nexport interface PullNotebookArgs {\n  notebook: Notebook;\n  onProgress?: (progress: git.GitProgressEvent) => void;\n  onMessage?: (message: string) => void;\n  onAuthFailure?: (url: string) => void;\n  onAuthSuccess?: (url: string) => void;\n}\n\nexport default class Crossnote {\n  private fs: FSModule;\n\n  private readFile: (path: string) => Promise<string>;\n  private writeFile: (path: string, data: string) => Promise<void>;\n  private readdir: (path: string) => Promise<string[]>;\n  private unlink: (path: string) => Promise<void>;\n  private stats: (path: string) => Promise<Stats>;\n  private mkdir: (path: string) => Promise<void>;\n  private exists: (path: string) => Promise<boolean>;\n  private rename: (oldPath: string, newPath: string) => Promise<void>;\n  private rmdir: (path: string) => Promise<void>;\n\n  private notebookDB: PouchDB.Database<Notebook>;\n\n  constructor(props: CrossnoteConstructorProps) {\n    this.fs = props.fs;\n    this.setUpFSMethods();\n\n    PouchDB.plugin(PouchdbFind);\n    this.notebookDB = new PouchDB(\"notebooks\");\n    this.notebookDB.createIndex({\n      index: {\n        fields: [\"gitURL\"]\n      }\n    });\n  }\n\n  private setUpFSMethods() {\n    this.readFile = (path: string) => {\n      return new Promise((resolve, reject) => {\n        this.fs.readFile(path, (error, data) => {\n          if (error) {\n            return reject(error);\n          } else {\n            return resolve(data.toString());\n          }\n        });\n      });\n    };\n    this.writeFile = (path: string, data: string) => {\n      return new Promise((resolve, reject) => {\n        this.fs.writeFile(path, data, { encoding: \"utf8\" }, error => {\n          if (error) {\n            return reject(error);\n          } else {\n            return resolve();\n          }\n        });\n      });\n    };\n    this.readdir = (path: string) => {\n      return new Promise((resolve, reject) => {\n        this.fs.readdir(path, (error, files) => {\n          if (error) {\n            return reject(error);\n          } else {\n            return resolve(files);\n          }\n        });\n      });\n    };\n    this.unlink = (path: string) => {\n      return new Promise((resolve, reject) => {\n        this.fs.unlink(path, error => {\n          if (error) {\n            return reject(error);\n          } else {\n            return resolve();\n          }\n        });\n      });\n    };\n    this.stats = (path: string) => {\n      return new Promise((resolve, reject) => {\n        this.fs.stat(path, (error, stats) => {\n          if (error) {\n            return reject(error);\n          } else {\n            return resolve(stats);\n          }\n        });\n      });\n    };\n    this.mkdir = (path: string) => {\n      return new Promise((resolve, reject) => {\n        this.fs.mkdir(path, \"0777\", error => {\n          if (error) {\n            return reject(error);\n          } else {\n            return resolve();\n          }\n        });\n      });\n    };\n    this.exists = (path: string) => {\n      return new Promise((resolve, reject) => {\n        this.fs.exists(path, exists => {\n          return resolve(exists);\n        });\n      });\n    };\n    this.rename = (oldPath: string, newPath: string) => {\n      return new Promise((resolve, reject) => {\n        this.fs.rename(oldPath, newPath, error => {\n          if (error) {\n            return reject(error);\n          } else {\n            return resolve();\n          }\n        });\n      });\n    };\n\n    const rmdir = (path: string) => {\n      return new Promise((resolve, reject) => {\n        this.fs.rmdir(path, error => {\n          if (error) {\n            return reject(error);\n          } else {\n            return resolve();\n          }\n        });\n      });\n    };\n    // Remove the directory recursively\n    this.rmdir = async (dirPath: string) => {\n      const files = await this.readdir(dirPath);\n      for (let i = 0; i < files.length; i++) {\n        const file = files[i];\n        const filePath = path.resolve(dirPath, file);\n        const stats = await this.stats(filePath);\n        if (stats.isDirectory()) {\n          await this.rmdir(filePath);\n        } else {\n          await this.unlink(filePath);\n        }\n      }\n\n      await rmdir(dirPath);\n    };\n  }\n\n  public async addNotebook({\n    name = \"\",\n    corsProxy,\n    gitURL,\n    branch = \"master\",\n    username = \"\",\n    password = \"\",\n    depth = 3,\n    rememberCredentials = false\n  }: CloneNotebookArgs) {\n    if (gitURL) {\n      return await this.cloneNotebook({\n        name,\n        corsProxy,\n        gitURL,\n        branch,\n        username,\n        password,\n        depth,\n        rememberCredentials\n      });\n    } else {\n      const _id = randomID();\n      const dir = `/notebooks/${_id}`;\n      const notebook: Notebook = {\n        _id,\n        dir,\n        name: name.trim() || \"Unnamed\",\n        gitURL: gitURL.trim(),\n        gitBranch: branch.trim(),\n        gitCorsProxy: corsProxy.trim(),\n        gitUsername: rememberCredentials ? username.trim() : \"\",\n        gitPassword: rememberCredentials ? password : \"\"\n      };\n      if (!(await this.exists(\"/notebooks\"))) {\n        await this.mkdir(\"/notebooks\");\n      }\n      if (!(await this.exists(dir))) {\n        await this.mkdir(dir);\n      }\n      await git.init({\n        fs: this.fs,\n        dir\n      });\n\n      // Save to DB\n      try {\n        await this.notebookDB.put(notebook);\n      } catch (error) {\n        // Failed to save to DB\n        await this.rmdir(dir);\n      }\n\n      return notebook;\n    }\n  }\n\n  public async cloneNotebook({\n    name = \"\",\n    corsProxy,\n    gitURL,\n    branch = \"master\",\n    username = \"\",\n    password = \"\",\n    depth = 10,\n    rememberCredentials = false\n  }: CloneNotebookArgs): Promise<Notebook> {\n    if (!gitURL.match(/^https?:\\/\\//)) {\n      throw new Error(\"error/invalid-git-url-prefix\");\n    }\n\n    // Check if gitURL exists\n    /*\n    let exists = false;\n    try {\n      const notebooks = await this.notebookDB.find({\n        selector: {\n          gitURL: { $eq: gitURL }\n        }\n      });\n      if (notebooks.docs && notebooks.docs.length) {\n        exists = true;\n      }\n    } catch (error) {\n      exists = false;\n    }\n\n    if (exists) {\n      throw new Error(\"error/repository-already-cloned\");\n    }*/\n\n    const _id = randomID();\n    const dir = `/notebooks/${_id}`;\n\n    await git.clone({\n      fs: this.fs,\n      http,\n      dir,\n      corsProxy,\n      url: gitURL,\n      ref: branch,\n      depth: depth,\n      singleBranch: true,\n      onAuth: (url, auth) => {\n        return {\n          username,\n          password\n        };\n      }\n    });\n\n    const notebook: Notebook = {\n      _id,\n      dir,\n      name: name || this.getDefaultNotebookNameFromGitURL(gitURL),\n      gitURL: gitURL,\n      gitBranch: branch,\n      gitCorsProxy: corsProxy,\n      gitUsername: rememberCredentials ? username : \"\",\n      gitPassword: rememberCredentials ? password : \"\"\n    };\n\n    // Save to DB\n    try {\n      await this.notebookDB.put(notebook);\n    } catch (error) {\n      // Failed to save to DB\n      await this.rmdir(dir);\n    }\n\n    return notebook;\n  }\n\n  public async exportNotebookToJSON(notebook: Notebook): Promise<string> {\n    return \"\";\n  }\n\n  public async importNotebookFromJSON(notebook: Notebook): Promise<string> {\n    return \"\";\n  }\n\n  public async deleteNotebook(notebookID: string) {\n    const notebook = await this.notebookDB.get(notebookID);\n    await this.rmdir(notebook.dir);\n    await this.notebookDB.remove(notebook);\n  }\n  public async updateNotebook(notebook: Notebook) {\n    await this.notebookDB.put(notebook);\n  }\n  /*\n  public async makeDirectoryForNotebook(notebook: Notebook, dir: string) {\n    await this.mkdir(path.resolve(notebook.dir, dir));\n  }\n  public async removeDirectoryForNotebook(notebook: Notebook, dir: string) {\n    const notes = await this.listNotes({\n      notebook,\n      dir,\n      includeSubdirectories: true\n    });\n    for (let i = 0; i < notes.length; i++) {\n      const note = notes[i];\n      await this.deleteNote(notebook, note.filePath);\n    }\n    await this.unlink(path.resolve(notebook.dir, dir));\n  }\n  */\n\n  public async changeNoteFilePath(\n    notebook: Notebook,\n    note: Note,\n    newFilePath: string\n  ) {\n    newFilePath = newFilePath.replace(/^\\/+/, \"\");\n    if (!newFilePath.endsWith(\".md\")) {\n      newFilePath = newFilePath + \".md\";\n    }\n\n    try {\n      await git.remove({\n        fs: this.fs,\n        dir: notebook.dir,\n        filepath: note.filePath\n      });\n    } catch (error) {}\n\n    const newDirPath = path.dirname(path.resolve(notebook.dir, newFilePath));\n    // Make directories recursively\n    const dirNames = newDirPath.split(\"/\").slice(1);\n    for (let i = 0; i < dirNames.length; i++) {\n      const paths = [\"/\"];\n      for (let j = 0; j <= i; j++) {\n        paths.push(dirNames[j]);\n      }\n      if (!(await this.exists(paths.join(\"/\")))) {\n        await this.mkdir(paths.join(\"/\"));\n      }\n    }\n    await this.rename(\n      path.resolve(notebook.dir, note.filePath),\n      path.resolve(notebook.dir, newFilePath)\n    );\n    await git.add({\n      fs: this.fs,\n      dir: notebook.dir,\n      filepath: newFilePath\n    });\n  }\n\n  public async pushNotebook({\n    notebook,\n    authorName = \"crossnote\",\n    authorEmail = \"anonymous@crossnote.com\",\n    username,\n    password,\n    message = \"doc: Updated docs\",\n    onProgress,\n    onMessage,\n    onAuthFailure,\n    onAuthSuccess\n  }: PushNotebookArgs): Promise<null | git.PushResult> {\n    const stagedFiles = await this.listFiles(notebook);\n    if (!stagedFiles.length) {\n      return {\n        ok: true,\n        error: null,\n        refs: {}\n      };\n    }\n    const sha = await git.commit({\n      fs: this.fs,\n      dir: notebook.dir,\n      author: {\n        name: authorName,\n        email: authorEmail\n      },\n      message\n    });\n    // console.log(sha);\n    const pushResult = await git.push({\n      fs: this.fs,\n      http,\n      onAuth: (url, auth) => {\n        return {\n          username: username, // || notebook.gitUsername,\n          password: password // || notebook.gitPassword\n        };\n      },\n      onProgress: progress => {\n        if (onProgress) {\n          onProgress(progress);\n        }\n      },\n      onMessage: message => {\n        if (onMessage) {\n          onMessage(message);\n        }\n      },\n      onAuthFailure: (url, auth) => {\n        if (onAuthFailure) {\n          onAuthFailure(url);\n        }\n      },\n      onAuthSuccess: (url, auth) => {\n        if (onAuthSuccess) {\n          onAuthSuccess(url);\n        }\n      },\n      url: notebook.gitURL,\n      dir: notebook.dir,\n      ref: notebook.gitBranch,\n      corsProxy: notebook.gitCorsProxy\n    });\n    if (pushResult.ok) {\n      // Unstage all files\n      for (let i = 0; i < stagedFiles.length; i++) {\n        await git.remove({\n          fs: this.fs,\n          dir: notebook.dir,\n          filepath: stagedFiles[i]\n        });\n      }\n    }\n    return pushResult;\n  }\n\n  public async pullNotebook({\n    notebook,\n    onProgress,\n    onAuthFailure,\n    onAuthSuccess,\n    onMessage\n  }: PullNotebookArgs) {\n    await git.pull({\n      fs: this.fs,\n      http,\n      dir: notebook.dir,\n      singleBranch: true,\n      corsProxy: notebook.gitCorsProxy,\n      ref: notebook.gitBranch,\n      author: {\n        name: \"anonymous\",\n        email: \"anonymous@crossnote.app\"\n      },\n      onAuth: (url, auth) => {\n        return {\n          username: notebook.gitUsername,\n          password: notebook.gitPassword\n        };\n      },\n      onProgress,\n      onAuthFailure,\n      onAuthSuccess,\n      onMessage\n    });\n  }\n\n  public async checkoutNote(note: Note): Promise<Note> {\n    try {\n      await git.checkout({\n        fs: this.fs,\n        dir: note.notebook.dir,\n        // ref: \"HEAD\"\n        // ref: note.notebook.gitBranch,\n        filepaths: [note.filePath]\n      });\n      await git.remove({\n        fs: this.fs,\n        dir: note.notebook.dir,\n        filepath: note.filePath\n      });\n      const newNote = await this.getNote(note.notebook, note.filePath);\n      return newNote;\n    } catch (error) {\n      return null;\n    }\n  }\n\n  public async listNotebooks(): Promise<Notebook[]> {\n    const notebooks = (\n      await this.notebookDB.find({\n        selector: {\n          gitURL: { $gt: null }\n        }\n      })\n    ).docs;\n    // console.log(notebooks);\n    return notebooks;\n  }\n\n  public async listFiles(notebook: Notebook) {\n    return await git.listFiles({\n      fs: this.fs,\n      dir: notebook.dir\n    });\n  }\n\n  private async getNote(\n    notebook: Notebook,\n    filePath: string,\n    stats?: Stats\n  ): Promise<Note> {\n    const absFilePath = path.resolve(notebook.dir, filePath);\n    if (!stats) {\n      try {\n        stats = await this.stats(absFilePath);\n      } catch (error) {\n        return null;\n      }\n    }\n    if (stats.isFile() && filePath.endsWith(\".md\")) {\n      let markdown = await this.readFile(absFilePath);\n      // console.log(\"read: \", filePath, markdown);\n\n      // Read the noteConfig, which is like <!-- note {...} --> at the end of the markdown file\n      let noteConfig: NoteConfig = {\n        id: \"\",\n        createdAt: stats.mtime,\n        modifiedAt: stats.mtime,\n        tags: []\n      };\n      const lines = markdown\n        .trim()\n        .split(\"\\n\")\n        .filter(x => x.length > 0);\n      const lastLine = lines[lines.length - 1].trim();\n      if (lastLine.match(/^<!--\\s*note\\s+/)) {\n        markdown = lines.slice(0, lines.length - 1).join(\"\\n\");\n        const configStr = lines[lines.length - 1]\n          .replace(/^<!--\\s*note\\s+/, \"\")\n          .replace(/\\s*-->$/, \"\");\n        let config: any = {};\n        try {\n          config = JSON.parse(configStr);\n          config.modifiedAt = new Date(config.modifiedAt || stats.mtime);\n          config.createdAt = new Date(config.createdAt || stats.mtime);\n        } catch (error) {}\n        noteConfig = Object.assign(noteConfig, config);\n      }\n\n      // Create note\n      const note: Note = {\n        notebook: notebook,\n        filePath: path.relative(notebook.dir, absFilePath),\n        title: getHeaderFromMarkdown(markdown),\n        markdown,\n        config: noteConfig\n      };\n      return note;\n    } else {\n      return null;\n    }\n  }\n\n  public async listNotes({\n    notebook,\n    dir = \"./\",\n    includeSubdirectories = false\n  }: ListNotesArgs): Promise<Note[]> {\n    let notes: Note[] = [];\n    let files: string[] = [];\n    try {\n      files = await this.readdir(path.resolve(notebook.dir, dir));\n    } catch (error) {\n      files = [];\n    }\n    for (let i = 0; i < files.length; i++) {\n      const file = files[i];\n      const absFilePath = path.resolve(notebook.dir, dir, file);\n      const stats = await this.stats(absFilePath);\n      const note = await this.getNote(\n        notebook,\n        path.relative(notebook.dir, absFilePath),\n        stats\n      );\n      if (note) {\n        notes.push(note);\n      }\n\n      if (stats.isDirectory() && file !== \".git\" && includeSubdirectories) {\n        notes = notes.concat(\n          await this.listNotes({\n            notebook,\n            dir: path.relative(notebook.dir, absFilePath),\n            includeSubdirectories\n          })\n        );\n      }\n    }\n\n    // console.log(\"listNotes: \", notes);\n    return notes;\n  }\n  public async writeNote(\n    notebook: Notebook,\n    filePath: string,\n    markdown: string,\n    noteConfig: NoteConfig\n  ) {\n    noteConfig.modifiedAt = new Date();\n    await this.writeFile(\n      path.resolve(notebook.dir, filePath),\n      markdown + `\\n\\n<!-- note ${JSON.stringify(noteConfig)}-->`\n    );\n    await git.add({\n      fs: this.fs,\n      dir: notebook.dir,\n      filepath: filePath\n    });\n  }\n  public async deleteNote(notebook: Notebook, filePath: string) {\n    if (await this.exists(path.resolve(notebook.dir, filePath))) {\n      await git.remove({\n        fs: this.fs,\n        dir: notebook.dir,\n        filepath: filePath\n      });\n      await this.unlink(path.resolve(notebook.dir, filePath));\n    }\n  }\n\n  // public async moveNote(fromFilePath: string, toFilePath: string) {}\n  public async getNotebookDirectoriesFromNotes(\n    notes: Note[]\n  ): Promise<Directory> {\n    const rootDirectory: Directory = {\n      name: \".\",\n      path: \".\",\n      children: []\n    };\n\n    const filePaths = new Set<string>([]);\n    for (let i = 0; i < notes.length; i++) {\n      filePaths.add(path.dirname(notes[i].filePath));\n    }\n\n    filePaths.forEach(value => {\n      const dirNames = value.split(\"/\");\n      let directory = rootDirectory;\n      for (let i = 0; i < dirNames.length; i++) {\n        if (dirNames[i] === \".\") {\n          break;\n        } else {\n          let subDirectory = directory.children.filter(\n            directory => directory.name === dirNames[i]\n          )[0];\n          if (subDirectory) {\n            directory = subDirectory;\n          } else {\n            let paths: string[] = [];\n            for (let j = 0; j <= i; j++) {\n              paths.push(dirNames[j]);\n            }\n            subDirectory = {\n              name: dirNames[i],\n              path: paths.join(\"/\"),\n              children: []\n            };\n            directory.children.push(subDirectory);\n            directory = subDirectory;\n          }\n        }\n      }\n    });\n\n    return rootDirectory;\n  }\n\n  private getDefaultNotebookNameFromGitURL(gitURL: string) {\n    const i = gitURL.lastIndexOf(\"/\");\n    return gitURL.slice(i + 1).replace(/\\.git/, \"\");\n  }\n\n  public async getStatus(note: Note) {\n    return await git.status({\n      fs: this.fs,\n      dir: note.notebook.dir,\n      filepath: note.filePath\n    });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\n//import \"typeface-noto-sans\";\n//import \"typeface-noto-sans-sc\";\n//import \"typeface-noto-serif-sc\";\n//import \"typeface-noto-sans-hk\";\nimport \"typeface-roboto\";\nimport \"noty/lib/noty.css\";\nimport \"noty/lib/themes/relax.css\";\nimport { BFSRequire, configure as BFSConfigure } from \"browserfs\";\nimport Noty from \"noty\";\n\nimport \"./i18n/i18n\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport * as serviceWorker from \"./serviceWorker\";\nimport Crossnote from \"./lib/crossnote\";\nimport { CrossnoteContainer } from \"./containers/crossnote\";\n\nBFSConfigure({ fs: \"IndexedDB\", options: {} }, async error => {\n  if (error) {\n    return new Noty({\n      type: \"error\",\n      text: error.toString(),\n      layout: \"topRight\",\n      theme: \"relax\",\n      timeout: 2000\n    }).show();\n  }\n  const fs = BFSRequire(\"fs\");\n\n  try {\n    const crossnote = new Crossnote({\n      fs: fs\n    });\n    (window as any)[\"crossnote\"] = crossnote;\n\n    ReactDOM.render(\n      <CrossnoteContainer.Provider\n        initialState={{\n          crossnote: crossnote\n        }}\n      >\n        <App />\n      </CrossnoteContainer.Provider>,\n      document.getElementById(\"root\")\n    );\n  } catch (error) {\n    console.log(error);\n  }\n});\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\n// serviceWorker.unregister();\nserviceWorker.register();\n"],"sourceRoot":""}